--- 6.72f.j	2011-12-28 15:55:10.000000000 +0100
+++ 6.73b.j	2011-12-28 15:53:55.000000000 +0100
@@ -453,59 +453,59 @@
 sound gg_snd_WallOfReplica=null
 sound gg_snd_WhickedSick=null
 sound gg_snd_GoblinSapperYesAttack4=null
 sound gg_snd_ShadowStrikeBirth1=null
 sound gg_snd_TheBlackArrow2=null
 sound gg_snd_CorrosiveBreathMissileLaunch1=null
 sound gg_snd_Death_Sentinel=null
 sound gg_snd_Death_Scourge=null
 sound gg_snd_ReviveHuman=null
 sound gg_snd_SecretFound=null
 sound gg_snd_UltraKill=null
 sound gg_snd_Rampage=null
 sound gg_snd_AltarOfEldersWhat1=null
 sound gg_snd_MysticSnakeCast=null
 sound gg_snd_MysticSnakeHit=null
-sound gg_snd_SotS2=null
 sound gg_snd_AbominationPissed5=null
 sound gg_snd_AbominationDeath1=null
 sound gg_snd_ArtilleryCorpseExplodeDeath1=null
 sound gg_snd_CryptFiendPissed2=null
 sound gg_snd_BansheeDeath=null
 sound gg_snd_FlameStrikeTargetWaveNonLoop1=null
 sound gg_snd_VolcanoLoop=null
 sound gg_snd_ThunderClapCaster=null
 sound gg_snd_MirrorImage=null
 sound gg_snd_CloudOfFogLoop1=null
 sound gg_snd_GyrocopterPissed1=null
 string gg_snd_Other6
 string gg_snd_Other7
 string gg_snd_Other8
 string gg_snd_Other9
 sound gg_snd_SecretFound01=null
 sound gg_snd_Hint=null
 sound gg_snd_walruspunch=null
 sound gg_snd_Sunray=null
 sound gg_snd_FireSpiritsReady=null
 sound gg_snd_BattleRoar=null
 sound gg_snd_ZigguratUpgrade=null
 sound gg_snd_SpellStealMissile=null
 sound gg_snd_SpellStealTarget=null
 sound gg_snd_AcolyteMining=null
 sound gg_snd_DestroyerMissile=null
 sound gg_snd_SpiritTouch=null
 sound gg_snd_FlameStrikeTargetWaveNonLoop101=null
+sound gg_snd_RainOfFireTarget2=null
 trigger gg_trg_Lib_Init=null
 trigger gg_trg_HLC=null
 trigger gg_trg_Multiboard_Functions=null
 trigger gg_trg_Tracker_Index=null
 trigger gg_trg_Global_Functions=null
 trigger gg_trg_Group_Functions=null
 trigger gg_trg_CleanTrigger=null
 trigger gg_trg_Trigger_Functions=null
 trigger gg_trg_Hero_Functions=null
 trigger gg_trg_Misc_Unit_Functions=null
 trigger gg_trg_DotA_Specific=null
 trigger gg_trg_Damage=null
 trigger gg_trg_General_Utility=null
 trigger gg_trg_General_Utility_2=null
 trigger gg_trg_Globals=null
@@ -544,30 +544,31 @@
 trigger gg_trg_Map_Info=null
 trigger gg_trg_Leave=null
 trigger gg_trg_Remove_On_Respawn=null
 trigger gg_trg_HeroRevive=null
 trigger gg_trg_HeroEnters=null
 trigger gg_trg_OneHero=null
 trigger gg_trg_Money=null
 trigger gg_trg_Time=null
 trigger gg_trg_Cooldown_Tracker=null
 trigger gg_trg_Reliable_Gold=null
 trigger gg_trg_Ban_Dev_Hero=null
 trigger gg_trg_Assist_Tracker=null
 trigger gg_trg_Track_Dying_Creeps=null
 trigger gg_trg_CustomHeroRevive=null
 trigger gg_trg_Deathtrigger=null
+trigger gg_trg_Image_Enters=null
 trigger gg_trg_First_Blood=null
 trigger gg_trg_RoshanDies=null
 trigger gg_trg_AntiDeny=null
 trigger gg_trg_Chicken_Dies=null
 trigger gg_trg_Tower_Denied=null
 trigger gg_trg_Item_Definitions=null
 trigger gg_trg_Powerup_Definitions=null
 trigger gg_trg_Recipe_Definitions=null
 trigger gg_trg_Aghanims_Scepter_Definitions=null
 trigger gg_trg_Monitor_Items=null
 trigger gg_trg_Deliver_Items=null
 trigger gg_trg_Goblin_Definitions=null
 trigger gg_trg_Fuse=null
 trigger gg_trg_Unit_Item_Conversion=null
 trigger gg_trg_Restricted_Items=null
@@ -618,30 +619,32 @@
 trigger gg_trg_Magic_Stick=null
 trigger gg_trg_Fortify_Buildings=null
 trigger gg_trg_Phase_Boots=null
 trigger gg_trg_Blade_Mail=null
 trigger gg_trg_Mask_of_Madness=null
 trigger gg_trg_Force_Staff=null
 trigger gg_trg_Ghost_Potion=null
 trigger gg_trg_Soul_Ring=null
 trigger gg_trg_Tree_Chop=null
 trigger gg_trg_Return_Home=null
 trigger gg_trg_Manta_Style_Spell=null
 trigger gg_trg_Staff_of_Healing=null
 trigger gg_trg_Ancient_Jangoo=null
 trigger gg_trg_Smoke_of_Deceit=null
 trigger gg_trg_Veil_of_Discord=null
+trigger gg_trg_Crippling_Staff=null
+trigger gg_trg_Tranquil_Boots=null
 trigger gg_trg_Cast_Item=null
 trigger gg_trg_Aegis=null
 trigger gg_trg_Power_Treads=null
 trigger gg_trg_Ring_of_Basilius=null
 trigger gg_trg_Radiance_Toggle=null
 trigger gg_trg_Diffusal_Blade=null
 trigger gg_trg_Black_King_Bar=null
 trigger gg_trg_Armlet_Life_Add=null
 trigger gg_trg_Perseverance_Disassemble=null
 trigger gg_trg_MantaStyle=null
 trigger gg_trg_Use_Item=null
 trigger gg_trg_Track_Neutrals=null
 trigger gg_trg_Spawn_Roshan=null
 trigger gg_trg_Move=null
 trigger gg_trg_spawn_multiplier_range=null
@@ -752,30 +755,31 @@
 trigger gg_trg_KickAFK=null
 trigger gg_trg_Courier=null
 trigger gg_trg_AH=null
 trigger gg_trg_Invoke_List=null
 trigger gg_trg_Music=null
 trigger gg_trg_Water=null
 trigger gg_trg_ItemSwap=null
 trigger gg_trg_Bonus=null
 trigger gg_trg_Bounty=null
 trigger gg_trg_Share_Courier=null
 trigger gg_trg_Quote=null
 trigger gg_trg_Switch=null
 trigger gg_trg_NoSwitch=null
 trigger gg_trg_Sleep=null
 trigger gg_trg_Calm=null
+trigger gg_trg_No_Hat=null
 trigger gg_trg_Tips=null
 trigger gg_trg_Terrain=null
 trigger gg_trg_Mode_Picked=null
 trigger gg_trg_Game_Mode=null
 trigger gg_trg_AP=null
 trigger gg_trg_CM=null
 trigger gg_trg_RD=null
 trigger gg_trg_CD=null
 trigger gg_trg_SD=null
 trigger gg_trg_AR=null
 trigger gg_trg_VR=null
 trigger gg_trg_LM=null
 trigger gg_trg_XL=null
 trigger gg_trg_RV=null
 trigger gg_trg_MM=null
@@ -1542,30 +1546,32 @@
 string array HeroTips_5
 unit IntTavern1
 unit IntTavern2
 unit IntTavern3
 unit IntTavern4
 unit AgiTavern1
 unit AgiTavern2
 unit AgiTavern3
 unit AgiTavern4
 unit StrTavern1
 unit StrTavern2
 unit StrTavern3
 unit StrTavern4
 integer array AbusableSpells
 integer AbusableSpells_Max=0
+integer array ItemAbilities
+integer ItemAbilities_Max=-1
 constant integer MSG_PLAYER_LEFT=1848652356
 constant integer MSG_AUTOMATICALLY_ASSIGNED=1848652357
 constant integer MSG_RANDOMLY_GIVEN=1848652358
 constant integer MSG_NO_ENEMY_OBSERVER=1848652359
 constant integer MSG_NO_RECIPE=1848652360
 constant integer MSG_ONE_TREADS=1848652364
 constant integer MSG_ONE_QUELLING=1848657996
 constant integer MSG_ONE_ARMLET=1848652355
 constant integer MSG_CROW_CANNOT_CARRY=1848652363
 constant integer MSG_HERO_CANNOT_CARRY=1848652362
 constant integer MSG_DOUBLE_AVATAR=1848652368
 constant integer MSG_FULL_INVENTORY=1848652367
 constant integer MSG_MEKANSM_STACK_1=1848652365
 constant integer MSG_MEKANSM_STACK_2=1848652371
 constant integer MSG_RECIPE_INCOMPLETE=1848652369
@@ -2093,30 +2099,31 @@
 constant integer SOUND_TRIPLEKILL=2
 constant integer SOUND_ULTRAKILL=3
 constant integer SOUND_RAMPAGE=4
 constant integer SOUND_OWNAGE=3
 integer bonusgoldxp_gold
 integer bonusgoldxp_xp
 integer array Bonus_XP
 integer array Bonus_Gold
 integer Bonus_Count_XP
 integer Bonus_Count_Gold
 unit aegisholder=null
 boolean AegisMSG_Disabled=true
 integer roshan_upgradelevel=1
 trigger t_UpgradeRoshan
 integer RoshanUpgrade=0
+leaderboard array courierdeath_lb
 integer array Item_Dummy
 integer array Item_Real
 integer array Item_Unit
 integer array Item_Mute
 string array Item_Icon
 integer array Item_Cooldown
 integer array Item_RealIndexId
 integer Item_Max=0
 integer indexid_orbofvenom
 integer indexid_orbofvenomranged
 integer indexid_bootsofspeed
 integer indexid_glovesofhaste
 integer indexid_bootsofelvenskin
 integer indexid_circletofnobility
 integer indexid_beltofgiantstrength
@@ -2167,30 +2174,37 @@
 integer indexid_emptybottle3
 integer indexid_emptybottleinvisibility
 integer indexid_emptybottledoubledamage
 integer indexid_emptybottlehaste
 integer indexid_emptybottleregeneration
 integer indexid_emptybottleillusion
 integer indexid_magicstick
 integer indexid_quellingblade
 integer indexid_quellingbladeranged
 integer indexid_talismanofevasion
 integer indexid_etherealblade
 integer indexid_corruptor
 integer indexid_corruptorranged
 integer indexid_ancientjangoo
 integer indexid_ancientjangooempty
+integer indexid_bladeofthereaper
+integer indexid_ironboots
+integer indexid_ironboots_disabled
+integer indexid_cripplingstaff
+integer indexid_moonshard
+integer indexid_ringofaquila
+integer indexid_ringofaquilaheroes
 integer indexid_claritypotion
 integer indexid_ghostpotion
 integer indexid_flaskofsapphirewater
 integer indexid_ancienttangoofessifation
 integer indexid_observerwards
 integer indexid_sentrywards
 integer indexid_scrolloftownportal
 integer indexid_animalcourier
 integer indexid_cheese
 integer indexid_poisonpowder
 integer indexid_dustofappearance
 integer indexid_wandofillusions
 integer indexid_smokeofdeceit
 integer indexid_perseverance
 integer indexid_headdressofrejuvenation
@@ -2280,30 +2294,32 @@
 integer indexid_orchidmalevolence
 integer indexid_phaseboots
 integer indexid_magicwand
 integer indexid_forcestaff
 integer indexid_pipeofinsight
 integer indexid_poormanshield
 integer indexid_poormanshieldranged
 integer indexid_ghostscepter
 integer indexid_staffofhealing
 integer indexid_staffofhealingempty
 integer indexid_soulring
 integer indexid_arcaneboots
 integer indexid_phoenixblade
 integer indexid_medallionofcourage
 integer indexid_veilofdiscord
+integer indexid_prudence
+integer indexid_annihilator
 integer indexid_recipe_headdressofrejuvenation
 integer indexid_recipe_nathrezimbuckler
 integer indexid_recipe_bootsoftravel
 integer indexid_recipe_powertreads
 integer indexid_recipe_handofmidas
 integer indexid_recipe_bracer
 integer indexid_recipe_wraithband
 integer indexid_recipe_nulltalisman
 integer indexid_recipe_yasha
 integer indexid_recipe_sange
 integer indexid_recipe_craniumbasher
 integer indexid_recipe_blademail
 integer indexid_recipe_maelstrom
 integer indexid_recipe_diffusalblade
 integer indexid_recipe_maskofmadness
@@ -2330,36 +2346,41 @@
 integer indexid_recipe_vladmirsoffering
 integer indexid_recipe_assaultcuirass
 integer indexid_recipe_armletofmordiggian
 integer indexid_recipe_shivasguard
 integer indexid_recipe_magicwand
 integer indexid_recipe_forcestaff
 integer indexid_recipe_pipeofinsight
 integer indexid_recipe_aghanimsscepter
 integer indexid_recipe_mjollnir
 integer indexid_recipe_staffofhealing
 integer indexid_recipe_soulring
 integer indexid_recipe_etherealblade
 integer indexid_recipe_ancientjangoo
 integer indexid_recipe_medallionofcourage
 integer indexid_recipe_veilofdiscord
+integer indexid_recipe_orchidmalevolence
+integer indexid_recipe_bladeofthereaper
+integer indexid_recipe_ironboots
+integer indexid_recipe_prudence
 constant integer powerup_haste=1227894838
 constant integer powerup_regeneration=1227894840
 constant integer powerup_invisibility=1227894858
 constant integer powerup_doubledamage=1227894859
 constant integer powerup_illusion=1227894839
 trigger t_spawnpowerup
+integer powerup_previous=-1
 integer array Recipe_Component_1
 integer array Recipe_Component_2
 integer array Recipe_Component_3
 integer array Recipe_Component_4
 integer array Recipe_Component_5
 integer array Recipe_Component_6
 integer array Recipe_Component_7
 integer array Recipe_Result
 integer Recipe_Max=0
 integer indexid_aghanimsscepter
 integer indexid_aghanimsscepterfurion
 integer indexid_aghanimsscepterkotl
 integer indexid_aghanimsscepterleshrac
 integer indexid_aghanimsscepterlich
 integer indexid_aghanimsscepterlina
@@ -2452,57 +2474,61 @@
 constant integer abilityid_aghanimsscepter_nevermore=1093750101
 constant integer abilityid_aghanimsscepter_axe=1093750100
 constant integer abilityid_aghanimsscepter_batrider=1093750104
 constant integer abilityid_aghanimsscepter_earthshaker=1093750320
 constant integer abilityid_aghanimsscepter_puck=1093751123
 constant integer abilityid_aghanimsscepter_warlock=1093752148
 constant integer abilityid_aghanimsscepter_razor=1093752149
 constant integer abilityid_aghanimsscepter_viper=1093752369
 constant integer abilityid_aghanimsscepter_tiny=0
 constant integer abilityid_aghanimsscepter_destroyer=1093752409
 constant integer abilityid_aghanimsscepter_enchantress=1093752644
 constant integer abilityid_aghanimsscepter_darkseer=1093808467
 constant integer abilityid_aghanimsscepter_gyrocopter=1093808951
 constant integer abilityid_aghanimsscepter_meepo=1093809989
 constant integer abilityid_aghanimsscepter_beastmaster=1093810241
+constant integer abilityid_aghanimsscepter_visage=1093814600
 integer array HasItem_Javelin
 integer array HasItem_Dagger
 integer array HasItem_Bloodstone
 integer array HasItem_CraniumBasher
 integer array HasItem_LinkenSphere
 integer array HasItem_SangeAndYasha
 integer array HasItem_Sange
 constant integer unitid_deliveritems=1747990581
 constant integer unitid_deliveritems_resume=1747993669
 constant integer unitid_collectitems=1747993174
 player deliveritems_player
 unit deliveritems_source
 unit deliveritems_courier
 integer deliveritems_count
 boolean buyback_revivingstate=false
 unit collectitems_courier
 real unititem_last=0
 real unittime_increment=0
 trigger t_manipulateitem
 integer TotalCount_LinkenSphere=0
 integer TotalCount_Javelin=0
 integer TotalCount_Dagger=0
 integer TotalCount_Bloodstone=0
 integer TotalCount_CraniumBasher=0
 integer TotalCount_Heart=0
 integer TotalCount_SangeAndYasha=0
 integer TotalCount_Sange=0
+integer TotalCount_Prudence=0
+integer TotalCount_IronBoots=0
+integer array HasItem_Prudence
 constant integer morphrestrict_metamorph=1093751369
 constant integer morphrestrict_berserkerrage=1093681733
 constant integer abilityid_powerupillusion=1093683026
 constant integer abilityid_powerupregeneration=1095332716
 constant integer buffid_powerupregeneration=1110454611
 constant integer MSG_RUNEMSG_1=1848657748
 constant integer MSG_RUNEMSG_2=1848657749
 constant integer MSG_RUNEMSG_3=1848657750
 constant integer MSG_RUNEMSG_4=1848657751
 boolean runemsg_special=false
 trigger t_itemtraffic
 constant string gem_fx="Abilities\\Spells\\Human\\MagicSentry\\MagicSentryCaster.mdl"
 constant integer gem_real=1093809729
 constant integer gem_fake=1093809730
 trigger t_ItemCooldown
@@ -2513,30 +2539,31 @@
 constant integer OrderId_Item1=852009
 constant integer OrderId_Item2=852010
 constant integer OrderId_Item3=852011
 constant integer OrderId_Item4=852012
 constant integer OrderId_Item5=852013
 constant integer abilityid_disassemble=1093684021
 constant integer abilityid_disassemble_courier=1093751366
 trigger t_nochickensale
 unit array BloodstoneCaster
 constant integer abilityid_pickupallitems=1093743684
 unit pickupallitems_unit=null
 constant integer abilityid_dropallitems1=1093743416
 constant integer abilityid_dropallitems2=1093743683
 real array BlinkDamaged_Time
 integer array HasItem_Heart
+integer array HasItem_IronBoots
 constant real sangeandyasha_proc_chance=15
 constant real sangeandyasha_duration=4
 constant integer sangeandyasha_slow=1093809717
 constant integer sangeandyasha_buffid=1110456398
 constant integer sangeandyasha_fx=1093809731
 constant real sange_proc_chance=15
 constant real sange_duration=4
 constant integer sange_slow=1093809718
 constant integer sange_buffid=1110454857
 constant integer sange_fx=1093809731
 constant integer abilityid_craniumbasher=1093744436
 constant integer itemid_euls=1919248946
 constant integer abilityid_eulsmovement=1093686832
 constant real armlet_drain=37
 constant integer powerup_linkensphere=1227901005
@@ -2553,42 +2580,44 @@
 constant integer unitid_goodcourier5=1848658778
 constant integer unitid_badcourier0=1697657178
 constant integer unitid_badcourier1=1848652339
 constant integer unitid_badcourier2=1848652340
 constant integer unitid_badcourier3=1848652341
 constant integer unitid_badcourier4=1848658992
 constant integer unitid_badcourier5=1848658993
 constant integer unitid_jokecourier1=1848651853
 constant integer unitid_jokecourier2=1848658006
 constant integer unitid_jokecourier3=1697657426
 constant integer unitid_jokecourier4=1848659027
 constant integer unitid_flyingcourier1=1697657428
 constant integer unitid_flyingcourier2=1697657427
 constant integer unitid_flyingcourier3=1697657648
 constant integer unitid_goodcourier6=1848659013
+constant integer unitid_badcourier6=1848659252
 constant integer abilityid_morphchicken=1093685076
 constant integer abilityid_morphchickentopenguin=1395667001
 constant integer abilityid_morphpenguintoraccoon=1395667011
 constant integer abilityid_morphraccoontocrab=1395667030
 constant integer abilityid_morphcrabtoseal=1395667031
 constant integer abilityid_morphsealtoskink=1395667033
 constant integer abilityid_morphskinktodog=1395667032
 constant integer abilityid_morphdogtoduneworm=1395667012
 constant integer abilityid_morphdunewormtocarrionbeetle=1395667010
 constant integer abilityid_morphcarrionbeetletofelboar=1395667013
 constant integer abilityid_morphfelboartorabit=1395667014
-constant integer abilityid_morphrabittochicken=1395667253
+constant integer abilityid_morphrabittopack=1395667270
+constant integer abilityid_morphpacktochicken=1395667253
 constant integer abilityid_morphminipudge=1395667015
 constant integer abilityid_morphminitechies=1395667020
 constant integer abilityid_morphcrowzeppelin=1395667250
 constant integer abilityid_morphzeppelinvulture=1395667252
 constant integer abilityid_morphvultureowl=1395667248
 constant integer abilityid_morphowlviper=1395667249
 constant integer abilityid_morphviperfrost=1395667255
 constant integer abilityid_morphfrostcrow=1395667251
 constant integer abilityid_morphminigrunt=1395667254
 constant integer abilityid_morphcrow=1093683012
 constant integer abilityid_morphcrow_sent=1395667017
 constant integer abilityid_morphcrow_scourge=1395667018
 constant integer abilityid_morphcrow_goblin=1395667034
 real array TP_Location_X
 real array TP_Location_Y
@@ -2689,30 +2718,37 @@
 constant integer ancientjangoo_boost_buffid=1110459480
 constant real ancientjangoo_duration=6
 constant integer abilityid_smokeofdeceit=1093808182
 constant string smokeofdeceit_fx="war3mapImported\\SmokeOfDeceit.mdx"
 constant integer smokeofdeceit_invis=1093808204
 constant integer smokeofdeceit_ms=1093808211
 constant integer smokeofdeceit_buffid=1110459698
 constant integer smokeofdeceit_phasebuff=1110456665
 unit smokeofdeceit_caster
 player smokeofdeceit_player
 constant integer abilityid_veilofdiscord=1093810244
 constant integer veilofdiscord=1093810246
 constant integer veilofdiscord_buffid=1110459729
 constant real veilofdiscord_duration=15
 constant string veilofdiscord_fx="war3mapImported\\DarkLightningNova.mdx"
+constant integer abilityid_cripplingstaff=1093813569
+constant integer cripplingstaff_miss=1093814861
+constant integer cripplingstaff_miss_buffid=1110459989
+constant integer cripplingstaff_slow=1093813571
+constant integer cripplingstaff_slow_buffid=1110459957
+constant real cripplingstaff_duration=4
+constant integer abilityid_tranquilboots=1093815089
 constant integer abilityid_corruptor=1093753420
 constant integer abilityid_corruptor_ranged=1093753421
 constant integer unitid_corruptor=1848659021
 constant integer unitid_corruptor_ranged=1848659022
 constant integer abilityid_medallion_of_courage=1093753417
 constant integer medallion_armor=1093753418
 constant string medallion_fx="Abilities\\Spells\\Undead\\Cripple\\CrippleTarget.mdl"
 boolean aegis_meepo=false
 constant integer abilityid_armletofmordiggianoff=1093686327
 constant integer abilityid_armletofmordiggianon=1093686328
 boolean throne_damage_10=false
 boolean throne_damage_25=false
 boolean throne_damage_50=false
 boolean throne_damage_75=false
 boolean tree_damage_10=false
@@ -2964,31 +3001,31 @@
 image CD_Image_14
 image CD_Image_15
 image CD_Image_16
 constant integer CD_PHASE_BAN_1=1
 constant integer CD_PHASE_BAN_2=2
 constant integer CD_PHASE_BAN_3=3
 constant integer CD_PHASE_BAN_4=4
 constant integer CD_PHASE_DRAFT_1=5
 constant integer CD_PHASE_DRAFT_2=6
 constant integer CD_PHASE_DRAFT_3=7
 constant integer CD_PHASE_DRAFT_4=8
 constant integer CD_PHASE_DRAFT_5=9
 constant integer CD_PHASE_DRAFT_6=10
 constant integer CD_Shadow=1747990089
 constant integer CD_unitid_selecthero=1747990094
-constant integer CD_COUNT=24
+constant integer CD_COUNT=28
 constant real CD_RADIUS=450
 constant real CD_HEROSPACE=75
 constant real CD_HERODISTANCE=140
 constant real CD_HEROBANSPACE=80
 constant real CD_HEROBANDISTANCE=210
 constant integer CD_TOTALTIME=150
 constant integer MSG_CD_BAN1=1848657970
 constant integer MSG_CD_PICK1=1848657971
 constant integer MSG_CD_PICK2=1848657972
 constant integer MSG_CD_ACTION_1=1848657973
 constant integer MSG_CD_ACTION_2=1848657974
 constant integer MSG_CD_ACTION_3=1848657975
 constant integer MSG_CD_ACTION_4=1848657976
 constant integer MSG_CD_FINISHED=1848657977
 boolean udg_ModeSD=false
@@ -3091,30 +3128,31 @@
 image array CP_Image_b
 constant integer abilityid_torrent=1093743414
 constant integer torrent_toss=1093743447
 constant integer torrent_slow=1093742924
 constant integer abilityid_watersword=1093743444
 constant integer watersword_damage=1093742927
 constant integer watersword_fx=1093742930
 constant integer watersword_cleave1=1093743671
 constant integer watersword_cleave2=1093743672
 constant integer watersword_cleave3=1093742933
 constant integer watersword_cleave4=1093743673
 constant integer abilityid_xmarksthespot=1093742926
 constant integer abilityid_xmarksthespot_helper=1093743428
 constant integer abilityid_ghostship=1093742923
 constant integer unitid_ghostship=1747990101
+constant integer unitid_ghostship_alt=1747993674
 constant integer unitid_ghostship2=1747990102
 constant integer ghostship_slow=1093742924
 constant integer ghostship_stun=1093743448
 constant integer rum_bonus=1093743158
 constant integer buffid_rum_ms=1110456661
 group ghostship_alreadyhit
 unit ghostship_source
 integer ghostship_level
 real ghostship_angle
 constant integer abilityid_unstableconcoction=1093750345
 constant integer abilityid_unstableconcoction_helper=1093750344
 constant integer unitid_unstableconcoction=1747993156
 constant real unstableconcoction_maxcharge=5.0
 constant real unstableconcoction_buff=2.0
 unit unstableconcoction_source
@@ -3179,49 +3217,50 @@
 constant integer abilityid_hookshotstun=1093687865
 constant integer unitid_hookshot=1966092374
 constant integer unitid_hookshothead=1966092373
 constant integer abilityid_batteryassault=1093687860
 constant integer abilityid_batteryassaultstun=1093687863
 constant string fx_batteryassault="Abilities\\Spells\\Human\\FlakCannons\\FlakTarget.mdl"
 constant integer unitid_batteryassault=1747988570
 constant integer abilityid_freezingfieldcast=1093677912
 constant integer abilityid_freezingfield=1093677906
 constant integer abilityid_freezingfieldupgrade=1093681494
 constant integer abilityid_freezingfield_slow=1093742676
 unit freezingfield_source
 integer freezingfield_damage
 constant integer abilityid_crystalnova=1093748025
 constant integer crystalnova_nuke=1093677380
-constant integer unitid_raijin=1211117651
 constant integer abilityid_staticremnant=1093743696
 constant integer unitid_staticremnant=1747990342
 unit staticremnant_source
 real staticremnant_damage
 constant integer abilityid_overload=1093685591
 constant integer abilityid_overloadslow=1093686069
 unit overload_source
 real overload_damage
 constant integer abilityid_electricvortex=1093743698
 constant integer electricvortex_shackle=1093743697
 constant integer unitid_electricvortex=1966092376
 constant integer electricvortex_slow=1093743699
 constant integer abilityid_balllightning=1093743695
 integer balllightning_cache
 integer balllightning_level
 unit balllightning_source
 real balllightning_traveled
 constant integer abilityid_dragonstail=1093681490
+constant integer abilityid_dragonstail_learn=1093812553
+constant integer abilityid_dragonform=1093677895
 constant integer abilityid_fissure=1093686091
 constant integer abilityid_fissurestun=1093686090
 constant integer abilityid_echoslam=1093682248
 constant integer abilityid_echoslam_upgrade=1093750594
 constant integer abilityid_echoslam_fok=1093682253
 constant integer abilityid_echoslam_fok_half=1093748784
 unit array echoslam_caster
 unit array echoslam_caster_half
 constant integer abilityid_naturesattendants=1093677378
 constant integer abilityid_impetus=1093682265
 constant integer abilityid_impetus_upgrade=1093752642
 constant integer buffid_impetus=1110455125
 constant integer abilityid_enchant=1093682264
 constant integer abilityid_malefice=1093683511
 constant integer abilityid_maleficestun=1093677377
@@ -3472,31 +3511,31 @@
 constant integer shrapnel_slow=1093744966
 constant string fx_shrapnel="Abilities\\Weapons\\FlyingMachine\\FlyingMachineImpact.mdl"
 constant integer unitid_shrapnel_fx=1747990593
 unit shrapnel_source
 unit shrapnel_caster
 real shrapnel_damage
 constant integer abilityid_assassinate=1093678160
 constant integer abilityid_assassinateupgrade=1093747029
 constant integer unitid_smokescreen=1697656883
 constant integer abilityid_smokescreen=1093685831
 constant integer abilityid_smokescreensent=1093682487
 constant integer abilityid_smokescreenscourge=1093677369
 constant integer abilityid_smokescreenstun=1093682486
 constant integer abilityid_blinkstrikesa=1093684025
 constant integer abilityid_backstab=1093682266
-constant integer abilityid_warcry=1093746997
+constant integer abilityid_warcry=1093814611
 constant integer warcry_abilityid_1=1093748278
 constant integer warcry_abilityid_2=1093748279
 constant integer warcry_abilityid_3=1093748275
 constant integer warcry_abilityid_4=1093748277
 constant string warcry_fx="Abilities\\Spells\\NightElf\\BattleRoar\\RoarCaster.mdl"
 integer warcry_abilityid
 constant integer abilityid_godstrength=1093752648
 constant integer abilityid_stormbolt=1093744944
 constant integer unitid_stormbolt=1747990353
 constant integer stormbolt_stun=1093685850
 constant string stormbolt_fx="Abilities\\Spells\\Human\\StormBolt\\StormBoltMissile.mdl"
 constant string stormbolt_fx_attach="origin"
 unit stormbolt_caster
 constant integer abilityid_rabid_1=1093748038
 constant integer abilityid_rabid_2=1093748037
@@ -3548,30 +3587,33 @@
 integer ancestralcharge_attackbonus
 integer ancestralcharge_movementbonus
 unit array ancestralcharge_image
 boolean ancestralcharge_active=false
 boolean echostomp_ignore=false
 constant integer abilityid_suicidesound=1093678658
 trigger remotemine_deathtrigger
 integer remotemine_unitid
 player remotemine_player
 integer minescommand_count
 constant integer abilityid_marchofthemachines=1093681745
 constant integer abilityid_toss=1093681754
 unit toss_source
 real toss_damage
 unit toss_target
+constant integer grow_aghanim_treefix=1093815105
+constant integer grow_aghanim_treefix_to=1093815106
+constant integer grow_aghanim_treefix_from=1093815107
 constant integer abilityid_warclub_fake=1093752392
 constant integer abilityid_warclub_real=1093752391
 constant integer warclub_cleave=1093752625
 constant integer abilityid_grow_bonus1=1093742658
 constant integer abilityid_grow_bonus2=1093742657
 constant integer abilityid_grow_bonus3=1093687891
 constant integer abilityid_grow=1093682009
 constant integer abilityid_craggyexterior=1093744977
 constant integer craggyexterior_stun=1093681750
 constant integer avalanche_stun=1093742666
 constant integer avalanche_visual=1093742669
 constant integer abilityid_avalanche=1093684300
 unit avalanche_source
 real avalanche_damage
 constant integer abilityid_rampage=1093748042
@@ -3658,36 +3700,46 @@
 constant integer abilityid_berserkerscall=1093683510
 unit berserkerscall_unit
 constant integer abilityid_counterhelix=1093681974
 constant integer buffid_counterhelix=1110455120
 constant integer abilityid_cullingblade=1093682482
 constant integer abilityid_cullingblade_upgrade=1093750098
+constant integer cullingblade_haste=1093814595
+constant integer cullingblade_buffid=1110459990
 constant integer abilityid_nightmare=1093678169
 constant integer buffid_nightmare=1110454854
 constant integer abilityid_fiendsgrip=1093677649
 constant integer abilityid_fiendsgripupgrade=1093747769
 constant integer abilityid_enfeeble=1093678166
 constant integer enfeeble_1=1093808689
 constant integer enfeeble_2=1093808691
 constant integer enfeeble_3=1093808692
 constant integer enfeeble_4=1093808690
 constant integer abilityid_stickynapalm=1093748044
 integer array stickynapalm_slow_1
 integer array stickynapalm_slow_2
 integer array stickynapalm_slow_3
 integer array stickynapalm_slow_4
 constant integer buffid_stickynapalm=1110458963
@@ -3716,30 +3768,32 @@
 constant integer abilityid_bloodbath=1093684293
 constant string bloodbath_fx="Objects\\Spawnmodels\\Human\\HumanBlood\\HeroBloodElfBlood.mdl"
 unit bloodbath_target
 constant integer abilityid_rupture=1093684296
 constant integer abilityid_thirst=1093683512
 constant integer thirst_ms_1=1093808432
 constant integer thirst_ms_2=1093808433
 constant integer thirst_ms_3=1093808434
 constant integer thirst_ms_4=1093808435
 integer array thirst_ms
 constant integer buffid_thirst_1=1110455634
 constant integer buffid_thirst_2=1110459701
 constant integer buffid_thirst_3=1110459700
 constant integer buffid_thirst_4=1110459702
 constant integer thirst_fx=1093808436
+constant integer thirst_reveal=1093812552
+constant integer thirst_reveal_buffid=1110459737
 group thirst_group
 group thirst_tempgroup
 unit thirst_source
 integer thirst_level
 constant integer abilityid_bloodrage=1093682499
 constant integer abilityid_insatiablehunger=1093687121
 constant integer abilityid_spawnspiderlings=1093681736
 constant integer buffid_spawnspiderlings=1110459703
 constant integer abilityid_blinkstrike_ck=1093685847
 integer unitid_blinkstrike_ck_1=1747990090
 real blinkstrike_ck_x
 real blinkstrike_ck_y
 unit blinkstrike_ck_source
 unit blinkstrike_ck_target
 integer blinkstrike_debug=1
@@ -4143,30 +4197,34 @@
 constant integer zeal_regen_4=1093809976
 constant integer abilityid_sunder=1093678929
 constant integer abilityid_sundercaster=1093678930
 constant integer abilityid_reflection=1093809985
 constant integer reflection_slow_1=1093809752
 constant integer reflection_slow_2=1093809750
 constant integer reflection_slow_3=1093809753
 constant integer reflection_slow_4=1093809751
 constant integer reflection_slow_buffid=1110459722
 constant integer reflection_image=1093809227
 constant integer reflection_image_buffid=1110459726
 constant string reflection_fx="war3mapImported\\BlackChakraExplosion.mdx"
 constant integer abilityid_metamorph=1093751369
 constant integer metamorph_image=1093679185
 constant integer metamorph_buffid=1110459721
+constant integer abilityid_soulsteal=1093750856
+constant integer abilityid_soulsteal_dummy=1093678156
+constant integer abilityid_soulsteal_secondary=1093751361
+constant integer unitid_soulsteal=1966092615
 constant integer abilityid_krakenshell=1093678149
 constant real krakenshell_maxtime=6
 constant real krakenshell_maxdamage=600
 constant integer abilityid_ravage=1093810505
 constant integer abilityid_anchorsmash=1093808694
 constant integer anchorsmash_attack=1093808696
 constant integer anchorsmash_attack_buffid=1110459704
 constant string anchorsmash_fx="Abilities\\Spells\\Other\\CrushingWave\\CrushingWaveDamage.mdl"
 unit anchorsmash_source
 integer anchorsmash_level
 unit shadowwave_source
 constant integer abilityid_weave=1093742673
 constant integer abilityid_weaveupgrade=1093747778
 constant integer WEAVE_POSITIVE=1
 constant integer WEAVE_NEGATIVE=2
@@ -4224,48 +4282,58 @@
 constant integer gravekeeperscloak_level4_4=1093749826
 constant integer gravekeeperscloak_level4_5=1093749825
 constant integer gravekeeperscloak_level4_6=1093749814
 constant integer gravekeeperscloak_level4_7=1093749832
 constant integer gravekeeperscloakenemy_1=1093750067
 constant integer gravekeeperscloakenemy_2=1093750068
 constant integer gravekeeperscloakenemy_3=1093750083
 constant integer gravekeeperscloakenemy_4=1093750071
 constant integer gravekeeperscloakenemy_5=1093750072
 constant integer gravekeeperscloakenemy_6=1093750073
 constant integer gravekeeperscloakenemy_7=1093750081
 constant integer gravekeeperscloakenemy_8=1093750069
 constant integer gravekeeperscloakenemy_9=1093750082
 constant integer gravekeeperscloakenemy_10=1093750070
 constant integer abilityid_gargoyle=1093750341
+constant integer abilityid_gargoyle_upgrade=1093814599
 constant integer unitid_gargoyle_a_1=1966092596
 constant integer unitid_gargoyle_a_2=1966092597
 constant integer unitid_gargoyle_a_3=1966092598
 constant integer unitid_gargoyle_b_1=1966092612
 constant integer unitid_gargoyle_b_2=1966092613
 constant integer unitid_gargoyle_b_3=1966092614
+constant integer unitid_gargoyle_c_1=1966092626
+constant integer unitid_gargoyle_c_2=1966092627
+constant integer unitid_gargoyle_c_3=1966092628
 constant integer unitid_gargoyle_a_1_stone=1966092599
 constant integer unitid_gargoyle_a_2_stone=1966092601
 constant integer unitid_gargoyle_a_3_stone=1966092600
 constant integer unitid_gargoyle_b_1_stone=1966092609
 constant integer unitid_gargoyle_b_2_stone=1966092610
 constant integer unitid_gargoyle_b_3_stone=1966092611
+constant integer unitid_gargoyle_c_1_stone=1966092629
+constant integer unitid_gargoyle_c_2_stone=1966092630
+constant integer unitid_gargoyle_c_3_stone=1966092631
 constant integer abilityid_stoneform_a_1=1093750338
 constant integer abilityid_stoneform_a_2=1093750339
 constant integer abilityid_stoneform_a_3=1093750340
 constant integer abilityid_stoneform_b_1=1093750348
 constant integer abilityid_stoneform_b_2=1093750349
 constant integer abilityid_stoneform_b_3=1093750350
+constant integer abilityid_stoneform_c_1=1093814618
+constant integer abilityid_stoneform_c_2=1093814832
+constant integer abilityid_stoneform_c_3=1093814833
 constant integer stoneform_stun=1093750342
 constant integer gargole_damagemax=7
 constant integer gargole_damageregen=15
 constant integer abilityid_soulassumption=1093750337
 constant integer soulassumption_indicator_0=1093750577
 constant integer soulassumption_indicator_1=1093750578
 constant integer soulassumption_indicator_2=1093750362
 constant integer soulassumption_indicator_3=1093750329
 constant integer soulassumption_indicator_4=1093750361
 constant integer soulassumption_indicator_5=1093750576
 constant integer soulassumption_indicator_6=1093750579
 constant integer soulassumption_indicator_3_full=1093750583
 constant integer soulassumption_indicator_4_full=1093750584
 constant integer soulassumption_indicator_5_full=1093750585
 constant string soulassumption_fx="Abilities\\Spells\\Undead\\AntiMagicShell\\AntiMagicShell.mdl"
@@ -4332,31 +4400,31 @@
 unit iceblast_source
 constant string iceblast_fx="war3mapImported\\IceWindGroundFX.mdl"
 constant integer abilityid_chillingtouch=1093748817
 constant integer chillingtouch_icon=1093748814
 constant integer buffid_chillingtouch=1110459210
 constant integer chillingtouch_ias=1093749072
 constant string chillingtouch_fx="war3mapImported\\FrostHands.mdx"
 constant integer abilityid_darkpact=1093749069
 constant integer unitid_darkpact=1747993138
 unit darkpact_source
 constant integer abilityid_nightcrawler=1093749070
 constant integer nightcrawler_bonus1=1093749061
 constant integer nightcrawler_bonus2=1093749062
 constant integer nightcrawler_bonus3=1093749063
 constant integer nightcrawler_buff=1110459193
-constant real nightcrawler_buffer=0.6
+constant real nightcrawler_buffer=0.4
 constant real nightcrawler_interval=0.1
 constant integer abilityid_essenceshift=1093748818
 constant integer abilityid_shadowdance=1093749070
 constant integer shadowdance_invis1=1093748823
 constant integer shadowdance_invis2=1093748824
 constant string shadowdance_fx="war3mapImported\\SmokescreenBlack5.mdx"
 constant integer unitid_shadowdance=1747993137
 constant real shadowdance_duration=5.5
 constant integer abilityid_pounce=1093749303
 constant integer pounce_fx=1093749302
 constant real pounce_duration=3.5
 constant integer pounce_leashrange=325
 constant integer abilityid_scream=1093678145
 constant integer abilityid_shackle=1093677136
 constant integer abilityid_dash=1093751370
@@ -4591,30 +4659,267 @@
 constant integer spellsteal_real2=1093809991
 constant integer spellsteal_real3=1093810006
 constant integer abilityid_nullfield=1093810006
 constant integer nullfield_aura=1093810005
 constant integer buffid_nullfield=1110458960
 constant integer nullfield_bonus1=1093810003
 constant integer nullfield_bonus2=1093810001
 constant integer nullfield_bonus3=1093810002
 constant integer nullfield_bonus4=1093810004
 integer nullfield_level
 constant integer abilityid_exorcism_1=1093678899
 constant integer abilityid_exorcism_2=1093677898
 constant integer abilityid_exorcism_3=1093678154
 constant integer abilityid_exorcism_4=1093678157
 constant integer abilityid_exorcism_5=1093678158
+constant integer unitid_raijin=1211117651
+constant integer abilityid_retaliation=1093810518
+constant integer abilityid_retaliation_secondary=1093810519
+constant integer buffid_retaliation=1110459734
+constant integer powerup_retaliation=1227902776
+constant string retaliation_fx_shell="war3mapImported\\RetaliationShield.mdx"
+constant string retaliation_fx_second="war3mapImported\\RetaliationTarget.mdx"
+constant integer abilityid_firebarrier=1093814355
+constant integer firebarrier_barrier=1093814325
+constant integer firebarrier_speed=1093814327
+constant integer firebarrier_speed_buffid=1110459983
+constant integer firebarrier_barrier_buffid1=1110459984
+constant integer firebarrier_barrier_buffid2=1110459985
+constant integer firebarrier_damage_1=1093814616
+constant integer firebarrier_damage_2=1093814615
+constant integer firebarrier_damage_3=1093814614
+constant integer firebarrier_damage_4=1093814617
+unit firebarrier_source
+integer firebarrier_level
+constant integer abilityid_slightoffist=1093814320
+constant integer slightoffist_bonus_as=1093814329
+constant integer slightoffist_bonus_1=1093814856
+constant integer slightoffist_bonus_2=1093814855
+constant integer slightoffist_bonus_3=1093814858
+constant integer slightoffist_bonus_4=1093814857
+constant integer slightoffist_bonus_buffid_dmg=1110459980
+constant integer slightoffist_bonus_buffid_as=1110459981
+constant integer slightoffist_transform_in=1093814321
+constant integer slightoffist_transform_out=1093814322
+constant integer slightoffist_creepreduction=1093814854
+constant integer abilityid_fireshackles=1093814323
+constant integer fireshackles_ensnare=1093814324
+constant integer unitid_fireshackles=1747993904
+constant integer fireremnantpath_duration=10
+constant integer abilityid_fireremnant=1093814859
+constant integer abilityid_fireremnant_secondary=1093814860
+integer fireremnant_level
+unit fireremnant_source
+real fireremnant_x
+real fireremnant_y
+real fireremnant_d
+unit fireremnant_best
+constant string fireremnant_fx_hero="war3mapImported\\Phoenix_Missile_smaller.mdx"
+constant string fireremnant_fx_ground="war3mapImported\\FlameDash_Ground.mdx"
+constant string fireremnant_fx_impact="Abilities\\Weapons\\LordofFlameMissile\\LordofFlameMissile.mdl"
+constant integer fireremnant_dummyunit=1747993912
+integer array abilityid_fireremnant_place
+constant integer abilityid_arcaneseal=1093812536
+constant integer arcaneseal_silence=1093812535
+boolean arcaneseal_active=true
+constant integer abilityid_thrust=1093812537
+constant integer abilityid_conjureforce=1093812534
+unit conjureforce_caster
+integer conjureforce_level
+constant integer conjureforce_entangle=1093812549
+constant string conjureforce_fx="war3mapImported\\ConjureForceAoE.mdx"
+constant string conjureforce_fx_target="war3mapImported\\ConjureForceTarget.mdx"
+constant integer abilityid_divinewrath=1093812545
+constant integer abilityid_divinewrath_secondary=1093812546
+constant integer unitid_divinewrath=1747993673
+boolean divinewrath_active=true
+unit divinewrath_source
+group divinewrath_group
+real divinewrath_damage
+constant string divinewrath_fx_source="war3mapImported\\WispShellBlue_2.mdx"
+constant string divinewrath_fx="war3mapImported\\DivineWrathTarget.mdx"
+constant integer abilityid_wraith=1093812803
+constant integer abilityid_wraith_end=1093812804
+constant integer wraith_ms_buffid=1110459954
+constant integer wraith_ghost=1097167980
+constant integer wrath_magicbonus_1=1093812787
+constant integer wrath_magicbonus_2=1093812784
+constant integer wrath_magicbonus_3=1093812785
+constant integer wrath_magicbonus_4=1093812786
+constant integer abilityid_blackjack=1093812788
+constant integer abilityid_miasma=1093812789
+constant integer miasma_reveal_orderid=852625
+constant integer miasma_reveal=1093812791
+constant integer abilityid_brotherhood=1093814066
+constant integer brotherhood_fx=1093814607
+constant integer abilityid_gallop=1093812822
+constant integer gallop_ms_1=1093814604
+constant integer gallop_ms_2=1093814605
+constant integer gallop_ms_3=1093812825
+constant integer gallop_ms_4=1093814606
+constant integer gallop_ms_buffid=1110459956
+constant integer abilityid_momentofcourage=1093813593
+constant integer momentofcourage_bonus_1=1093814084
+constant integer momentofcourage_bonus_2=1093814085
+constant integer momentofcourage_bonus_3=1093814086
+constant integer momentofcourage_bonus_4=1093814083
+constant integer momentofcourage_bonus_buffid=1110459978
+constant integer momentofcourage_bonus_lifesteal_buffid=1110459979
+constant integer abilityid_duel=1093813065
+constant string duel_fx_source="war3mapImported\\DuelFX.mdx"
+constant string duel_fx_target="war3mapImported\\DuelFX.mdx"
+constant integer dual_doom=1093814069
+constant integer dual_doom_buffid=1110459975
+integer array duel_damagebonus_ability
+constant integer abilityid_deflection=1093814609
+constant string deflection_castfx="Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkZapTarget.mdl"
+constant string deflection_bufffx="Abilities\\Spells\\Orc\\SpiritLink\\SpiritLinkTarget.mdl"
+constant integer abilityid_presstheattack=1093814834
+constant string presstheattack_bufffx="Abilities\\Spells\\Human\\InnerFire\\InnerFireTarget.mdl"
+integer array presstheattack_speed
+constant integer abilityid_cleanse=1093814850
+constant string cleanse_fx="Abilities\\Spells\\Human\\DispelMagic\\DispelMagicTarget.mdl"
+constant integer cleanse_ms=1093814851
+constant integer cleanse_ms_buffid=1110459991
+integer cleanse_creeps
+integer cleanse_heroes
+integer cleanse_level
+constant integer abilityid_starbeam=1093812807
+constant string starbeam_fx="war3mapImported\\DivineWrathTarget.mdx"
+unit starbeam_source
+integer starbeam_count
+integer starbeam_level
+constant integer abilityid_amp=1093812820
+constant string amp_fx="Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl"
+constant string amp_fx_initial="war3mapImported\\FarseerMissile_Purple_2.mdx"
+constant integer amp_slow1=1093814582
+constant integer amp_slow2=1093814581
+constant integer amp_slow3=1093814583
+constant integer amp_slow4=1093814584
+constant integer amp_slow_buffid=1110459987
+boolean amp_allow=false
+constant integer abilityid_arcanebolt=1093812805
+constant integer arcanebolt_unitid=1747993681
+constant integer abilityid_arcanesilence=1093814350
+constant string arcanesilence_fx="Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl"
+constant integer arcanesilence_amp_1=1093814360
+constant integer arcanesilence_amp_2=1093814576
+constant integer arcanesilence_amp_3=1093814361
+constant integer arcanesilence_amp_4=1093814362
+constant integer abilityid_concussiveshot=1093814612
+constant integer unitid_concussiveshot=1747993910
+constant integer concussiveshot_slow=1093814613
+constant integer abilityid_deathwatch=1093813335
+constant string deathwatch_fx="war3mapImported\\GaiaShield.mdx"
+constant integer abilityid_realityshift=1093813336
+constant string realityshift_fx=""
+constant integer unitid_realityshift_1=1865429330
+constant integer unitid_realityshift_2=1865429331
+constant integer unitid_realityshift_3=1865429329
+constant integer unitid_realityshift_4=1865429332
+constant integer realityshift_banish=1093813337
+unit realityshift_caster
+real realityshift_distance
+group realityshift_group
+constant integer abilityid_hauntingechos=1093813552
+constant string hauntingechos_fx=""
+constant integer unitid_hauntingechos=1747993682
+constant integer hauntingechos_silence=1093813553
+unit hauntingechos_source
+integer hauntingechos_level
+constant integer abilityid_fatalattraction=1093813338
+constant string fatalattraction_fx=""
+constant integer abilityid_whirlingdeath=1093813835
+constant real whirlingdeath_aoe=300
+constant string whirlingdeath_fx="war3mapImported\\WhirlingDeath_01.mdx"
+integer whirlingdeath_type
+constant integer abilityid_timberchain=1093813555
+constant integer unitid_timberchain=1966092625
+constant integer unitid_timberchainhead=1966092624
+group timberchain_group
+integer timberchain_count
+constant integer abilityid_reactivearmor=1093813556
+integer array reactivearmor_bonus
+constant integer abilityid_chakram=1093813557
+constant integer abilityid_chakram_return=1093813848
+constant integer chakram_disableattack=1096971630
+constant real chakram_aoe=200
+constant real chakram_dps_aoe=200
+constant integer unitid_chakram=1747993683
+constant integer chakram_slow=1093813334
+group chakram_group
+unit chakram_source
+integer chakram_level
+constant integer abilityid_breeze=1093813582
+constant integer unitid_breeze=1747993688
+constant integer breeze_slow_1=1093813580
+constant integer breeze_slow_2=1093813579
+constant integer breeze_slow_3=1093813578
+constant integer breeze_slow_4=1093813581
+constant integer breeze_slow_buffid=1110459958
+unit breeze_source
+unit breeze_projectile
+group breeze_group
+constant integer abilityid_frostskin=1093813593
+constant integer frostskin_reduction_1=1093813592
+constant integer frostskin_reduction_2=1093813589
+constant integer frostskin_reduction_3=1093813590
+constant integer frostskin_reduction_4=1093813591
+constant integer frostskin_mana_1=1093813587
+constant integer frostskin_mana_2=1093813586
+constant integer frostskin_mana_3=1093813585
+constant integer frostskin_mana_4=1093813588
+constant integer abilityid_frostgiant=1093813594
+constant integer frostgiant_sourceid=1311788343
+constant integer unitid_frostgiant=1865429333
+constant integer abilityid_sonicboom=1093813812
+constant string sonicboom_impactfx="war3mapImported\\BlackDragonMissile.mdx"
+unit sonicboom_source
+integer sonicboom_level
+constant integer abilityid_windblast=1093813573
+constant integer windblast_armor=1093813811
+constant string windblast_fx="effects\\BasicWaterFlash.mdx"
+unit windblast_source
+integer windblast_level
+constant integer abilityid_windbarrier=1093813808
+constant integer windbarrier_speed=1093813810
+constant integer windbarrier_speed_buffid=1110459959
+constant integer windbarrier_barrier_buffid1=1110456374
+constant integer windbarrier_barrier_buffid2=1110456375
+constant integer abilityid_prevailingwinds=1093813813
+constant integer prevailingwinds_cyclone=1093813833
+constant integer prevailingwinds_slow_1=1093813828
+constant integer prevailingwinds_slow_2=1093813827
+constant integer prevailingwinds_slow_3=1093813829
+constant integer prevailingwinds_slow_buffid=1110459961
+constant integer prevailingwinds_haste_1=1093813831
+constant integer prevailingwinds_haste_2=1093813830
+constant integer prevailingwinds_haste_3=1093813832
+constant integer prevailingwinds_haste_buffid=1110459960
+constant integer abilityid_holyshackles=1093813844
+constant integer holyshackles_ensnare=1093813845
+constant integer unitid_holyshackles=1747993690
+constant integer abilityid_focus=1093813841
+constant integer focus_bonus=1093813838
+constant integer focus_bonus_buffid=1110459969
+constant integer abilityid_divineintervention=1093813836
+constant integer divineintervention_invul=1098282348
+constant string divineintervention_fx="Abilities\\Spells\\Human\\DivineShield\\DivineShieldTarget.mdl"
+constant integer divineintervention_doom=1093813847
+constant integer divineintervention_disableattack=1096971630
+constant integer abilityid_chill=1093813583
+constant integer chill_silence=1093813584
 endglobals
 function InitGlobals takes nothing returns nothing
 local integer i=0
 set i=0
 loop
 exitwhen(i>16)
 set udg_RevivalTimer[i]=0
 set i=i+1
 endloop
 set i=0
 loop
 exitwhen(i>100)
 set udg_HeroFlags[i]=false
 set i=i+1
 endloop
@@ -5074,53 +5379,48 @@
 call SetSoundParamsFromLabel(gg_snd_Death_Sentinel,"AllyHeroDiesNightElf")
 call SetSoundDuration(gg_snd_Death_Sentinel,1963)
 call SetSoundVolume(gg_snd_Death_Sentinel,127)
 set gg_snd_Death_Scourge=CreateSound("Sound\\Interface\\Warning\\Undead\\NecromancerAllyHeroDies1.wav",false,false,false,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_Death_Scourge,"AllyHeroDiesUndead")
 call SetSoundDuration(gg_snd_Death_Scourge,1933)
 call SetSoundVolume(gg_snd_Death_Scourge,127)
 set gg_snd_ReviveHuman=CreateSound("Abilities\\Spells\\Human\\ReviveHuman\\ReviveHuman.wav",false,false,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_ReviveHuman,"ReviveHuman")
 call SetSoundDuration(gg_snd_ReviveHuman,3196)
 call SetSoundChannel(gg_snd_ReviveHuman,8)
 set gg_snd_SecretFound=CreateSound("Sound\\Interface\\SecretFound.wav",false,false,false,10,10,"")
 call SetSoundParamsFromLabel(gg_snd_SecretFound,"SecretFound")
 call SetSoundDuration(gg_snd_SecretFound,2525)
 set gg_snd_UltraKill=CreateSound("Sounds\\UltraKill.mp3",false,false,false,10,10,"")
-call SetSoundDuration(gg_snd_UltraKill,2484)
+call SetSoundDuration(gg_snd_UltraKill,1958)
 call SetSoundChannel(gg_snd_UltraKill,0)
 call SetSoundVolume(gg_snd_UltraKill,127)
 call SetSoundPitch(gg_snd_UltraKill,1.0)
 set gg_snd_Rampage=CreateSound("Sounds\\Rampage.mp3",false,false,false,10,10,"")
-call SetSoundDuration(gg_snd_Rampage,1872)
+call SetSoundDuration(gg_snd_Rampage,1195)
 call SetSoundChannel(gg_snd_Rampage,0)
 call SetSoundVolume(gg_snd_Rampage,127)
 call SetSoundPitch(gg_snd_Rampage,1.0)
 set gg_snd_AltarOfEldersWhat1=CreateSound("Buildings\\NightElf\\AltarOfElders\\AltarOfEldersWhat1.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_AltarOfEldersWhat1,"AltarOfEldersWhat")
 call SetSoundDuration(gg_snd_AltarOfEldersWhat1,3496)
 set gg_snd_MysticSnakeCast=CreateSound("Units\\Orc\\AncestralGuardian\\AncestralGuardianAttack1.wav",false,true,true,10,10,"CombatSoundsEAX")
 call SetSoundParamsFromLabel(gg_snd_MysticSnakeCast,"AncestralGuardianAttack1")
 call SetSoundDuration(gg_snd_MysticSnakeCast,1181)
 set gg_snd_MysticSnakeHit=CreateSound("Abilities\\Spells\\Human\\Feedback\\Feedback.wav",false,true,true,10,10,"SpellsEAX")
 call SetSoundParamsFromLabel(gg_snd_MysticSnakeHit,"Feedback")
 call SetSoundDuration(gg_snd_MysticSnakeHit,1222)
-set gg_snd_SotS2=CreateSound("war3mapImported\\SotS2.mp3",false,false,false,10,10,"")
-call SetSoundDuration(gg_snd_SotS2,6824)
-call SetSoundChannel(gg_snd_SotS2,0)
-call SetSoundVolume(gg_snd_SotS2,127)
-call SetSoundPitch(gg_snd_SotS2,1.0)
 set gg_snd_AbominationPissed5=CreateSound("Units\\Undead\\Abomination\\AbominationPissed5.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_AbominationPissed5,"AbominationPissed")
 call SetSoundDuration(gg_snd_AbominationPissed5,1735)
 set gg_snd_AbominationDeath1=CreateSound("Units\\Undead\\Abomination\\AbominationDeath1.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_AbominationDeath1,"AbominationDeath")
 call SetSoundDuration(gg_snd_AbominationDeath1,2455)
 set gg_snd_ArtilleryCorpseExplodeDeath1=CreateSound("Sound\\Units\\Death\\ArtilleryCorpseExplodeDeath1.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_ArtilleryCorpseExplodeDeath1,"ArtilleryExplodeDeath")
 call SetSoundDuration(gg_snd_ArtilleryCorpseExplodeDeath1,1486)
 set gg_snd_CryptFiendPissed2=CreateSound("Units\\Undead\\CryptFiend\\CryptFiendPissed2.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_CryptFiendPissed2,"CryptFiendPissed")
 call SetSoundDuration(gg_snd_CryptFiendPissed2,3541)
 set gg_snd_BansheeDeath=CreateSound("Units\\Undead\\Banshee\\BansheeDeath.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_BansheeDeath,"BansheeDeath")
 call SetSoundDuration(gg_snd_BansheeDeath,2380)
@@ -5142,31 +5442,31 @@
 call SetSoundPitch(gg_snd_CloudOfFogLoop1,0.9)
 set gg_snd_GyrocopterPissed1=CreateSound("Units\\Human\\Gyrocopter\\GyrocopterPissed1.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_GyrocopterPissed1,"GyrocopterPissed")
 call SetSoundDuration(gg_snd_GyrocopterPissed1,3913)
 set gg_snd_Other6="Sound\\Music\\mp3Music\\Tension.mp3"
 set gg_snd_Other7="Sound\\Music\\mp3Music\\ArthasTheme.mp3"
 set gg_snd_Other8="Sound\\Music\\mp3Music\\NightElfDefeat.mp3"
 set gg_snd_Other9="Sound\\Music\\mp3Music\\NightElfVictory.mp3"
 set gg_snd_SecretFound01=CreateSound("Sound\\Interface\\SecretFound.wav",false,false,false,10,10,"")
 call SetSoundParamsFromLabel(gg_snd_SecretFound01,"SecretFound")
 call SetSoundDuration(gg_snd_SecretFound01,2525)
 set gg_snd_Hint=CreateSound("Sound\\Interface\\Hint.wav",false,false,false,10,10,"")
 call SetSoundParamsFromLabel(gg_snd_Hint,"Hint")
 call SetSoundDuration(gg_snd_Hint,2006)
 set gg_snd_walruspunch=CreateSound("war3mapImported\\pl_impact_stun.mp3",false,true,true,10,10,"SpellsEAX")
-call SetSoundDuration(gg_snd_walruspunch,2299)
+call SetSoundDuration(gg_snd_walruspunch,1340)
 call SetSoundChannel(gg_snd_walruspunch,11)
 call SetSoundVolume(gg_snd_walruspunch,127)
 call SetSoundPitch(gg_snd_walruspunch,1.0)
 call SetSoundDistances(gg_snd_walruspunch,600.0,10000.0)
 call SetSoundDistanceCutoff(gg_snd_walruspunch,2000.0)
 call SetSoundConeAngles(gg_snd_walruspunch,0.0,0.0,127)
 call SetSoundConeOrientation(gg_snd_walruspunch,0.0,0.0,0.0)
 set gg_snd_Sunray=CreateSound("Sound\\Buildings\\Fire\\OrcHumanLargeBuildingFire1.wav",true,true,true,10,10,"SpellsEAX")
 call SetSoundParamsFromLabel(gg_snd_Sunray,"HumanFireLarge")
 call SetSoundDuration(gg_snd_Sunray,3471)
 set gg_snd_FireSpiritsReady=CreateSound("Units\\Human\\Phoenix\\PhoenixEggWhat1.wav",false,false,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_FireSpiritsReady,"PhoenixEggWhat")
 call SetSoundDuration(gg_snd_FireSpiritsReady,1579)
 call SetSoundChannel(gg_snd_FireSpiritsReady,0)
 set gg_snd_BattleRoar=CreateSound("Abilities\\Spells\\NightElf\\BattleRoar\\BattleRoar.wav",false,true,true,10,10,"SpellsEAX")
@@ -5185,30 +5485,33 @@
 call SetSoundDuration(gg_snd_SpellStealTarget,984)
 set gg_snd_AcolyteMining=CreateSound("Abilities\\Spells\\Undead\\UndeadMine\\AcolyteMining.wav",false,true,true,10,10,"DefaultEAXON")
 call SetSoundParamsFromLabel(gg_snd_AcolyteMining,"AcolyteMining")
 call SetSoundDuration(gg_snd_AcolyteMining,4233)
 call SetSoundChannel(gg_snd_AcolyteMining,0)
 set gg_snd_DestroyerMissile=CreateSound("Abilities\\Weapons\\AvengerMissile\\DestroyerMissile.wav",false,true,true,10,10,"MissilesEAX")
 call SetSoundParamsFromLabel(gg_snd_DestroyerMissile,"DestroyerMissileLaunch")
 call SetSoundDuration(gg_snd_DestroyerMissile,817)
 set gg_snd_SpiritTouch=CreateSound("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouch.wav",false,true,true,10,10,"SpellsEAX")
 call SetSoundParamsFromLabel(gg_snd_SpiritTouch,"SpiritTouch")
 call SetSoundDuration(gg_snd_SpiritTouch,2043)
 call SetSoundChannel(gg_snd_SpiritTouch,11)
 set gg_snd_FlameStrikeTargetWaveNonLoop101=CreateSound("Abilities\\Spells\\Human\\FlameStrike\\FlameStrikeTargetWaveNonLoop1.wav",false,true,true,10,10,"SpellsEAX")
 call SetSoundParamsFromLabel(gg_snd_FlameStrikeTargetWaveNonLoop101,"FlameStrikeTarget")
 call SetSoundDuration(gg_snd_FlameStrikeTargetWaveNonLoop101,1927)
+set gg_snd_RainOfFireTarget2=CreateSound("Abilities\\Spells\\Demon\\RainOfFire\\RainOfFireTarget2.wav",false,true,true,10,10,"SpellsEAX")
+call SetSoundParamsFromLabel(gg_snd_RainOfFireTarget2,"StarfallTarget")
+call SetSoundDuration(gg_snd_RainOfFireTarget2,3000)
 endfunction
 function CreateBuildingsForPlayer0 takes nothing returns nothing
 local player p=Player(0)
 local unit u
 local integer unitID
 local trigger t
 local real life
 set gg_unit_nC38_0018=CreateUnit(p,1849897784,-7264.0,-6880.0,270.000)
 call SetUnitColor(gg_unit_nC38_0018,ConvertPlayerColor(12))
 set gg_unit_n01K_0019=CreateUnit(p,1848652107,-7264.0,-6688.0,270.000)
 call SetUnitColor(gg_unit_n01K_0019,ConvertPlayerColor(12))
 set gg_unit_n009_0020=CreateUnit(p,1848651833,-6560.0,-6432.0,270.000)
 call SetUnitColor(gg_unit_n009_0020,ConvertPlayerColor(12))
 set gg_unit_n00X_0021=CreateUnit(p,1848651864,-7072.0,-6368.0,270.000)
 call SetUnitColor(gg_unit_n00X_0021,ConvertPlayerColor(1))
@@ -5771,31 +6074,31 @@
 function TI_AddDestructable takes destructable d returns integer
 set TI_Destructable_Index=TI_Destructable_Index+1
 if TI_Destructable_Index>24000 then
 set TI_DestructablePool3[TI_Destructable_Index-16000]=d
 elseif TI_Destructable_Index>8000 then
 set TI_DestructablePool2[TI_Destructable_Index-8000]=d
 else
 set TI_DestructablePool1[TI_Destructable_Index]=d
 endif
 return TI_Destructable_Index
 endfunction
 function GetTime takes nothing returns real
 return TimerGetElapsed(udg_GameTimer)
 endfunction
 function IsBlocked takes unit u returns boolean
-return GetUnitAbilityLevel(u,buffid_linkensphere)>0 or GetUnitAbilityLevel(u,1112437619)>0
+return GetUnitAbilityLevel(u,buffid_linkensphere)>0 or GetUnitAbilityLevel(u,1112437619)>0 or GetUnitAbilityLevel(u,buffid_retaliation)>0
 endfunction
 function KillGroup takes group g returns nothing
 local integer i=GetHandleId(g)-GG_BaseHandleIndex
 if i<0 or i>GG_MAX then
 set GG_DisplayBug=true
 else
 call GroupClear(g)
 set GG_Used[i]=false
 set GG_NextAvailable=i
 endif
 endfunction
 function GetAvailableGroup takes nothing returns group
 local integer i=GG_NextAvailable
 loop
 exitwhen i==GG_NextAvailable-1
@@ -5975,31 +6278,31 @@
 return HEROTYPE_STR
 endif
 set x=x+1
 endloop
 set x=1
 loop
 exitwhen x>IntelligenceHeroCount
 if id==IntelligenceHero[x]then
 return HEROTYPE_INT
 endif
 set x=x+1
 endloop
 if id==1164277357 or id==1160786518 or id==1160786519 or id==1160786517 or id==1311781442 or id==1311781175 or id==1211119684 or id==1211119683 or id==1211119668 or id==1211119682 or id==1311781171 or id==1311781172 or id==1311781173 or id==1160786511 then
 return HEROTYPE_AGI
 endif
-if id==1311781192 or id==1311781204 or id==1311781194 or id==1211117637 or id==1211117639 or id==1211117638 or id==1211119433 or id==1160786229 or id==1211122513 then
+if id==1311781192 or id==1311781204 or id==1311781194 or id==1211117637 or id==1211117639 or id==1211117638 or id==1211119433 or id==1160786229 or id==1211122513 or id==1211122995 or id==1211122996 or id==1211122997 or id==1429221720 then
 return HEROTYPE_STR
 endif
 if id==1211119192 or id==1211119193 or id==1211119191 or id==1211122243 or id==1328558391 then
 return HEROTYPE_INT
 endif
 return 0
 endfunction
 function GetPrimaryStat takes unit Hero returns integer
 local integer HeroType=GetHeroType(Hero)
 if HeroType==HEROTYPE_INT then
 return GetHeroInt(Hero,true)
 endif
 if HeroType==HEROTYPE_AGI then
 return GetHeroAgi(Hero,true)
 endif
@@ -6310,31 +6613,31 @@
 local integer Picked=udg_Set[Rand]
 set Picked=udg_Set[Rand]
 if(udg_SetLowBound==udg_SetHighBound)then
 set udg_Set[Rand]=0
 return Picked
 endif
 if(Rand==udg_SetHighBound)then
 set udg_SetHighBound=udg_SetHighBound-1
 return Picked
 endif
 set udg_Set[Rand]=udg_Set[udg_SetHighBound]
 set udg_SetHighBound=udg_SetHighBound-1
 return Picked
 endfunction
 function IsSilenced takes unit whichUnit returns boolean
-return GetUnitAbilityLevel(whichUnit,1110454612)>0 or GetUnitAbilityLevel(whichUnit,1112437609)>0 or GetUnitAbilityLevel(whichUnit,1110454616)>0 or GetUnitAbilityLevel(whichUnit,1112433775)>0 or GetUnitAbilityLevel(whichUnit,1110454861)>0 or GetUnitAbilityLevel(whichUnit,1114137953)>0 or GetUnitAbilityLevel(whichUnit,1110456150)>0 or GetUnitAbilityLevel(whichUnit,1110458969)>0 or GetUnitAbilityLevel(whichUnit,1110456399)>0 or GetUnitAbilityLevel(whichUnit,1110456149)>0 or GetUnitAbilityLevel(whichUnit,1110459468)>0 or GetUnitAbilityLevel(whichUnit,1110456406)>0 or GetUnitAbilityLevel(whichUnit,1110455089)>0
+return GetUnitAbilityLevel(whichUnit,1110454612)>0 or GetUnitAbilityLevel(whichUnit,1112437609)>0 or GetUnitAbilityLevel(whichUnit,1110454616)>0 or GetUnitAbilityLevel(whichUnit,1112433775)>0 or GetUnitAbilityLevel(whichUnit,1110454861)>0 or GetUnitAbilityLevel(whichUnit,1114137953)>0 or GetUnitAbilityLevel(whichUnit,1110456150)>0 or GetUnitAbilityLevel(whichUnit,1110458969)>0 or GetUnitAbilityLevel(whichUnit,1110456399)>0 or GetUnitAbilityLevel(whichUnit,1110456149)>0 or GetUnitAbilityLevel(whichUnit,1110459468)>0 or GetUnitAbilityLevel(whichUnit,1110456406)>0 or GetUnitAbilityLevel(whichUnit,1110455089)>0 or GetUnitAbilityLevel(whichUnit,1110459988)>0 or GetUnitAbilityLevel(whichUnit,1110459975)>0
 endfunction
 function HexToInt_Child takes string Char returns integer
 if Char=="a"then
 return 10
 elseif Char=="b"then
 return 11
 elseif Char=="c"then
 return 12
 elseif Char=="d"then
 return 13
 elseif Char=="e"then
 return 14
 elseif Char=="f"then
 return 15
 else
@@ -6635,31 +6938,31 @@
 set HighBound=SentMax
 else
 set LowBound=ScourgeMin
 set HighBound=ScourgeMax
 endif
 elseif Sent then
 set LowBound=SentMin
 set HighBound=SentMax
 else
 set LowBound=ScourgeMin
 set HighBound=ScourgeMax
 endif
 return GetRandomInt(LowBound,HighBound)
 endfunction
 function IsBasicCourier takes unit whichUnit returns boolean
-return GetUnitTypeId(whichUnit)==unitid_goodcourier1 or GetUnitTypeId(whichUnit)==unitid_goodcourier2 or GetUnitTypeId(whichUnit)==unitid_goodcourier3 or GetUnitTypeId(whichUnit)==unitid_goodcourier4 or GetUnitTypeId(whichUnit)==unitid_goodcourier5 or GetUnitTypeId(whichUnit)==unitid_goodcourier6 or GetUnitTypeId(whichUnit)==unitid_badcourier1 or GetUnitTypeId(whichUnit)==unitid_badcourier2 or GetUnitTypeId(whichUnit)==unitid_badcourier3 or GetUnitTypeId(whichUnit)==unitid_badcourier4 or GetUnitTypeId(whichUnit)==unitid_badcourier5 or GetUnitTypeId(whichUnit)==unitid_jokecourier1 or GetUnitTypeId(whichUnit)==unitid_jokecourier2 or GetUnitTypeId(whichUnit)==unitid_jokecourier4
+return GetUnitTypeId(whichUnit)==unitid_goodcourier1 or GetUnitTypeId(whichUnit)==unitid_goodcourier2 or GetUnitTypeId(whichUnit)==unitid_goodcourier3 or GetUnitTypeId(whichUnit)==unitid_goodcourier4 or GetUnitTypeId(whichUnit)==unitid_goodcourier5 or GetUnitTypeId(whichUnit)==unitid_goodcourier6 or GetUnitTypeId(whichUnit)==unitid_badcourier1 or GetUnitTypeId(whichUnit)==unitid_badcourier2 or GetUnitTypeId(whichUnit)==unitid_badcourier3 or GetUnitTypeId(whichUnit)==unitid_badcourier4 or GetUnitTypeId(whichUnit)==unitid_badcourier5 or GetUnitTypeId(whichUnit)==unitid_badcourier6 or GetUnitTypeId(whichUnit)==unitid_jokecourier1 or GetUnitTypeId(whichUnit)==unitid_jokecourier2 or GetUnitTypeId(whichUnit)==unitid_jokecourier4
 endfunction
 function IsFlyingCourier takes unit whichUnit returns boolean
 return GetUnitTypeId(whichUnit)==unitid_goodcourier0 or GetUnitTypeId(whichUnit)==unitid_badcourier0 or GetUnitTypeId(whichUnit)==unitid_jokecourier3 or GetUnitTypeId(whichUnit)==unitid_flyingcourier1 or GetUnitTypeId(whichUnit)==unitid_flyingcourier2 or GetUnitTypeId(whichUnit)==unitid_flyingcourier3
 endfunction
 function IsCourier takes unit whichUnit returns boolean
 return IsBasicCourier(whichUnit)or IsFlyingCourier(whichUnit)
 endfunction
 function IsTree takes destructable d returns boolean
 return GetDestructableTypeId(d)==1314157667 or GetDestructableTypeId(d)==1314157687 or GetDestructableTypeId(d)==1096053874 or GetDestructableTypeId(d)==1110454322 or GetDestructableTypeId(d)==1110454323 or GetDestructableTypeId(d)==1110454325
 endfunction
 function IsMagicImmune takes unit u returns boolean
 return GetUnitAbilityLevel(u,1093686070)>0 or GetUnitAbilityLevel(u,abilityid_chargeofdarkness_immunity)>0 or GetUnitAbilityLevel(u,1094937961)>0 or GetUnitAbilityLevel(u,1093686101)>0 or GetUnitAbilityLevel(u,1110454580)>0 or GetUnitAbilityLevel(u,1093683251)>0 or((LoadInteger(hash_main,(GetHandleId(((u)))),((4252))))==HERO_STATE_ON)
 endfunction
 function IsCasterUnit takes unit caster returns boolean
 return GetUnitAbilityLevel(caster,1093678162)>0 and IsRealPlayer(GetOwningPlayer(caster))
@@ -7207,31 +7510,31 @@
 endloop
 endfunction
 function TriggerRegisterRealUnitEvent takes trigger t,playerunitevent whichEvent returns nothing
 local integer i=1
 loop
 exitwhen i>5
 call TriggerRegisterPlayerUnitEvent(t,udg_SentPlayers[i],whichEvent,Condition(function TriggerRegisterAnyUnitEvent_True))
 call TriggerRegisterPlayerUnitEvent(t,udg_ScourgePlayers[i],whichEvent,Condition(function TriggerRegisterAnyUnitEvent_True))
 set i=i+1
 endloop
 endfunction
 function GetDist takes real x1,real y1,real x2,real y2 returns real
 return SquareRoot(((x1-x2)*(x1-x2))+((y1-y2)*(y1-y2)))
 endfunction
 function KillTrees_Kill takes nothing returns nothing
-if IsTree(GetEnumDestructable())then
+if IsTree(GetEnumDestructable())and IsDestructableAliveBJ(GetEnumDestructable())then
 set treecount=treecount+1
 call KillDestructable(GetEnumDestructable())
 endif
 endfunction
 function KillTrees takes real x,real y,real d returns integer
 local rect r=Rect(x-d,y-d,x+d,y+d)
 set treecount=0
 call EnumDestructablesInRect(r,Condition(function GenericCondition_True),function KillTrees_Kill)
 call RemoveRect(r)
 set r=null
 return treecount
 endfunction
 function IsPathable takes real x,real y returns boolean
 if IsTerrainPathable(x,y,PATHING_TYPE_WALKABILITY)then
 return false
@@ -8035,30 +8338,38 @@
 set grouppickclosestunit_unit=null
 set grouppickclosestunit_x=x
 set grouppickclosestunit_y=y
 call ForGroup(g,function GroupPickClosestUnit_Search)
 return grouppickclosestunit_unit
 endfunction
 function SetAbilityUnavailableToAll takes integer abilityid returns nothing
 local integer i=0
 loop
 exitwhen i>5
 call SetPlayerAbilityAvailable(udg_SentPlayers[i],abilityid,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[i],abilityid,false)
 set i=i+1
 endloop
 endfunction
+function HideAbilityForAll takes integer id returns nothing
+local integer i=0
+loop
+exitwhen i>bj_MAX_PLAYERS
+call SetPlayerAbilityAvailable(Player(i),id,false)
+set i=i+1
+endloop
+endfunction
 function InitTrig_Globals takes nothing returns nothing
 endfunction
 function IntializeRegions takes nothing returns nothing
 set region_senthealing=CreateRegion()
 call RegionAddRect(region_senthealing,gg_rct_Recreate1)
 set region_scourgehealing=CreateRegion()
 call RegionAddRect(region_scourgehealing,gg_rct_Recreate2)
 set region_sentbase=CreateRegion()
 call RegionAddRect(region_sentbase,gg_rct_Base_1)
 call RegionAddRect(region_sentbase,gg_rct_Base_1b)
 call RegionAddRect(region_sentbase,gg_rct_Base_1c)
 set region_scourgebase=CreateRegion()
 call RegionAddRect(region_scourgebase,gg_rct_Base_2)
 call RegionAddRect(region_scourgebase,gg_rct_Base_2b)
 call RegionAddRect(region_scourgebase,gg_rct_Base_2c)
@@ -8183,31 +8494,43 @@
 local integer i=0
 local item Item
 loop
 exitwhen i>5
 set Item=UnitItemInSlot(Hero,i)
 call SetItemDroppable(Item,true)
 set i=i+1
 endloop
 set Hero=null
 set Item=null
 endfunction
 function IsNotAttackable takes unit u returns boolean
 return GetUnitAbilityLevel(u,1097167980)>0 or GetUnitAbilityLevel(u,1113815395)>0 or GetUnitAbilityLevel(u,1113815346)>0 or GetUnitAbilityLevel(u,1110454606)>0
 endfunction
 function IsEnsnared takes unit u returns boolean
-return(GetUnitAbilityLevel((u),(1110459185))>0)or(GetUnitAbilityLevel((u),(1111844210))>0)or(GetUnitAbilityLevel((u),(1113943655))>0)or(GetUnitAbilityLevel((u),(1113943649))>0)or(GetUnitAbilityLevel((u),(1110454583))>0)or(GetUnitAbilityLevel((u),(1110456120))>0)or(GetUnitAbilityLevel((u),(1110456390))>0)or(GetUnitAbilityLevel((u),(1110456389))>0)or(GetUnitAbilityLevel((u),(1110459730))>0)
+return(GetUnitAbilityLevel((u),(1110459185))>0)or(GetUnitAbilityLevel((u),(1111844210))>0)or(GetUnitAbilityLevel((u),(1113943655))>0)or(GetUnitAbilityLevel((u),(1113943649))>0)or(GetUnitAbilityLevel((u),(1110454583))>0)or(GetUnitAbilityLevel((u),(1110456120))>0)or(GetUnitAbilityLevel((u),(1110456390))>0)or(GetUnitAbilityLevel((u),(1110456389))>0)or(GetUnitAbilityLevel((u),(1110459730))>0)or(GetUnitAbilityLevel((u),(1110459982))>0)
+endfunction
+function RemoveAllEnsnare takes unit u returns nothing
+call UnitRemoveAbility(u,1110459185)
+call UnitRemoveAbility(u,1111844210)
+call UnitRemoveAbility(u,1113943655)
+call UnitRemoveAbility(u,1113943649)
+call UnitRemoveAbility(u,1110454583)
+call UnitRemoveAbility(u,1110456120)
+call UnitRemoveAbility(u,1110456390)
+call UnitRemoveAbility(u,1110456389)
+call UnitRemoveAbility(u,1110459730)
+call UnitRemoveAbility(u,1110459982)
 endfunction
 function IsStunned takes unit u returns boolean
 return(GetUnitAbilityLevel((u),(1110454344))>0)or(GetUnitAbilityLevel((u),(1112500344))>0)or(GetUnitAbilityLevel((u),(1112560453))>0)or(GetUnitAbilityLevel((u),(1110456633))>0)or(GetUnitAbilityLevel((u),(1112757326))>0)or(GetUnitAbilityLevel((u),(1110459206))>0)or(GetUnitAbilityLevel((u),(1110458957))>0)or(GetUnitAbilityLevel((u),(1110455885))>0)or(GetUnitAbilityLevel((u),(1110456142))>0)or(GetUnitAbilityLevel((u),(1110456403))>0)or(GetUnitAbilityLevel((u),(1110454353))>0)or(GetUnitAbilityLevel((u),(1110455382))>0)or(GetUnitAbilityLevel((u),(1110456114))>0)or(GetUnitAbilityLevel((u),(1112891758))>0)or(GetUnitAbilityLevel((u),(1110456629))>0)or(GetUnitAbilityLevel((u),(1110455113))>0)or(GetUnitAbilityLevel((u),(1110458692))>0)or(GetUnitAbilityLevel((u),(1110458693))>0)or(GetUnitAbilityLevel((u),(1110458949))>0)or(GetUnitAbilityLevel((u),(1110458950))>0)or(GetUnitAbilityLevel((u),(1110454328))>0)or(GetUnitAbilityLevel((u),(1110455362))>0)or(GetUnitAbilityLevel((u),(1110454854))>0)or(GetUnitAbilityLevel((u),(1112896368))>0)or(GetUnitAbilityLevel((u),(1112896372))>0)or(GetUnitAbilityLevel((u),(1110459460))>0)or((LoadInteger(hash_main,(GetHandleId((u))),((4293))))==HERO_STATE_ON)==true or((LoadInteger(hash_main,(GetHandleId((u))),((4303))))==HERO_STATE_ON)or(GetUnitAbilityLevel((u),(1110459186))>0)or(GetUnitAbilityLevel((u),(1110455891))>0)or(GetUnitAbilityLevel((u),(1110454867))>0)or(GetUnitAbilityLevel((u),(1110456133))>0)
 endfunction
 function IsReallyStunned takes unit u returns boolean
 return IsStunned(u)or IsEnsnared(u)or IsUnitPaused(u)or IsCycloned(u)
 endfunction
 function SetTime takes integer Minutes,integer Seconds,boolean extraColor returns nothing
 local integer x=0
 loop
 exitwhen x>15
 call SetPlayerState(Player(x),PLAYER_STATE_RESOURCE_LUMBER,Minutes)
 call SetPlayerState(Player(x),PLAYER_STATE_RESOURCE_FOOD_USED,Seconds)
 set x=x+1
 endloop
@@ -8242,31 +8565,31 @@
 set NewX=x-i*20
 set NewY=y+i*20
 if IsPointInRegion(region_badplaces,NewX,NewY)==false then
 return Location(NewX,NewY)
 endif
 set NewX=x-i*20
 set NewY=y-i*20
 if IsPointInRegion(region_badplaces,NewX,NewY)==false then
 return Location(NewX,NewY)
 endif
 set i=i+1
 endloop
 return Location(x,y)
 endfunction
 function GenericCondition_IsDotAInvis takes unit u returns boolean
-return GetUnitAbilityLevel(u,1110455864)>0 or GetUnitAbilityLevel(u,1110456148)>0 or GetUnitAbilityLevel(u,1110456118)>0 or GetUnitAbilityLevel(u,1112504171)>0 or GetUnitAbilityLevel(u,1110455378)>0 or GetUnitAbilityLevel(u,1110458677)>0 or GetUnitAbilityLevel(u,1110454609)>0 or GetUnitAbilityLevel(u,1110454326)>0 or GetUnitAbilityLevel(u,1114205814)>0 or GetUnitAbilityLevel(u,1097886070)>0 or GetUnitAbilityLevel(u,1093677617)>0 or GetUnitAbilityLevel(u,1093684020)>0 or GetUnitAbilityLevel(u,1093687362)>0 or GetUnitAbilityLevel(u,1093687858)>0 or GetUnitAbilityLevel(u,1093748545)>0 or GetUnitAbilityLevel(u,1093748823)>0 or GetUnitAbilityLevel(u,1093748824)>0 or GetUnitAbilityLevel(u,1093677130)>0 or GetUnitAbilityLevel(u,1110456395)>0 or GetUnitAbilityLevel(u,1110456408)>0 or GetUnitAbilityLevel(u,1110455097)>0 or GetUnitAbilityLevel(u,1110454347)>0 or GetUnitAbilityLevel(u,1112041075)>0 or GetUnitAbilityLevel(u,1093743664)>0 or GetUnitAbilityLevel(u,1110454833)>0 or GetUnitAbilityLevel(u,1093687876)>0
+return GetUnitAbilityLevel(u,1110455864)>0 or GetUnitAbilityLevel(u,1110456148)>0 or GetUnitAbilityLevel(u,1110456118)>0 or GetUnitAbilityLevel(u,1112504171)>0 or GetUnitAbilityLevel(u,1110455378)>0 or GetUnitAbilityLevel(u,1110458677)>0 or GetUnitAbilityLevel(u,1110454609)>0 or GetUnitAbilityLevel(u,1110454326)>0 or GetUnitAbilityLevel(u,1114205814)>0 or GetUnitAbilityLevel(u,1097886070)>0 or GetUnitAbilityLevel(u,1093677617)>0 or GetUnitAbilityLevel(u,1093684020)>0 or GetUnitAbilityLevel(u,1093687362)>0 or GetUnitAbilityLevel(u,1093687858)>0 or GetUnitAbilityLevel(u,1093748545)>0 or GetUnitAbilityLevel(u,1093748823)>0 or GetUnitAbilityLevel(u,1093748824)>0 or GetUnitAbilityLevel(u,1093677130)>0 or GetUnitAbilityLevel(u,1110456395)>0 or GetUnitAbilityLevel(u,1110456408)>0 or GetUnitAbilityLevel(u,1110455097)>0 or GetUnitAbilityLevel(u,1110454347)>0 or GetUnitAbilityLevel(u,1112041075)>0 or GetUnitAbilityLevel(u,1093743664)>0 or GetUnitAbilityLevel(u,1110454833)>0 or GetUnitAbilityLevel(u,1093687876)>0 or GetUnitAbilityLevel(u,1093684052)>0
 endfunction
 function GenericCondition_IsBear takes unit whichUnit returns boolean
 local integer TypeId=GetUnitTypeId(whichUnit)
 return TypeId==1848651828 or TypeId==1848652103 or TypeId==1848652099 or TypeId==1848652088 or TypeId==1697656907 or TypeId==1697656905 or TypeId==1697656908 or TypeId==1697657162
 endfunction
 function GenericCondition_Basics takes nothing returns boolean
 return GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false
 endfunction
 function GenericCondition_BasicsNoBlocker takes nothing returns boolean
 return(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and GetUnitAbilityLevel(GetFilterUnit(),1093751362)==0
 endfunction
 function GenericCondition_BasicsAndVisible takes nothing returns boolean
 return(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
 endfunction
 function GenericCondition_BasicsAndStructure takes nothing returns boolean
@@ -8426,31 +8749,31 @@
 return((IsUnitEnemy(tt_unit1,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(tt_unit1)))and IsNotAttackable(GetFilterUnit())==false
 endfunction
 function GenericCondition_RegularUnits takes nothing returns boolean
 return(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit()))
 endfunction
 function GenericCondition_RegularUnitsExVisible takes nothing returns boolean
 return((GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(tt_unit1))
 endfunction
 function GenericCondition_RegularUnitsExVisibleNoImmune takes nothing returns boolean
 return IsMagicImmune(GetFilterUnit())==false and((GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit())))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(tt_unit1))
 endfunction
 function GenericCondition_ValidCorpse takes nothing returns boolean
 return GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsDead(GetFilterUnit())==true and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==false and IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false and GetUnitTypeId(GetFilterUnit())!=unitid_tombstone_zombie
 endfunction
 function GenericCondition_FloatingHeroes takes nothing returns boolean
-return GetUnitTypeId(GetFilterUnit())==1211117637 or GetUnitTypeId(GetFilterUnit())==1211117639 or GetUnitTypeId(GetFilterUnit())==1211117638 or GetUnitTypeId(GetFilterUnit())==1160786000 or GetUnitTypeId(GetFilterUnit())==1311780930 or GetUnitTypeId(GetFilterUnit())==1430468144 or GetUnitTypeId(GetFilterUnit())==1162032951 or GetUnitTypeId(GetFilterUnit())==1429221456 or GetUnitTypeId(GetFilterUnit())==1160786510 or GetUnitTypeId(GetFilterUnit())==1160786511 or GetUnitTypeId(GetFilterUnit())==1328558390 or GetUnitTypeId(GetFilterUnit())==1328558391 or GetUnitTypeId(GetFilterUnit())==1160786502
+return GetUnitTypeId(GetFilterUnit())==1211117637 or GetUnitTypeId(GetFilterUnit())==1211117639 or GetUnitTypeId(GetFilterUnit())==1211117638 or GetUnitTypeId(GetFilterUnit())==1160786000 or GetUnitTypeId(GetFilterUnit())==1311780930 or GetUnitTypeId(GetFilterUnit())==1430468144 or GetUnitTypeId(GetFilterUnit())==1162032951 or GetUnitTypeId(GetFilterUnit())==1429221456 or GetUnitTypeId(GetFilterUnit())==1160786510 or GetUnitTypeId(GetFilterUnit())==1160786511 or GetUnitTypeId(GetFilterUnit())==1328558390 or GetUnitTypeId(GetFilterUnit())==1328558391 or GetUnitTypeId(GetFilterUnit())==1160786502 or GetUnitTypeId(GetFilterUnit())==1211122767
 endfunction
 function GenericCondition_EnemyTowers takes nothing returns boolean
 return IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(tt_unit1))==true and GetTowerLevel(GetFilterUnit())>0
 endfunction
 function Stun_GetLevel takes real Duration returns integer
 if Duration>=4.00 then
 return 19
 elseif Duration>=3.75 then
 return 18
 elseif Duration>=3.5 then
 return 17
 elseif Duration>=3.25 then
 return 16
 elseif Duration>=3 then
 return 15
@@ -8802,30 +9125,36 @@
 call RegisterNegativeBuff(1110456398)
 call RegisterNegativeBuff(1110454857)
 call RegisterNegativeBuff(1110456401)
 call RegisterNegativeBuff(1110459186)
 call RegisterNegativeBuff(1110455891)
 call RegisterNegativeBuff(1110454867)
 call RegisterNegativeBuff(1110454871)
 call RegisterNegativeBuff(1110455633)
 call RegisterNegativeBuff(1110454852)
 call RegisterNegativeBuff(1110458969)
 call RegisterNegativeBuff(1110454864)
 call RegisterNegativeBuff(1110455622)
 call RegisterNegativeBuff(1110459728)
 call RegisterNegativeBuff(1110459730)
 call RegisterNegativeBuff(1110459732)
+call RegisterNegativeBuff(1110459982)
+call RegisterNegativeBuff(1110459993)
+call RegisterNegativeBuff(1110459988)
+call RegisterNegativeBuff(1110459994)
+call RegisterNegativeBuff(1110460208)
+call RegisterNegativeBuff(1110459957)
 endfunction
 function IsPurge takes integer abilityid returns boolean
 return abilityid==purge_diffusal or abilityid==purge_medusa or abilityid==purge_neutral or abilityid==shock_purge or abilityid==1093750613 or abilityid==1095328633 or abilityid==1093751617
 endfunction
 function Purge_RemoveBuffs takes unit Target returns nothing
 call UnitRemoveAbility(Target,gust_icon)
 call UnitRemoveAbility(Target,gust_icon_buff)
 call UnitRemoveAbility(Target,gust_fx)
 call UnitRemoveAbility(Target,1097167980)
 call StickyNapalm_SetSlow(Target,0,0)
 endfunction
 function Purge_Main takes nothing returns boolean
 if IsPurge(GetSpellAbilityId())then
 call Purge_RemoveBuffs(GetSpellTargetUnit())
 endif
@@ -8893,31 +9222,31 @@
 endif
 set i=i+1
 endloop
 return-1
 endfunction
 function GetScepterIndexId takes unit whichUnit returns integer
 local integer unitId
 if whichUnit==null then
 return-2
 endif
 set unitId=GetUnitTypeId(whichUnit)
 if unitId==1211117620 then
 return indexid_aghanimsscepterlina
 elseif unitId==1430466872 then
 return indexid_aghanimsscepterlion
-elseif unitId==1432580716 then
+elseif unitId==1432580716 or unitId==1429221720 then
 return indexid_aghanimssceptertiny
 elseif unitId==1211117640 then
 return indexid_aghanimsscepterpugna
 elseif unitId==1430466609 then
 return indexid_aghanimsscepterqop
 elseif unitId==1332898670 then
 return indexid_aghanimsscepterrhasta
 elseif unitId==1215128178 then
 return indexid_aghanimsscepterzeus
 elseif unitId==1214931305 then
 return indexid_aghanimsscepterrylai
 elseif unitId==1433168227 then
 return indexid_aghanimsscepterlich
 elseif unitId==1164666213 then
 return indexid_aghanimsscepterleshrac
@@ -9877,31 +10210,31 @@
 function Buyback_StartCooldown takes player p returns nothing
 local integer id=GetPlayerId(p)
 local unit CircleOfPower=COP[id]
 local unit Hero=udg_Hero[id]
 local integer Level=GetHeroLevel(Hero)
 local integer i=0
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 call Buyback_VisionFollower(Hero)
 loop
 exitwhen i>59
 call RemoveUnitFromStock(CircleOfPower,buyback_unit[i])
 set i=i+1
 endloop
 call TriggerAddCondition(t,Condition(function Buyback_EndCooldown))
-call TriggerRegisterTimerEvent(t,240,false)
+call TriggerRegisterTimerEvent(t,300,false)
 call SaveInteger(hash_main,(Cache),(34),(id))
 set buyback_previousunit[id]=buyback_dummy_cooldown
 call UnitAddAbility(CircleOfPower,abilityid_dummybuyback)
 call IssueImmediateOrder(CircleOfPower,"fanofknives")
 set Hero=null
 set CircleOfPower=null
 set t=null
 endfunction
 function InitTrig_Buyback_System takes nothing returns nothing
 set t_buyback=CreateTrigger()
 call TriggerAddCondition(t_buyback,Condition(function Buyback_Update))
 set buyback_unit[0]=1747990855
 set buyback_cost[0]=50
 set buyback_unit[1]=1747990868
 set buyback_cost[1]=100
@@ -11774,84 +12107,81 @@
 set HeroTips_4[i]="Rigwarl needs a fair amount of mana early-game, Ring of Basilius, Magic Stick or Bottle can boost his early offensive power immensely."
 set HeroTips_5[i]="You can mitigate a lot of damage if you turn your hero at the right times thanks to your passive Bristleback. Play mind games on your opponent."
 set i=i+1
 set HeroID[53]=1160786520
 set DummyID[53]=1747993428
 set HeroName[53]=1848659019
 set HeroIcon[53]="ReplaceableTextures\\CommandButtons\\BTNMedivh.blp"
 call RegisterVictoryAnimation(HeroID[53],"stand 3")
 call RegisterHeroScale(HeroID[53],1.15,DummyID[53])
 set HeroTips_1[i]=""
 set HeroTips_2[i]=""
 set HeroTips_3[i]=""
 set HeroTips_4[i]=""
 set HeroTips_5[i]=""
 set i=i+1
-set SentMax=53
-set i=54
-set ScourgeMin=54
-set HeroID[54]=1162032439
-set DummyID[54]=1747989828
-set HeroName[54]=MSG_HERO_VENO
-set HeroIcon[54]="ReplaceableTextures\\CommandButtons\\BTNHydralisk.blp"
-call RegisterVictoryAnimation(HeroID[54],"attack")
-call RegisterHeroScale(HeroID[54],1.0,DummyID[54])
-call RegisterHeroColor(HeroID[54],150,200,255)
-set HeroTips_1[i]="Venomous Gale is a spell that hits multiple opponents and slows them, making it very useful for getting early kills."
-set HeroTips_2[i]="At least one level of Poison Sting is recommended early game for its slow effect."
-set HeroTips_3[i]="Bottle and Magic Stick will help deal with his low HP/mana, while Phase Boots are a cheap way to improve his chasing capabilities."
-set HeroTips_4[i]="Wards are very useful for pushing a lane and killing neutral and enemy creeps, but you can also use it to provide vision."
-set HeroTips_5[i]="Poison Nova deals a lot of damage but you have to combine it with other spells and attacks because it does not deal fatal damage (stops at 1 HP)."
+set HeroID[54]=1311788336
+set DummyID[54]=1747993671
+set HeroName[54]=1848659249
+set HeroIcon[54]="ReplaceableTextures\\CommandButtons\\BTNFireBrewmaster.blp"
+call RegisterVictoryAnimation(HeroID[54],"stand 3")
+call RegisterHeroScale(HeroID[54],1,DummyID[54])
+set HeroTips_1[i]=""
+set HeroTips_2[i]=""
+set HeroTips_3[i]=""
+set HeroTips_4[i]=""
+set HeroTips_5[i]=""
 set i=i+1
-set HeroID[55]=1430466865
-set DummyID[55]=1747989829
-set HeroName[55]=MSG_HERO_MAGNUS
-set HeroIcon[55]="ReplaceableTextures\\CommandButtons\\BTNBlueMagnataur.tga"
-call RegisterVictoryAnimation(HeroID[55],"stand channel")
-call RegisterHeroScale(HeroID[55],1,DummyID[55])
-call RegisterHeroColor(HeroID[55],150,150,100)
-set HeroTips_1[i]="Bottle and Perseverance help with early regeneration,. while purchasing Kelen's Dagger later will help you to land Reverse Polarity."
-set HeroTips_2[i]="A few Attribute Bonus points can help you cast more spells. Save Mighty Swing for later levels when you have more damage."
-set HeroTips_3[i]="By targeting the ground where you want to fire Shockwave, you can hit both creeps and opponents and make use of its long range."
-set HeroTips_4[i]="Magnus should cast Empower on himself and other allies with high damage before initiating team battles with his ultimate."
-set HeroTips_5[i]="The cleave of Battlefury stacks directly with Mighty Swing, making it a good damage item especially if you already have a Perseverance."
+set HeroID[55]=1160786507
+set DummyID[55]=1747993409
+set HeroName[55]=1848658762
+set HeroIcon[55]="ReplaceableTextures\\CommandButtons\\BTNGarithos.blp"
+call RegisterVictoryAnimation(HeroID[55],"stand 3")
+call RegisterHeroScale(HeroID[55],1.3,DummyID[55])
+set HeroTips_1[i]=""
+set HeroTips_2[i]=""
+set HeroTips_3[i]=""
+set HeroTips_4[i]=""
+set HeroTips_5[i]=""
 set i=i+1
-set HeroID[56]=1430468144
-set DummyID[56]=1747989830
-set HeroName[56]=MSG_HERO_VISAGE
-set HeroIcon[56]="ReplaceableTextures\\CommandButtons\\BTNSpiritWyvern.blp"
-call RegisterVictoryAnimation(HeroID[56],"stand victory")
-call RegisterHeroScale(HeroID[56],1,DummyID[56])
-call RegisterHeroColor(HeroID[56],150,150,150)
+set HeroID[56]=1211122767
+set DummyID[56]=1747993672
+set HeroName[56]=1848659254
+set HeroIcon[56]="ReplaceableTextures\\CommandButtons\\BTNDragonHawk.blp"
+call RegisterVictoryAnimation(HeroID[56],"stand 3")
+call RegisterHeroScale(HeroID[56],1.1,DummyID[56])
 set HeroTips_1[i]=""
 set HeroTips_2[i]=""
 set HeroTips_3[i]=""
 set HeroTips_4[i]=""
 set HeroTips_5[i]=""
 set i=i+1
-set HeroID[57]=1429221441
-set DummyID[57]=1747989831
-set HeroName[57]=MSG_HERO_CK
-set HeroIcon[57]="ReplaceableTextures\\CommandButtons\\BTNChaosWarlord.blp"
-call RegisterVictoryAnimation(HeroID[57],"stand victory")
-call RegisterHeroScale(HeroID[57],1.05,DummyID[57])
-set HeroTips_1[i]="Chaos Bolt and Blink Strike are active abilities that are more useful in the lane and for killing opponents than Critical Strike."
-set HeroTips_2[i]="Chaos Bolt is a disable that switches between average and extremely powerful, the sooner you have max out this spell, the better."
-set HeroTips_3[i]="His high natural movement speed (325 - the highest in the game) and Blink Strike make him very difficult for opponents to outrun or chase him."
-set HeroTips_4[i]="If you Blink Strike and then use Chaos Bolt, you can spend more time hitting opponents and less time waiting for his slow casting animation. "
-set HeroTips_5[i]="Make Nessaj and Phantasm stronger by buying Strength items like Armlet of Mordiggan (when activated) and Heart of Tarrasque."
+set HeroID[57]=1160786738
+set DummyID[57]=1747993922
+set HeroName[57]=1848659269
+set HeroIcon[57]="ReplaceableTextures\\CommandButtons\\BTNJunkGolem.blp"
+call RegisterVictoryAnimation(HeroID[57],"stand 3")
+call RegisterHeroScale(HeroID[57],1,DummyID[57])
+set HeroTips_1[i]=""
+set HeroTips_2[i]=""
+set HeroTips_3[i]=""
+set HeroTips_4[i]=""
+set HeroTips_5[i]=""
 set i=i+1
+set SentMax=57
+set i=58
+set ScourgeMin=58
 set HeroID[58]=1429221432
 set DummyID[58]=1747989832
 set HeroName[58]=MSG_HERO_LYCAN
 set HeroIcon[58]="ReplaceableTextures\\CommandButtons\\BTNKiljaedin.blp"
 call RegisterVictoryAnimation(HeroID[58],"spell")
 call RegisterHeroScale(HeroID[58],1.2,DummyID[58])
 call RegisterHeroScale(1160786229,1,DummyID[58])
 call RegisterHeroColor(HeroID[58],255,75,255)
 set HeroTips_1[i]="If you want to neutral creeps, start with Summon Wolves and a Ring of Basilius, which can be used to make Vladmir's Offering later."
 set HeroTips_2[i]="Spirit Wolves gain invisibility at level 4, making them difficult to kill and easy to harass heroes with in the lane."
 set HeroTips_3[i]="Feral Heart make you and your wolves stronger overall, while Howl is an offensive spell used before engaging the enemy."
 set HeroTips_4[i]="Shapeshift makes you incredibly powerful and gives you max movement speed. Avoid being blocked by your wolves when chasing."
 set HeroTips_5[i]="A Black King Bar will prevent enemies from disabling you, making you very fearsome and almost unstoppable when attacking heroes."
 set i=i+1
 set HeroID[59]=1429221430
@@ -12073,31 +12403,31 @@
 set HeroName[76]=MSG_HERO_NECRO
 set HeroIcon[76]="ReplaceableTextures\\CommandButtons\\BTNGhostOfKelThuzad.blp"
 call RegisterVictoryAnimation(HeroID[76],"stand victory")
 call RegisterHeroScale(HeroID[76],1.3,DummyID[76])
 set HeroTips_1[i]="Death Pulse lets you kill creeps and harass heroes simultaneously, great for pushing and healing allied units because of its low cooldown."
 set HeroTips_2[i]="Sadist will provide you with some early regeneration for killing creeps, while Heartstopper Aura becomes effective as the game goes on."
 set HeroTips_3[i]="Reaper's Scythe is known for its ability to kill heroes outright, allowing you to bring down even high-HP Strength heroes with ease."
 set HeroTips_4[i]="Your ultimate can also be used to stun opponents in certain situations, such as interrupting channeling spells and teleports."
 set HeroTips_5[i]="Items like Bloodstone or Heart of Tarrasque allow you to survive long enough in team battles to make your spells more effective."
 set i=i+1
 set HeroID[77]=1429221446
 set DummyID[77]=1747990064
 set HeroName[77]=MSG_HERO_PUDGE
 set HeroIcon[77]="ReplaceableTextures\\CommandButtons\\BTNAbomination.blp"
 call RegisterVictoryAnimation(HeroID[77],"stand 3")
-call RegisterHeroScale(HeroID[77],1.1,DummyID[77])
+call RegisterHeroScale(HeroID[77],1.0,DummyID[77])
 set HeroTips_1[i]="Pudge can known for his ability to isolate enemies with Meat Hook and using Rot and Dismember afterward, killing them outright. "
 set HeroTips_2[i]="Early regeneration and movement speed items such as Bottle and Phase Boots help provide Pudge with the means to cast spells and chase his opponents."
 set HeroTips_3[i]="Use Meat Hook from a location where you are not obstructed by any allied or enemy units other than your target to ensure a better chance of landing it."
 set HeroTips_4[i]="A Hood of Defiance will improve your magic resistance to reduce damage from using Rot and getting hit by spells; The massive regeneration is also good."
 set HeroTips_5[i]="Use your spells defensively: Rot can be used to commit suicide if necessary and Meat Hook can be used to rescue an ally from one or more enemies."
 set i=i+1
 set HeroID[78]=1328558154
 set DummyID[78]=1747990065
 set HeroName[78]=MSG_HERO_SB
 set HeroIcon[78]="ReplaceableTextures\\CommandButtons\\BTNSpiritWalker.blp"
 call RegisterVictoryAnimation(HeroID[78],"stand ready")
 call RegisterHeroScale(HeroID[78],1.2,DummyID[78])
 set HeroTips_1[i]="Empowering Haste is a smart skill to level first, it gives Barathrum movement speed and significant damage for killing creeps and heroes."
 set HeroTips_2[i]="A level of Greater Bash early game can be useful as an extra disable, since the 17% chance is the same for all levels.A level of Greater Bash early game can be useful as an extra disable, since the 17% chance is the same for all levels."
 set HeroTips_3[i]="Get Strength Power Treads because the attack and movement speed benefits your other skills and the boost in HP helps you survive."
@@ -12416,31 +12746,82 @@
 set HeroTips_5[i]="The effect of Exorcism stops if you die in combat: Invest in items that improve your survivability, such as a Bloodstone or a Heart of Tarrasque."
 set i=i+1
 set HeroID[104]=1430466872
 set DummyID[104]=1747989827
 set HeroName[104]=MSG_HERO_LION
 set HeroIcon[104]="ReplaceableTextures\\CommandButtons\\BTNLion.BLP"
 call RegisterVictoryAnimation(HeroID[104],"spell callstorm")
 call RegisterHeroScale(HeroID[104],1.3,DummyID[104])
 call RegisterHeroColor(HeroID[104],50,100,255)
 set HeroTips_1[i]="With plenty of damage and disables, Lion is quite a force to be reckoned with cheap utility items such as Bottle and Phase Boots."
 set HeroTips_2[i]="Impale gives Lion the ability to disable multiple targets and deals decent damage, so it is definitely the most versatile of his three skills for the early game."
 set HeroTips_3[i]="Mana Drain only works on units with mana: Using Mana Drain on enemy heroes will reduce their spell use while replenishing mana."
 set HeroTips_4[i]="Avoid wasting Finger of Death on low-health enemy heroes when a few extra attacks or using another spell like Impale will deal enough damage."
 set HeroTips_5[i]="Wait until the duration of your first disable wears off before using another one for maximum disable time when using Impale and Voodoo."
 set i=i+1
-set ScourgeMax=104
+set HeroID[105]=1162032439
+set DummyID[105]=1747989828
+set HeroName[105]=MSG_HERO_VENO
+set HeroIcon[105]="ReplaceableTextures\\CommandButtons\\BTNHydralisk.blp"
+call RegisterVictoryAnimation(HeroID[105],"attack")
+call RegisterHeroScale(HeroID[105],1.0,DummyID[105])
+call RegisterHeroColor(HeroID[105],150,200,255)
+set HeroTips_1[i]="Venomous Gale is a spell that hits multiple opponents and slows them, making it very useful for getting early kills."
+set HeroTips_2[i]="At least one level of Poison Sting is recommended early game for its slow effect."
+set HeroTips_3[i]="Bottle and Magic Stick will help deal with his low HP/mana, while Phase Boots are a cheap way to improve his chasing capabilities."
+set HeroTips_4[i]="Wards are very useful for pushing a lane and killing neutral and enemy creeps, but you can also use it to provide vision."
+set HeroTips_5[i]="Poison Nova deals a lot of damage but you have to combine it with other spells and attacks because it does not deal fatal damage (stops at 1 HP)."
+set i=i+1
+set HeroID[106]=1430466865
+set DummyID[106]=1747989829
+set HeroName[106]=MSG_HERO_MAGNUS
+set HeroIcon[106]="ReplaceableTextures\\CommandButtons\\BTNBlueMagnataur.tga"
+call RegisterVictoryAnimation(HeroID[106],"stand channel")
+call RegisterHeroScale(HeroID[106],1,DummyID[106])
+call RegisterHeroColor(HeroID[106],150,150,100)
+set HeroTips_1[i]="Bottle and Perseverance help with early regeneration,. while purchasing Kelen's Dagger later will help you to land Reverse Polarity."
+set HeroTips_2[i]="A few Attribute Bonus points can help you cast more spells. Save Mighty Swing for later levels when you have more damage."
+set HeroTips_3[i]="By targeting the ground where you want to fire Shockwave, you can hit both creeps and opponents and make use of its long range."
+set HeroTips_4[i]="Magnus should cast Empower on himself and other allies with high damage before initiating team battles with his ultimate."
+set HeroTips_5[i]="The cleave of Battlefury stacks directly with Mighty Swing, making it a good damage item especially if you already have a Perseverance."
+set i=i+1
+set HeroID[107]=1430468144
+set DummyID[107]=1747989830
+set HeroName[107]=MSG_HERO_VISAGE
+set HeroIcon[107]="ReplaceableTextures\\CommandButtons\\BTNSpiritWyvern.blp"
+call RegisterVictoryAnimation(HeroID[107],"stand victory")
+call RegisterHeroScale(HeroID[107],1,DummyID[107])
+call RegisterHeroColor(HeroID[107],150,150,150)
+set HeroTips_1[i]=""
+set HeroTips_2[i]=""
+set HeroTips_3[i]=""
+set HeroTips_4[i]=""
+set HeroTips_5[i]=""
+set i=i+1
+set HeroID[108]=1429221441
+set DummyID[108]=1747989831
+set HeroName[108]=MSG_HERO_CK
+set HeroIcon[108]="ReplaceableTextures\\CommandButtons\\BTNChaosWarlord.blp"
+call RegisterVictoryAnimation(HeroID[108],"stand victory")
+call RegisterHeroScale(HeroID[108],1.05,DummyID[108])
+set HeroTips_1[i]="Chaos Bolt and Blink Strike are active abilities that are more useful in the lane and for killing opponents than Critical Strike."
+set HeroTips_2[i]="Chaos Bolt is a disable that switches between average and extremely powerful, the sooner you have max out this spell, the better."
+set HeroTips_3[i]="His high natural movement speed (325 - the highest in the game) and Blink Strike make him very difficult for opponents to outrun or chase him."
+set HeroTips_4[i]="If you Blink Strike and then use Chaos Bolt, you can spend more time hitting opponents and less time waiting for his slow casting animation. "
+set HeroTips_5[i]="Make Nessaj and Phantasm stronger by buying Strength items like Armlet of Mordiggan (when activated) and Heart of Tarrasque."
+set i=i+1
+set ScourgeMax=108
 set AgilityHero[1]=1315074670
 set AgilityHero[2]=1164207469
 set AgilityHero[3]=1311781174
 set AgilityHero[4]=1315070563
 set AgilityHero[5]=1315007329
 set AgilityHero[6]=1328558160
 set AgilityHero[7]=1433631084
 set AgilityHero[8]=1160785973
 set AgilityHero[9]=1311781199
 set AgilityHero[10]=1212365106
 set AgilityHero[11]=1215723364
 set AgilityHero[12]=1212363833
 set AgilityHero[13]=1215657064
 set AgilityHero[14]=1332179560
 set AgilityHero[15]=1429221430
@@ -12450,31 +12831,32 @@
 set AgilityHero[19]=1160785972
 set AgilityHero[20]=1162032951
 set AgilityHero[21]=1215722344
 set AgilityHero[22]=1315334514
 set AgilityHero[23]=1160785970
 set AgilityHero[24]=1162032181
 set AgilityHero[25]=1165451634
 set AgilityHero[26]=1429221424
 set AgilityHero[27]=1211117654
 set AgilityHero[28]=1160786242
 set AgilityHero[29]=1311781206
 set AgilityHero[30]=1211117641
 set AgilityHero[31]=1160786265
 set AgilityHero[32]=1211119409
 set AgilityHero[33]=1160786510
-set AgilityHeroCount=33
+set AgilityHero[34]=1311788336
+set AgilityHeroCount=34
 set StrengthHero[1]=1315988077
 set StrengthHero[2]=1215063922
 set StrengthHero[3]=1214345830
 set StrengthHero[4]=1211117616
 set StrengthHero[5]=1211117617
 set StrengthHero[6]=1214344551
 set StrengthHero[7]=1211117624
 set StrengthHero[8]=1432580716
 set StrengthHero[9]=1333027688
 set StrengthHero[10]=1313026096
 set StrengthHero[11]=1432646245
 set StrengthHero[12]=1430466865
 set StrengthHero[13]=1332109682
 set StrengthHero[14]=1429221446
 set StrengthHero[15]=1429221451
@@ -12485,31 +12867,33 @@
 set StrengthHero[20]=1429221443
 set StrengthHero[21]=1430468913
 set StrengthHero[22]=1430467634
 set StrengthHero[23]=1429221432
 set StrengthHero[24]=1211117636
 set StrengthHero[25]=1311781193
 set StrengthHero[26]=1211117649
 set StrengthHero[27]=1311780946
 set StrengthHero[28]=1211117652
 set StrengthHero[29]=1211119187
 set StrengthHero[30]=1211117650
 set StrengthHero[31]=1328558389
 set StrengthHero[32]=1160786505
 set StrengthHero[33]=1160786502
 set StrengthHero[34]=1328558406
-set StrengthHeroCount=34
+set StrengthHero[35]=1160786738
+set StrengthHero[36]=1160786507
+set StrengthHeroCount=36
 set IntelligenceHero[1]=1332898670
 set IntelligenceHero[2]=1164799855
 set IntelligenceHero[3]=1164799603
 set IntelligenceHero[4]=1211117620
 set IntelligenceHero[5]=1214931305
 set IntelligenceHero[6]=1433105516
 set IntelligenceHero[7]=1215128178
 set IntelligenceHero[8]=1211117643
 set IntelligenceHero[9]=1316252014
 set IntelligenceHero[10]=1215130471
 set IntelligenceHero[11]=1214409837
 set IntelligenceHero[12]=1311781185
 set IntelligenceHero[13]=1211117633
 set IntelligenceHero[14]=1433168227
 set IntelligenceHero[15]=1164666213
@@ -12523,31 +12907,32 @@
 set IntelligenceHero[23]=1160786241
 set IntelligenceHero[24]=1429221456
 set IntelligenceHero[25]=1160786000
 set IntelligenceHero[26]=1160786243
 set IntelligenceHero[27]=1311781207
 set IntelligenceHero[28]=1211117646
 set IntelligenceHero[29]=1311786311
 set IntelligenceHero[30]=1211117651
 set IntelligenceHero[31]=1311780930
 set IntelligenceHero[32]=1211117653
 set IntelligenceHero[33]=1328558390
 set IntelligenceHero[34]=HeroID[97]
 set IntelligenceHero[35]=1160786504
 set IntelligenceHero[36]=1160786506
 set IntelligenceHero[37]=1160786520
-set IntelligenceHeroCount=37
+set IntelligenceHero[38]=1211122767
+set IntelligenceHeroCount=38
 set RangeHero[1]=1332898670
 set RangeHero[2]=1164799855
 set RangeHero[3]=1164799603
 set RangeHero[4]=1211117620
 set RangeHero[5]=1214931305
 set RangeHero[6]=1433105516
 set RangeHero[7]=1215128178
 set RangeHero[8]=1211117643
 set RangeHero[9]=1316252014
 set RangeHero[10]=1315074670
 set RangeHero[11]=1214409837
 set RangeHero[12]=1311781185
 set RangeHero[13]=1211117633
 set RangeHero[14]=1433168227
 set RangeHero[15]=1164666213
@@ -12579,31 +12964,32 @@
 set RangeHero[41]=1160785972
 set RangeHero[42]=1162032951
 set RangeHero[43]=1315334514
 set RangeHero[44]=1160785970
 set RangeHero[45]=1211117654
 set RangeHero[46]=1311781206
 set RangeHero[47]=1211117649
 set RangeHero[48]=1328558390
 set RangeHero[49]=HeroID[97]
 set RangeHero[50]=1328558406
 set RangeHero[51]=1160786504
 set RangeHero[52]=1160786510
 set RangeHero[53]=1160786506
 set RangeHero[54]=1160786502
 set RangeHero[55]=1160786520
-set RangeHeroCount=55
+set RangeHero[56]=1211122767
+set RangeHeroCount=56
 set MeleeHero[1]=1215130471
 set MeleeHero[2]=1211117646
 set MeleeHero[3]=1164207469
 set MeleeHero[4]=1315070563
 set MeleeHero[5]=1315007329
 set MeleeHero[6]=1212363833
 set MeleeHero[7]=1215657064
 set MeleeHero[8]=1332179560
 set MeleeHero[9]=1429221430
 set MeleeHero[10]=1164277353
 set MeleeHero[11]=1215722344
 set MeleeHero[12]=1162032181
 set MeleeHero[13]=1165451634
 set MeleeHero[14]=1429221424
 set MeleeHero[15]=1160786242
@@ -12629,31 +13015,34 @@
 set MeleeHero[35]=1332766568
 set MeleeHero[36]=1429221441
 set MeleeHero[37]=1429221443
 set MeleeHero[38]=1430468913
 set MeleeHero[39]=1430467634
 set MeleeHero[40]=1429221432
 set MeleeHero[41]=1211117636
 set MeleeHero[42]=1311781193
 set MeleeHero[43]=1311780946
 set MeleeHero[44]=1211117652
 set MeleeHero[45]=1211119187
 set MeleeHero[46]=1211117650
 set MeleeHero[47]=1328558389
 set MeleeHero[48]=1211119409
 set MeleeHero[49]=1160786505
-set MeleeHeroCount=49
+set MeleeHero[50]=1311788336
+set MeleeHero[51]=1160786738
+set MeleeHero[52]=1160786507
+set MeleeHeroCount=52
 call InitSet()
 endfunction
 function InitTrig_Hero takes nothing returns nothing
 call HeroInit()
 endfunction
 function UnitInit takes nothing returns nothing
 call RegisterVictoryAnimation(1702061422,"stand 4")
 call RegisterVictoryAnimation(1697656918,"stand 4")
 call RegisterVictoryAnimation(1701081721,"spell")
 call RegisterVictoryAnimation(1697656919,"spell")
 call RegisterVictoryAnimation(1969711215,"stand victory")
 call RegisterVictoryAnimation(1966092337,"stand victory")
 call RegisterVictoryAnimation(1970169187,"stand channel")
 call RegisterVictoryAnimation(1966092338,"stand channel")
 call RegisterHeroScale(unitid_jokecourier1,0.4,unitid_jokecourier1)
@@ -12722,32 +13111,191 @@
 call SetUnitColor(IntTavern3,ConvertPlayerColor(9))
 call SetUnitColor(IntTavern4,ConvertPlayerColor(9))
 call SetUnitColor(AgiTavern1,ConvertPlayerColor(6))
 call SetUnitColor(AgiTavern2,ConvertPlayerColor(6))
 call SetUnitColor(AgiTavern3,ConvertPlayerColor(10))
 call SetUnitColor(AgiTavern4,ConvertPlayerColor(10))
 call SetUnitColor(StrTavern1,ConvertPlayerColor(0))
 call SetUnitColor(StrTavern2,ConvertPlayerColor(0))
 call SetUnitColor(StrTavern3,ConvertPlayerColor(11))
 call SetUnitColor(StrTavern4,ConvertPlayerColor(11))
 set t=null
 endfunction
 function InitTrig_Tavern takes nothing returns nothing
 call Tavern_Initialize()
 endfunction
+function IsItemAbility takes integer id returns boolean
+local integer i=0
+loop
+exitwhen i>ItemAbilities_Max
+if ItemAbilities[i]==id then
+return true
+endif
+set i=i+1
+endloop
+return false
+endfunction
+function ItemAbilities_Init takes nothing returns nothing
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093753431
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093681718
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093684023
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093686327
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093686328
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093742918
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093742920
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093742919
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093742916
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093686067
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093742917
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093743959
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093814353
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093808945
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093814351
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093677647
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093679193
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093679194
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093679408
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093679410
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095331943
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095332962
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093683254
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093751108
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093751863
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093744973
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093747011
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1094936696
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093810265
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095328363
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093748055
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093677367
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093683801
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093682767
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093683255
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093681720
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093752645
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095333995
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093753417
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093681995
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093683788
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093748303
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095328865
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093683266
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093682227
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093682246
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093682756
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093743191
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093743681
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093748292
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093749071
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093677655
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093809721
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093815111
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093748304
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093686329
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093751096
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093750095
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093810244
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1097163124
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093684016
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095331948
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093683796
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095331954
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093677656
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093751349
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1095332727
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093808182
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093753416
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093813569
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093815092
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093815095
+set ItemAbilities_Max=ItemAbilities_Max+1
+set ItemAbilities[ItemAbilities_Max]=1093815089
+endfunction
 function IsGlobalSpellIgnore takes integer id returns boolean
-return id==abilityid_pulsenova or id==abilityid_pulsenovaupgraded or id==abilityid_pulsenova_disabled or id==abilityid_shadowpoison_explode or id==abilityid_oscillation_in or id==abilityid_oscillation_out or id==abilityid_shadowpoison_explode or id==1093678667 or id==1093752391 or id==abilityid_overcharge or id==1093752646 or id==1093686328 or id==1093686327 or id==abilityid_dash_helper or id==abilityid_firespirits_helper or id==abilityid_sunray_off or id==abilityid_sunray_movement or id==1093743681 or id==1093809721 or id==1093808458 or id==1093810008 or id==1093810265 or id==1093809221 or id==1093753416 or id==1093752655 or id==1093748305 or id==1093686341
+return id==abilityid_pulsenova or id==abilityid_pulsenovaupgraded or id==abilityid_pulsenova_disabled or id==abilityid_shadowpoison_explode or id==abilityid_oscillation_in or id==abilityid_oscillation_out or id==abilityid_shadowpoison_explode or id==1093678667 or id==1093752391 or id==abilityid_overcharge or id==1093752646 or id==1093686328 or id==1093686327 or id==abilityid_dash_helper or id==abilityid_firespirits_helper or id==abilityid_sunray_off or id==abilityid_sunray_movement or id==1093743681 or id==1093809721 or id==1093815111 or id==1093808458 or id==1093810008 or id==1093810265 or id==1093809221 or id==1093753416 or id==1093752655 or id==1093748305 or id==1093686341 or id==1093814863 or id==1093813848 or id==1093684560 or id==1093815109 or id==1093815112 or id==1093815097
 endfunction
 function MiscInit2 takes nothing returns nothing
 set AbusableSpells_Max=AbusableSpells_Max+1
 set AbusableSpells[AbusableSpells_Max]=1093683254
 set AbusableSpells_Max=AbusableSpells_Max+1
 set AbusableSpells[AbusableSpells_Max]=1093677362
 set AbusableSpells_Max=AbusableSpells_Max+1
 set AbusableSpells[AbusableSpells_Max]=1093678667
 set AbusableSpells_Max=AbusableSpells_Max+1
 set AbusableSpells[AbusableSpells_Max]=1093683513
 set AbusableSpells_Max=AbusableSpells_Max+1
 set AbusableSpells[AbusableSpells_Max]=1093683265
 set AbusableSpells_Max=AbusableSpells_Max+1
 set AbusableSpells[AbusableSpells_Max]=1093684021
 set AbusableSpells_Max=AbusableSpells_Max+1
@@ -12841,35 +13389,37 @@
 set udg_NotSpells[54]=abilityid_exort
 set udg_NotSpells[55]=1093684560
 set udg_NotSpells[56]=abilityid_xmarksthespot_helper
 set udg_NotSpells[57]=abilityid_magicstick
 set udg_NotSpells[58]=abilityid_blademail
 set udg_NotSpells[59]=1093748303
 set udg_NotSpells[60]=1093748292
 set udg_NotSpells[61]=1093750618
 set udg_NotSpells[62]=1093750095
 set udg_NotSpells[63]=1093749071
 set udg_NotSpells[64]=1093751096
 set udg_NotSpells[65]=1093751361
 set udg_NotSpells[66]=1093751126
 set udg_NotSpells[67]=1093752645
 set udg_NotSpells[68]=1093752642
+set udg_NotSpells[69]=1093815111
 set udg_NotSpellsMax=68
 endfunction
 function InitTrig_Misc takes nothing returns nothing
 call MiscInit()
 call MiscInit2()
+call ItemAbilities_Init()
 endfunction
 function Trig_Map_Info_Actions takes nothing returns nothing
 call CreateQuestBJ(bj_QUESTTYPE_REQ_DISCOVERED,"TRIGSTR_50004","TRIGSTR_50005","ReplaceableTextures\\CommandButtons\\BTNSpy.blp")
 call CreateQuestBJ(bj_QUESTTYPE_REQ_DISCOVERED,"TRIGSTR_50006","TRIGSTR_50007","ReplaceableTextures\\CommandButtons\\BTNTome.blp")
 call CreateQuestBJ(bj_QUESTTYPE_REQ_DISCOVERED,"TRIGSTR_50008","TRIGSTR_50009","ReplaceableTextures\\CommandButtons\\BTNAmbush.blp")
 call CreateQuestBJ(bj_QUESTTYPE_OPT_DISCOVERED,"TRIGSTR_50010","TRIGSTR_50011","ReplaceableTextures\\CommandButtons\\BTNScrollOfHaste.blp")
 call CreateQuestBJ(bj_QUESTTYPE_OPT_DISCOVERED,"TRIGSTR_50012","TRIGSTR_50013","ReplaceableTextures\\CommandButtons\\BTNBansheeMaster.blp")
 call CreateQuestBJ(bj_QUESTTYPE_OPT_DISCOVERED,"TRIGSTR_50014","TRIGSTR_50015","ReplaceableTextures\\CommandButtons\\BTNCarrionScarabs.blp")
 endfunction
 function InitTrig_Map_Info takes nothing returns nothing
 set gg_trg_Map_Info=CreateTrigger()
 call TriggerRegisterTimerEventSingle(gg_trg_Map_Info,0.01)
 call TriggerAddAction(gg_trg_Map_Info,function Trig_Map_Info_Actions)
 endfunction
 function ObserverMode_Learned takes nothing returns boolean
@@ -13150,30 +13700,32 @@
 call UnitRemoveAbility(Hero,sangeandyasha_slow)
 call UnitRemoveAbility(Hero,chargeofdarkness_icon)
 call UnitRemoveAbility(Hero,chargeofdarkness_icon_buffid)
 call UnitRemoveAbility(Hero,naturesguise_ms)
 call UnitRemoveAbility(Hero,naturesguise_ms_buffid)
 call AddNegativeArmorBonus(Hero,0)
 if GetUnitTypeId(Hero)==1160786510 or GetUnitTypeId(Hero)==1160786511 then
 call UnitRemoveAbility(Hero,abilityid_aghanimsscepter_gyrocopter)
 call UnitAddAbility(Hero,flakcannon_transform_out)
 call UnitRemoveAbility(Hero,flakcannon_transform_out)
 if FindItemOfType(Hero,Item_Real[indexid_aghanimssceptergyrocopter])!=null then
 call UnitAddAbility(Hero,abilityid_aghanimsscepter_gyrocopter)
 endif
 endif
 call UnitRemoveAbility(Hero,splitshot_spellbook)
+set tt_unit1=Hero
+call ExecuteFunc("DragonForm_FixOnRespawn")
 endfunction
 function InitTrig_Remove_On_Respawn takes nothing returns nothing
 endfunction
 function ReviveCamera_Check takes nothing returns boolean
 if GetPlayerAlliance(GetOwningPlayer(GetFilterUnit()),revivecamera_player,ALLIANCE_SHARED_CONTROL)==true and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false then
 set revivecamera_count=revivecamera_count+1
 endif
 return false
 endfunction
 function ReviveCamera takes unit u,player p,real x,real y,boolean cameraonly returns nothing
 local group g=GetAvailableGroup()
 set revivecamera_count=0
 set revivecamera_player=p
 call GroupEnumUnitsSelected(g,p,Condition(function ReviveCamera_Check))
 if revivecamera_count==0 and GetLocalPlayer()==p then
@@ -13255,78 +13807,68 @@
 set x=GetRectCenterX(gg_rct_Hero_Creation_UD)
 set y=GetRectCenterY(gg_rct_Hero_Creation_UD)
 endif
 else
 set t=CreateTrigger()
 call TriggerRegisterTimerEvent(t,2,false)
 call TriggerAddCondition(t,Condition(function FixAegisMeepoVar))
 endif
 set Kobold=Kobold0
 if Kobold!=null and RevivedHero!=Kobold then
 call ReviveHero(Kobold,x,y,false)
 call SetUnitX(Kobold,x)
 call SetUnitY(Kobold,y)
 call RemoveOnRespawn(Kobold)
 call SetUnitPathing(Kobold,true)
-if buyback_revivingstate then
 call SetUnitState(Kobold,UNIT_STATE_MANA,10000)
 endif
-endif
 set Kobold=Kobold1
 if Kobold!=null and RevivedHero!=Kobold then
 call ReviveHero(Kobold,x,y,false)
 call SetUnitX(Kobold,x)
 call SetUnitY(Kobold,y)
 call RemoveOnRespawn(Kobold)
 call SetUnitPathing(Kobold,true)
-if buyback_revivingstate then
 call SetUnitState(Kobold,UNIT_STATE_MANA,10000)
 endif
-endif
 set Kobold=Kobold2
 if Kobold!=null and RevivedHero!=Kobold then
 call ReviveHero(Kobold,x,y,false)
 call SetUnitX(Kobold,x)
 call SetUnitY(Kobold,y)
 call RemoveOnRespawn(Kobold)
 call SetUnitPathing(Kobold,true)
-if buyback_revivingstate then
 call SetUnitState(Kobold,UNIT_STATE_MANA,10000)
 endif
-endif
 set Kobold=Kobold3
 if Kobold!=null and RevivedHero!=Kobold then
 call ReviveHero(Kobold,x,y,false)
 call SetUnitX(Kobold,x)
 call SetUnitY(Kobold,y)
 call RemoveOnRespawn(Kobold)
 call SetUnitPathing(Kobold,true)
-if buyback_revivingstate then
 call SetUnitState(Kobold,UNIT_STATE_MANA,10000)
 endif
-endif
 set Kobold=Kobold4
 if Kobold!=null and RevivedHero!=Kobold then
 call ReviveHero(Kobold,x,y,false)
 call SetUnitX(Kobold,x)
 call SetUnitY(Kobold,y)
 call RemoveOnRespawn(Kobold)
 call SetUnitPathing(Kobold,true)
-if buyback_revivingstate then
 call SetUnitState(Kobold,UNIT_STATE_MANA,10000)
 endif
-endif
 endfunction
 function HeroRevive_Actions takes nothing returns nothing
 local unit UnitVar=GetTriggerUnit()
 local player PlayerVar=GetOwningPlayer(UnitVar)
 local real x
 local real y
 local integer NewCharges
 set HeroDead[GetPlayerId(GetOwningPlayer((UnitVar)))]=false
 if IsSent(GetOwningPlayer(UnitVar))then
 set x=GetRectCenterX(gg_rct_Hero_Creation_NE)
 set y=GetRectCenterY(gg_rct_Hero_Creation_NE)
 else
 set x=GetRectCenterX(gg_rct_Hero_Creation_UD)
 set y=GetRectCenterY(gg_rct_Hero_Creation_UD)
 endif
@@ -14110,31 +14676,31 @@
 endif
 call SetPlayerState(udg_SentPlayers[1],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_SentPlayers[1],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_SentPlayers[2],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_SentPlayers[2],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_SentPlayers[3],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_SentPlayers[3],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_SentPlayers[4],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_SentPlayers[4],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_SentPlayers[5],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_SentPlayers[5],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_ScourgePlayers[1],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_ScourgePlayers[1],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_ScourgePlayers[2],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_ScourgePlayers[2],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_ScourgePlayers[3],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_ScourgePlayers[3],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_ScourgePlayers[4],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_ScourgePlayers[4],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetPlayerState(udg_ScourgePlayers[5],PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(udg_ScourgePlayers[5],PLAYER_STATE_RESOURCE_GOLD)+Gold)
 return false
 endfunction
 function InitTrig_Money takes nothing returns nothing
 set MoneyTrigger=CreateTrigger()
-call TriggerRegisterTimerEvent(MoneyTrigger,0.875,true)
+call TriggerRegisterTimerEvent(MoneyTrigger,0.8,true)
 call TriggerAddCondition(MoneyTrigger,Condition(function Money_Main))
 call DisableTrigger(MoneyTrigger)
 endfunction
 function Time_Action takes nothing returns nothing
 local integer Total=R2I(TimerGetElapsed(udg_GameTimer)-TimeOffset)
 local integer Minutes=Total/60-1/2
 local integer Seconds=ModuloInteger(Total,60)
 if ShowGameTime then
 call SetTime(Minutes,Seconds,false)
 elseif ModeCreated==false then
 set Total=R2I(16-TimerGetElapsed(udg_GameTimer))
 set Minutes=Total/60-1/2
 set Seconds=ModuloInteger(Total,60)
 call SetTime(Minutes,Seconds,true)
 endif
@@ -14227,33 +14793,33 @@
 call SaveInteger(hash_abilities,(abilityid_epicenterupgrade),(1),(120))
 call SaveInteger(hash_abilities,(abilityid_epicenterupgrade),(2),(100))
 call SaveInteger(hash_abilities,(abilityid_epicenterupgrade),(3),(80))
 call SaveInteger(hash_abilities,(abilityid_netherstrike),(1),(75))
 call SaveInteger(hash_abilities,(abilityid_netherstrike),(2),(75))
 call SaveInteger(hash_abilities,(abilityid_netherstrike),(3),(75))
 call SaveInteger(hash_abilities,(abilityid_netherstrikeupgrade),(1),(20))
 call SaveInteger(hash_abilities,(abilityid_netherstrikeupgrade),(2),(20))
 call SaveInteger(hash_abilities,(abilityid_netherstrikeupgrade),(3),(20))
 call SaveInteger(hash_abilities,(abilityid_ravage),(1),(150))
 call SaveInteger(hash_abilities,(abilityid_ravage),(2),(150))
 call SaveInteger(hash_abilities,(abilityid_ravage),(3),(150))
 call SaveInteger(hash_abilities,(abilityid_cullingblade),(1),(75))
 call SaveInteger(hash_abilities,(abilityid_cullingblade),(2),(65))
 call SaveInteger(hash_abilities,(abilityid_cullingblade),(3),(55))
-call SaveInteger(hash_abilities,(1093750098),(1),(10))
-call SaveInteger(hash_abilities,(1093750098),(2),(10))
-call SaveInteger(hash_abilities,(1093750098),(3),(10))
+call SaveInteger(hash_abilities,(1093750098),(1),(6))
+call SaveInteger(hash_abilities,(1093750098),(2),(6))
+call SaveInteger(hash_abilities,(1093750098),(3),(6))
 call SaveInteger(hash_abilities,(1093677903),(1),(140))
 call SaveInteger(hash_abilities,(1093677903),(2),(140))
 call SaveInteger(hash_abilities,(1093677903),(3),(140))
 call SaveInteger(hash_abilities,(1093685847),(1),(20))
 call SaveInteger(hash_abilities,(1093685847),(2),(20))
 call SaveInteger(hash_abilities,(1093685847),(3),(20))
 call SaveInteger(hash_abilities,(1093684565),(1),(110))
 call SaveInteger(hash_abilities,(1093684565),(2),(110))
 call SaveInteger(hash_abilities,(1093684565),(3),(110))
 call SaveInteger(hash_abilities,(1093681458),(1),(110))
 call SaveInteger(hash_abilities,(1093681458),(2),(110))
 call SaveInteger(hash_abilities,(1093681458),(3),(110))
 call SaveInteger(hash_abilities,(abilityid_snatch),(1),(100))
 call SaveInteger(hash_abilities,(abilityid_snatch),(2),(100))
 call SaveInteger(hash_abilities,(abilityid_snatch),(3),(100))
@@ -14266,33 +14832,33 @@
 call SaveInteger(hash_abilities,(1093747248),(1),(180))
 call SaveInteger(hash_abilities,(1093747248),(2),(150))
 call SaveInteger(hash_abilities,(1093747248),(3),(120))
 call SaveInteger(hash_abilities,(1093685808),(1),(130))
 call SaveInteger(hash_abilities,(1093685808),(2),(130))
 call SaveInteger(hash_abilities,(1093685808),(3),(130))
 call SaveInteger(hash_abilities,(1093682764),(1),(30))
 call SaveInteger(hash_abilities,(1093682764),(2),(30))
 call SaveInteger(hash_abilities,(1093682764),(3),(30))
 call SaveInteger(hash_abilities,(1093747544),(1),(30))
 call SaveInteger(hash_abilities,(1093747544),(2),(30))
 call SaveInteger(hash_abilities,(1093747544),(3),(30))
 call SaveInteger(hash_abilities,(1093677876),(1),(10))
 call SaveInteger(hash_abilities,(1093677876),(2),(10))
 call SaveInteger(hash_abilities,(1093677876),(3),(10))
-call SaveInteger(hash_abilities,(1093743946),(1),(90))
-call SaveInteger(hash_abilities,(1093743946),(2),(90))
-call SaveInteger(hash_abilities,(1093743946),(3),(90))
+call SaveInteger(hash_abilities,(1093743946),(1),(75))
+call SaveInteger(hash_abilities,(1093743946),(2),(75))
+call SaveInteger(hash_abilities,(1093743946),(3),(75))
 call SaveInteger(hash_abilities,(1093682483),(1),(70))
 call SaveInteger(hash_abilities,(1093682483),(2),(70))
 call SaveInteger(hash_abilities,(1093682483),(3),(70))
 call SaveInteger(hash_abilities,(1093678160),(1),(20))
 call SaveInteger(hash_abilities,(1093678160),(2),(15))
 call SaveInteger(hash_abilities,(1093678160),(3),(10))
 call SaveInteger(hash_abilities,(1093684529),(1),(130))
 call SaveInteger(hash_abilities,(1093684529),(2),(120))
 call SaveInteger(hash_abilities,(1093684529),(3),(110))
 call SaveInteger(hash_abilities,(1093747032),(1),(110))
 call SaveInteger(hash_abilities,(1093747032),(2),(100))
 call SaveInteger(hash_abilities,(1093747032),(3),(90))
 call SaveInteger(hash_abilities,(1093678388),(1),(160))
 call SaveInteger(hash_abilities,(1093678388),(2),(150))
 call SaveInteger(hash_abilities,(1093678388),(3),(140))
@@ -14323,57 +14889,60 @@
 call SaveInteger(hash_abilities,(1093747767),(1),(60))
 call SaveInteger(hash_abilities,(1093747767),(2),(60))
 call SaveInteger(hash_abilities,(1093747767),(3),(60))
 call SaveInteger(hash_abilities,(1093750089),(1),(45))
 call SaveInteger(hash_abilities,(1093750089),(2),(45))
 call SaveInteger(hash_abilities,(1093750089),(3),(45))
 call SaveInteger(hash_abilities,(1093747023),(1),(80))
 call SaveInteger(hash_abilities,(1093747023),(2),(70))
 call SaveInteger(hash_abilities,(1093747023),(3),(60))
 call SaveInteger(hash_abilities,(1093752150),(1),(80))
 call SaveInteger(hash_abilities,(1093752150),(2),(70))
 call SaveInteger(hash_abilities,(1093752150),(3),(60))
 call SaveInteger(hash_abilities,(1093750341),(1),(180))
 call SaveInteger(hash_abilities,(1093750341),(2),(160))
 call SaveInteger(hash_abilities,(1093750341),(3),(140))
-call SaveInteger(hash_abilities,(1093747028),(1),(100))
-call SaveInteger(hash_abilities,(1093747028),(2),(100))
-call SaveInteger(hash_abilities,(1093747028),(3),(100))
+call SaveInteger(hash_abilities,(1093814599),(1),(180))
+call SaveInteger(hash_abilities,(1093814599),(2),(160))
+call SaveInteger(hash_abilities,(1093814599),(3),(140))
+call SaveInteger(hash_abilities,(1093747028),(1),(140))
+call SaveInteger(hash_abilities,(1093747028),(2),(110))
+call SaveInteger(hash_abilities,(1093747028),(3),(80))
 call SaveInteger(hash_abilities,(1093685840),(1),(11))
 call SaveInteger(hash_abilities,(1093685840),(2),(9))
 call SaveInteger(hash_abilities,(1093685840),(3),(7))
 call SaveInteger(hash_abilities,(1093684291),(1),(25))
 call SaveInteger(hash_abilities,(1093684291),(2),(25))
 call SaveInteger(hash_abilities,(1093684291),(3),(25))
 call SaveInteger(hash_abilities,(1093683534),(1),(45))
 call SaveInteger(hash_abilities,(1093683534),(2),(45))
 call SaveInteger(hash_abilities,(1093683534),(3),(45))
 call SaveInteger(hash_abilities,(1093747031),(1),(10))
 call SaveInteger(hash_abilities,(1093747031),(2),(10))
 call SaveInteger(hash_abilities,(1093747031),(3),(10))
 call SaveInteger(hash_abilities,(1093684296),(1),(70))
-call SaveInteger(hash_abilities,(1093684296),(2),(70))
-call SaveInteger(hash_abilities,(1093684296),(3),(70))
+call SaveInteger(hash_abilities,(1093684296),(2),(60))
+call SaveInteger(hash_abilities,(1093684296),(3),(50))
 call SaveInteger(hash_abilities,(1093678161),(1),(45))
 call SaveInteger(hash_abilities,(1093678161),(2),(45))
 call SaveInteger(hash_abilities,(1093678161),(3),(45))
 call SaveInteger(hash_abilities,(1093687121),(1),(45))
 call SaveInteger(hash_abilities,(1093687121),(2),(45))
 call SaveInteger(hash_abilities,(1093687121),(3),(45))
-call SaveInteger(hash_abilities,(1093679445),(1),(90))
-call SaveInteger(hash_abilities,(1093679445),(2),(75))
-call SaveInteger(hash_abilities,(1093679445),(3),(60))
+call SaveInteger(hash_abilities,(1093679445),(1),(70))
+call SaveInteger(hash_abilities,(1093679445),(2),(60))
+call SaveInteger(hash_abilities,(1093679445),(3),(50))
 call SaveInteger(hash_abilities,(1093682004),(1),(60))
 call SaveInteger(hash_abilities,(1093682004),(2),(50))
 call SaveInteger(hash_abilities,(1093682004),(3),(40))
 call SaveInteger(hash_abilities,(1093810506),(1),(120))
 call SaveInteger(hash_abilities,(1093810506),(2),(110))
 call SaveInteger(hash_abilities,(1093810506),(3),(100))
 call SaveInteger(hash_abilities,(1093678929),(1),(160))
 call SaveInteger(hash_abilities,(1093678929),(2),(110))
 call SaveInteger(hash_abilities,(1093678929),(3),(60))
 call SaveInteger(hash_abilities,(1093683257),(1),(120))
 call SaveInteger(hash_abilities,(1093683257),(2),(120))
 call SaveInteger(hash_abilities,(1093683257),(3),(120))
 call SaveInteger(hash_abilities,(1093677363),(1),(140))
 call SaveInteger(hash_abilities,(1093677363),(2),(120))
 call SaveInteger(hash_abilities,(1093677363),(3),(100))
@@ -14393,34 +14962,34 @@
 call SaveInteger(hash_abilities,(1093686072),(2),(85))
 call SaveInteger(hash_abilities,(1093686072),(3),(85))
 call SaveInteger(hash_abilities,(1093751120),(1),(85))
 call SaveInteger(hash_abilities,(1093751120),(2),(85))
 call SaveInteger(hash_abilities,(1093751120),(3),(85))
 call SaveInteger(hash_abilities,(1093684308),(1),(120))
 call SaveInteger(hash_abilities,(1093684308),(2),(120))
 call SaveInteger(hash_abilities,(1093684308),(3),(120))
 call SaveInteger(hash_abilities,(1093747539),(1),(30))
 call SaveInteger(hash_abilities,(1093747539),(2),(30))
 call SaveInteger(hash_abilities,(1093747539),(3),(30))
 call SaveInteger(hash_abilities,(1093742932),(1),(80))
 call SaveInteger(hash_abilities,(1093742932),(2),(70))
 call SaveInteger(hash_abilities,(1093742932),(3),(60))
 call SaveInteger(hash_abilities,(1093752632),(1),(90))
-call SaveInteger(hash_abilities,(1093752632),(2),(60))
+call SaveInteger(hash_abilities,(1093752632),(2),(75))
 call SaveInteger(hash_abilities,(1093752632),(3),(60))
 call SaveInteger(hash_abilities,(1093752633),(1),(90))
-call SaveInteger(hash_abilities,(1093752633),(2),(60))
+call SaveInteger(hash_abilities,(1093752633),(2),(75))
 call SaveInteger(hash_abilities,(1093752633),(3),(60))
 call SaveInteger(hash_abilities,(1093810503),(1),(120))
 call SaveInteger(hash_abilities,(1093810503),(2),(120))
 call SaveInteger(hash_abilities,(1093810503),(3),(120))
 call SaveInteger(hash_abilities,(1093810504),(1),(120))
 call SaveInteger(hash_abilities,(1093810504),(2),(120))
 call SaveInteger(hash_abilities,(1093810504),(3),(120))
 call SaveInteger(hash_abilities,(1093684275),(1),(160))
 call SaveInteger(hash_abilities,(1093684275),(2),(160))
 call SaveInteger(hash_abilities,(1093684275),(3),(160))
 call SaveInteger(hash_abilities,(1093677392),(1),(120))
 call SaveInteger(hash_abilities,(1093677392),(2),(90))
 call SaveInteger(hash_abilities,(1093677392),(3),(55))
 call SaveInteger(hash_abilities,(1093679450),(1),(120))
 call SaveInteger(hash_abilities,(1093679450),(2),(90))
@@ -14553,30 +15122,39 @@
 call SaveInteger(hash_abilities,(abilityid_calldown_upgrade),(1),(55))
 call SaveInteger(hash_abilities,(abilityid_calldown_upgrade),(2),(50))
 call SaveInteger(hash_abilities,(abilityid_calldown_upgrade),(3),(45))
 call SaveInteger(hash_abilities,(1093751617),(1),(50))
 call SaveInteger(hash_abilities,(1093751617),(2),(50))
 call SaveInteger(hash_abilities,(1093751617),(3),(50))
 call SaveInteger(hash_abilities,(abilityid_supernova),(1),(110))
 call SaveInteger(hash_abilities,(abilityid_supernova),(2),(110))
 call SaveInteger(hash_abilities,(abilityid_supernova),(3),(110))
 call SaveInteger(hash_abilities,(abilityid_walruspunch),(1),(30))
 call SaveInteger(hash_abilities,(abilityid_walruspunch),(2),(24))
 call SaveInteger(hash_abilities,(abilityid_walruspunch),(3),(18))
 call SaveInteger(hash_abilities,(abilityid_spellsteal),(1),(20))
 call SaveInteger(hash_abilities,(abilityid_spellsteal),(2),(18))
 call SaveInteger(hash_abilities,(abilityid_spellsteal),(3),(16))
+call SaveInteger(hash_abilities,(1093812807),(1),(60))
+call SaveInteger(hash_abilities,(1093812807),(2),(40))
+call SaveInteger(hash_abilities,(1093812807),(3),(20))
+call SaveInteger(hash_abilities,(1093813065),(1),(50))
+call SaveInteger(hash_abilities,(1093813065),(2),(50))
+call SaveInteger(hash_abilities,(1093813065),(3),(50))
+call SaveInteger(hash_abilities,(1093813557),(1),(8))
+call SaveInteger(hash_abilities,(1093813557),(2),(8))
+call SaveInteger(hash_abilities,(1093813557),(3),(8))
 endfunction
 function ReliableGold_Main takes nothing returns boolean
 local player p
 local integer i
 local integer id
 local integer TotalGold
 set i=1
 loop
 exitwhen i>5
 set p=udg_SentPlayers[i]
 set id=GetPlayerId(p)
 set TotalGold=GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)
 if TotalGold<ReliableGold[id]then
 set ReliableGold[id]=TotalGold
 endif
@@ -14976,34 +15554,32 @@
 local boolean QuickRevive=CustomHeroRevive_QuickRevive[i]
 local player DeadPlayer=GetOwningPlayer(DeadHero)
 local location RespawnLoc
 if IsScourge(DeadPlayer)then
 set RespawnLoc=GetRectCenter(gg_rct_Hero_Creation_UD)
 else
 set RespawnLoc=GetRectCenter(gg_rct_Hero_Creation_NE)
 endif
 if udg_GameOver==false and IsDead(DeadHero)then
 call ReviveCamera(DeadHero,DeadPlayer,GetLocationX(RespawnLoc),GetLocationY(RespawnLoc),true)
 if Deathtrigger_IsKobold(DeadHero)==false or GetUnitAbilityLevel(DeadHero,1093684567)==0 then
 call ReviveHeroLoc(DeadHero,RespawnLoc,true)
 else
 call Deathtrigger_ReviveKobold(DeadHero,RespawnLoc)
 endif
-if QuickRevive then
 call SetUnitState(DeadHero,UNIT_STATE_MANA,GetUnitState(DeadHero,UNIT_STATE_MAX_MANA))
 endif
-endif
 call RemoveLocation(RespawnLoc)
 call CustomHeroRevive_RemoveSlot(i)
 set DeadHero=null
 set DeadPlayer=null
 set RespawnLoc=null
 endfunction
 function CustomHeroRevive_Iterate takes nothing returns boolean
 local real CurrentTime=(TimerGetElapsed(udg_GameTimer))
 local integer i
 set i=1
 loop
 exitwhen i>CustomHeroRevive_MaxIndex
 if CustomHeroRevive_Time[i]<CurrentTime and CustomHeroRevive_Time[i]!=0 then
 call CustomHeroRevive_Revive(i)
 endif
@@ -15058,30 +15634,121 @@
 set ancientjangoo_count=ancientjangoo_count+1
 set charges=GetItemCharges(FindItemOfType(GetFilterUnit(),Item_Real[indexid_ancientjangoo]))
 set charges=IMinBJ(charges+1,5)
 call SetItemCharges(FindItemOfType(GetFilterUnit(),Item_Real[indexid_ancientjangoo]),charges)
 endif
 endif
 return false
 endfunction
 function Bloodstone_HeroDied takes unit u returns nothing
 local group g=GetAvailableGroup()
 set bloodstone_tempdeadhero=u
 call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1625,Condition(function Bloodstone_FindNearbyHeroes))
 call KillGroup(g)
 set g=null
 endfunction
+function BladeOfTheReaper_Image_AI takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Image=(LoadUnitHandle(hash_main,(Cache),(335)))
+local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
+local real x
+local real y
+local real a
+if GetTriggerEventId()==EVENT_WIDGET_DEATH then
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+if GetTriggerUnit()!=Image then
+call KillUnit(Image)
+endif
+else
+set a=GetUnitFacing(Target)*bj_RADTODEG
+set x=GetUnitX(Target)+75
+set y=GetUnitY(Target)+75
+call SetUnitX(Image,x)
+call SetUnitY(Image,y)
+call IssueTargetOrder(Image,"attack",Target)
+endif
+set t=null
+set Image=null
+set Target=null
+return false
+endfunction
+function BladeOfTheReaper_ImageEnters takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
+local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
+local unit Image
+if GetSummoningUnit()==Caster then
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+set Image=GetSummonedUnit()
+set t=CreateTrigger()
+set Cache=GetHandleId(t)
+call TriggerRegisterDeathEvent(t,Image)
+call TriggerRegisterDeathEvent(t,Target)
+call TriggerRegisterTimerEvent(t,0.05,true)
+call TriggerAddCondition(t,Condition(function BladeOfTheReaper_Image_AI))
+call SaveUnitHandle(hash_main,(Cache),(335),(Image))
+call SaveUnitHandle(hash_main,(Cache),(17),(Target))
+call UnitAddAbility(Image,1097625443)
+call SetUnitPosition(Image,GetUnitX(Target)+100,GetUnitY(Target)+100)
+call IssueTargetOrder(Image,"attack",Target)
+call SetUnitMoveSpeed(Image,522)
+endif
+set t=null
+set Target=null
+set Source=null
+set Caster=null
+return false
+endfunction
+function BladeOfTheReaper_SpawnIllusion takes unit Source,unit Killer returns nothing
+local unit Target=Killer
+local unit Caster
+local trigger t=CreateTrigger()
+local integer Cache=GetHandleId(t)
+if IsCasterUnit(Target)then
+set Target=(udg_Hero[GetPlayerId(GetOwningPlayer((Target)))])
+endif
+set Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
+call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SUMMON)
+call TriggerAddCondition(t,Condition(function BladeOfTheReaper_ImageEnters))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+call SaveUnitHandle(hash_main,(Cache),(17),(Target))
+call SaveUnitHandle(hash_main,(Cache),(19),(Caster))
+call UnitAddAbility2(Caster,1093813559)
+call IssueTargetOrderById(Caster,852274,Target)
+set t=null
+set Target=null
+set Caster=null
+endfunction
+function BladeOfTheReaper_FindNearbyHeroes takes nothing returns boolean
+if(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitIllusion(GetFilterUnit())==false then
+if IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(bloodstone_tempdeadhero))==false and FindItemOfType(GetFilterUnit(),Item_Real[indexid_bladeofthereaper])!=null then
+endif
+endif
+return false
+endfunction
+function BladeOfTheReaper_HeroDied takes unit u returns nothing
+local group g=GetAvailableGroup()
+set bloodstone_tempdeadhero=u
+call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1625,Condition(function BladeOfTheReaper_FindNearbyHeroes))
+call KillGroup(g)
+set g=null
+endfunction
 function StaffOfHealing_HeroDied takes unit u returns nothing
 local group g=GetAvailableGroup()
 set staffofhealing_count=0
 set staffofhealing_tempdeadhero=u
 call GroupEnumUnitsInRange(g,GetUnitX(u),GetUnitY(u),1425,Condition(function StaffOfHealing_FindNearbyHeroes))
 call KillGroup(g)
 set staffofhealing_count=0
 set g=null
 endfunction
 function Deathtrigger_OwnageMsg_Helper takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local integer side=(LoadInteger(hash_main,(Cache),(88)))
 local integer i=1
 local player p
@@ -15282,30 +15949,32 @@
 local string KillPlayerString
 local string DeathText
 local string GoldText
 local boolean QuickRevive=false
 local real RespawnTimeModifier1=1
 local real RespawnTimeModifier2=1
 local real RespawnTimeModifier3=1
 local real RespawnTimeModifier4=1
 local real RespawnTimeModifier_Constant=0
 local trigger t
 local integer TotalRespawnTime
 local integer AssistCount=Assist_GetCount(DeadHero,KillHero)
 local integer id
 local integer CurrentGold=GetPlayerState(DeadPlayer,PLAYER_STATE_RESOURCE_GOLD)
 local integer UnreliableGold=CurrentGold-ReliableGold[GetPlayerId(DeadPlayer)]
+local unit RealKillHero
+local unit RealDeadHero
 call GiveBonusXPGold()
 if KillHero==null and GetUnitTypeId(DeadHero)==1315988077 then
 set KillHero=primalsplit_killer
 set KillPlayer=GetOwningPlayer(KillHero)
 endif
 if KillHero!=null then
 set id=GetUnitTypeId(KillHero)
 call Techies_FixXP(udg_Hero[GetPlayerId(GetOwningPlayer(KillHero))],DeadHero)
 endif
 if Deathtrigger_IsSuicide(DeadPlayer,KillPlayer)==false and AssistCount==1 and IsRealPlayer(KillPlayer)==false and KillPlayer!=udg_NeutralHostile then
 call Assist_GetPlayers(DeadHero,KillHero)
 set KillPlayer=AssistPlayers[1]
 set KillHero=udg_Hero[GetPlayerId(KillPlayer)]
 endif
 if IsSent(GetOwningPlayer(DeadHero))then
@@ -15423,30 +16092,44 @@
 elseif x==8 then
 set GoldReward=300
 set DeathStreakText="|c00ff80ff"+GetObjectName(MSG_MONSTER_KILL)+"|r"
 elseif x==9 then
 set GoldReward=350
 set DeathStreakText="|c00ff0000"+GetObjectName(MSG_GODLIKE)+"|r"
 else
 set GoldReward=400
 set DeathStreakText="|c00ff8000"+GetObjectName(MSG_BEYOND_GODLIKE)+"|r"
 endif
 endif
 set x=udg_Killsinarow[GetPlayerId(KillPlayer)]
 if x>LongestSpree[GetPlayerId(KillPlayer)]then
 set LongestSpree[GetPlayerId(KillPlayer)]=x
 endif
+set RealKillHero=KillHero
+if IsUnitType(RealKillHero,UNIT_TYPE_HERO)==false then
+set RealKillHero=udg_Hero[GetPlayerId(GetOwningPlayer(RealKillHero))]
+endif
+if x>2 and GetUnitTypeId(RealKillHero)!=1429221446 and nohat_setting[GetPlayerId(GetOwningPlayer(RealKillHero))]==0 then
+call UnitAddAbility2(RealKillHero,1093815114)
+endif
+set RealDeadHero=DeadHero
+if IsUnitType(RealDeadHero,UNIT_TYPE_HERO)==false then
+set RealDeadHero=udg_Hero[GetPlayerId(GetOwningPlayer(RealDeadHero))]
+endif
+if suicide==false and EnemyDeath==true then
+call UnitRemoveAbility(RealDeadHero,1093815114)
+endif
 if x>2 and suicide==false then
 if x==3 then
 call PlaySoundEx(gg_snd_KillingSpree)
 set KillStreakText=" "+GetObjectName(MSG_IS_ON_A)+" |c0000ff40"+GetObjectName(MSG_KILLING_SPREE)+"|r"+GetObjectName(MSG_EXCLAMATION)
 elseif x==4 then
 call PlaySoundEx(gg_snd_Dominating)
 set KillStreakText=" "+GetObjectName(MSG_IS)+" |c00400080"+GetObjectName(MSG_DOMINATING)+"|r"+GetObjectName(MSG_EXCLAMATION)
 elseif x==5 then
 call PlaySoundEx(gg_snd_MegaKill)
 set KillStreakText=" "+GetObjectName(MSG_HAS_A)+" |c00ff0080"+GetObjectName(MSG_MEGA_KILL)+"|r"+GetObjectName(MSG_EXCLAMATION)
 elseif x==6 then
 call PlaySoundEx(gg_snd_Unstoppable)
 set KillStreakText=" "+GetObjectName(MSG_IS)+" |c00ff8000"+GetObjectName(MSG_UNSTOPPABLE)+"|r"+GetObjectName(MSG_EXCLAMATION2)
 elseif x==7 then
 call PlaySoundEx(gg_snd_WhickedSick)
@@ -15497,39 +16180,40 @@
 call DisplayTimedTextToForceEx(udg_AllMsgPlayers,10,KillPlayerString+KillStreakText)
 endif
 set ReliableGold[GetPlayerId(KillPlayer)]=ReliableGold[GetPlayerId(KillPlayer)]+GoldReward
 call GiveGoldWithAnimation(KillPlayer,GoldReward,DeadHero)
 set GoldGained[GetPlayerId(KillPlayer)]=GoldGained[GetPlayerId(KillPlayer)]+GoldReward
 if udg_TeamOwnage[1]>4 then
 call Deathtrigger_OwnageMsg(0)
 endif
 if udg_TeamOwnage[2]>4 then
 call Deathtrigger_OwnageMsg(1)
 endif
 endif
 set GoldPenalty=GetHeroLevel(DeadHero)*30
 if FindItemOfType(DeadHero,Item_Real[indexid_bloodstone])!=null then
 if GetItemCharges(FindItemOfType(DeadHero,Item_Real[indexid_bloodstone]))>0 then
-set RespawnTimeModifier_Constant=-1*(3*GetItemCharges(FindItemOfType(DeadHero,Item_Real[indexid_bloodstone])))
+set RespawnTimeModifier_Constant=-1*(4*GetItemCharges(FindItemOfType(DeadHero,Item_Real[indexid_bloodstone])))
 set GoldPenalty=IMaxBJ(R2I(GoldPenalty-25*GetItemCharges(FindItemOfType(DeadHero,Item_Real[indexid_bloodstone]))),0)
 endif
 endif
 if GoldPenalty>UnreliableGold then
 set GoldPenalty=UnreliableGold
 endif
 call Bloodstone_HeroDied(DeadHero)
 call StaffOfHealing_HeroDied(DeadHero)
+call BladeOfTheReaper_HeroDied(DeadHero)
 if QuickRevive==false then
 set GoldLost[GetPlayerId(DeadPlayer)]=GoldLost[GetPlayerId(DeadPlayer)]+GoldPenalty
 call TakeGoldWithAnimation(DeadHero,GoldPenalty)
 endif
 call SaveInteger(hash_main,(400+GetPlayerId(KillPlayer)),(450+GetPlayerId(DeadPlayer)),((LoadInteger(hash_main,(400+GetPlayerId(KillPlayer)),(450+GetPlayerId(DeadPlayer))))+1))
 call SaveInteger(hash_main,(400+GetPlayerId(DeadPlayer)),(500+GetPlayerId(KillPlayer)),((LoadInteger(hash_main,(400+GetPlayerId(DeadPlayer)),(500+GetPlayerId(KillPlayer))))+1))
 call StartTimerBJ(udg_KillTimer[GetPlayerId(KillPlayer)],false,18)
 if suicide==false and KillPlayer!=udg_SentPlayers[0]and KillPlayer!=udg_ScourgePlayers[0]and KillPlayer!=udg_NeutralHostile then
 set udg_KillInt[GetPlayerId(KillPlayer)]=udg_KillInt[GetPlayerId(KillPlayer)]+1
 if udg_KillInt[GetPlayerId(KillPlayer)]==2 then
 set NumOfDoubleKills[GetPlayerId(KillPlayer)]=NumOfDoubleKills[GetPlayerId(KillPlayer)]+1
 call Deathtrigger_ExtraKillMsg(udg_Colors[GetPlayerId(KillPlayer)]+(PlayerNames[GetPlayerId((KillPlayer))])+"|r "+GetObjectName(MSG_JUST_GOT_A)+" |c000000ff"+GetObjectName(MSG_DOUBLE_KILL)+"|r"+GetObjectName(MSG_EXCLAMATION),SOUND_DOUBLEKILL)
 endif
 if udg_KillInt[GetPlayerId(KillPlayer)]==3 then
 set NumOfTrippleKills[GetPlayerId(KillPlayer)]=NumOfTrippleKills[GetPlayerId(KillPlayer)]+1
@@ -17354,30 +18265,102 @@
 set Item_Real[Item_Max]=1227902539
 set Item_Unit[Item_Max]=0
 set Item_Mute[Item_Max]=1227902541
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNJanggo.blp"
 set Item_Cooldown[Item_Max]=0
 set indexid_ancientjangooempty=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227902770
 set Item_Real[Item_Max]=1227902771
 set Item_Unit[Item_Max]=0
 set Item_Mute[Item_Max]=1227902772
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNBoneChimes.blp"
 set Item_Cooldown[Item_Max]=30
 set indexid_veilofdiscord=Item_Max
 set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902787
+set Item_Real[Item_Max]=1227902789
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902788
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNBoneChimes.blp"
+set Item_Cooldown[Item_Max]=30
+set indexid_bladeofthereaper=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902790
+set Item_Real[Item_Max]=1227902791
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902792
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNTranquilBoots.blp"
+set Item_Cooldown[Item_Max]=30
+set indexid_ironboots=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902794
+set Item_Real[Item_Max]=1227902793
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902795
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNTranquilBoots.blp"
+set Item_Cooldown[Item_Max]=30
+set indexid_ironboots_disabled=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902797
+set Item_Real[Item_Max]=1227902796
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902798
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNWitchDoctorMaster.blp"
+set Item_Cooldown[Item_Max]=20
+set indexid_cripplingstaff=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902800
+set Item_Real[Item_Max]=1227902799
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902801
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNPendantOfMana.blp"
+set Item_Cooldown[Item_Max]=20
+set indexid_moonshard=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902805
+set Item_Real[Item_Max]=1227902806
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902807
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNHalberd.blp"
+set Item_Cooldown[Item_Max]=30
+set indexid_prudence=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902809
+set Item_Real[Item_Max]=1227902808
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902810
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNAnnihilator.blp"
+set Item_Cooldown[Item_Max]=60
+set indexid_annihilator=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227903024
+set Item_Real[Item_Max]=1227903025
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227903026
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNRingJadeFalcon.blp"
+set Item_Cooldown[Item_Max]=0
+set indexid_ringofaquila=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227903027
+set Item_Real[Item_Max]=1227903028
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227903029
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNRingJadeFalcon.blp"
+set Item_Cooldown[Item_Max]=0
+set indexid_ringofaquilaheroes=Item_Max
+set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=0
 set Item_Real[Item_Max]=0
 set Item_Unit[Item_Max]=1747989063
 set Item_Icon[Item_Max]=""
 set Item_Cooldown[Item_Max]=0
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=0
 set Item_Real[Item_Max]=0
 set Item_Unit[Item_Max]=1747990582
 set Item_Icon[Item_Max]=""
 set Item_Cooldown[Item_Max]=0
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227896140
 set Item_Real[Item_Max]=1227896146
 set Item_Unit[Item_Max]=1747989064
@@ -17740,36 +18723,30 @@
 set Item_Mute[Item_Max]=1227900244
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
 set Item_Cooldown[Item_Max]=0
 set indexid_recipe_armletofmordiggian=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227896660
 set Item_Real[Item_Max]=1227896901
 set Item_Unit[Item_Max]=1747989335
 set Item_Mute[Item_Max]=1227900245
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
 set Item_Cooldown[Item_Max]=0
 set indexid_recipe_shivasguard=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=0
 set Item_Real[Item_Max]=0
-set Item_Unit[Item_Max]=1747989336
-set Item_Icon[Item_Max]=""
-set Item_Cooldown[Item_Max]=0
-set Item_Max=Item_Max+1
-set Item_Dummy[Item_Max]=0
-set Item_Real[Item_Max]=0
 set Item_Unit[Item_Max]=1747990329
 set Item_Icon[Item_Max]=""
 set Item_Cooldown[Item_Max]=0
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227900984
 set Item_Real[Item_Max]=1227900983
 set Item_Unit[Item_Max]=1747990355
 set Item_Mute[Item_Max]=1227900985
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
 set Item_Cooldown[Item_Max]=0
 set indexid_recipe_magicwand=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227900996
 set Item_Real[Item_Max]=1227900998
 set Item_Unit[Item_Max]=1747990356
@@ -17829,45 +18806,94 @@
 set Item_Dummy[Item_Max]=1227902536
 set Item_Real[Item_Max]=1227902537
 set Item_Unit[Item_Max]=1747993433
 set Item_Mute[Item_Max]=1227902538
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
 set Item_Cooldown[Item_Max]=0
 set indexid_recipe_medallionofcourage=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227902773
 set Item_Real[Item_Max]=1227902774
 set Item_Unit[Item_Max]=1747993668
 set Item_Mute[Item_Max]=1227902775
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
 set Item_Cooldown[Item_Max]=0
 set indexid_recipe_veilofdiscord=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902786
+set Item_Real[Item_Max]=1227902785
+set Item_Unit[Item_Max]=1747989336
+set Item_Mute[Item_Max]=1227902777
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNSnazzyScroll.blp"
+set Item_Cooldown[Item_Max]=0
+set indexid_recipe_orchidmalevolence=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=0
+set Item_Real[Item_Max]=0
+set Item_Unit[Item_Max]=1747993684
+set Item_Icon[Item_Max]=""
+set Item_Cooldown[Item_Max]=0
+set indexid_recipe_bladeofthereaper=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=0
+set Item_Real[Item_Max]=0
+set Item_Unit[Item_Max]=1747993685
+set Item_Icon[Item_Max]=""
+set Item_Cooldown[Item_Max]=0
+set indexid_recipe_ironboots=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=0
+set Item_Real[Item_Max]=0
+set Item_Unit[Item_Max]=1747993913
+set Item_Icon[Item_Max]=""
+set Item_Cooldown[Item_Max]=0
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=0
+set Item_Real[Item_Max]=0
+set Item_Unit[Item_Max]=1747993921
+set Item_Icon[Item_Max]=""
+set Item_Cooldown[Item_Max]=0
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=0
+set Item_Real[Item_Max]=0
+set Item_Unit[Item_Max]=1747993923
+set Item_Icon[Item_Max]=""
+set Item_Cooldown[Item_Max]=0
 endfunction
 function InitTrig_Item_Definitions takes nothing returns nothing
 call Initialize_Items()
 set tpmemory_r=CreateRegion()
 call RegionAddRect(tpmemory_r,gg_rct_FountainBuffer1)
 call RegionAddRect(tpmemory_r,gg_rct_FountainBuffer2)
 endfunction
 function IsPowerup takes integer i returns boolean
 return i==powerup_haste or i==powerup_regeneration or i==powerup_invisibility or i==powerup_doubledamage or i==powerup_illusion
 endfunction
 function PowerupSpawn_Find takes nothing returns nothing
 if GetWidgetLife(GetEnumItem())>0 and IsPowerup(GetItemTypeId(GetEnumItem()))then
 set tt_item1=GetEnumItem()
 endif
 endfunction
+function PowerupSpawn_GetLuck takes nothing returns integer
+local integer i=GetRandomInt(1,5)
+loop
+exitwhen i!=powerup_previous
+set i=GetRandomInt(1,5)
+endloop
+set powerup_previous=i
+return i
+endfunction
 function PowerupSpawn takes nothing returns boolean
 local boolean taken1=false
 local boolean taken2=false
 local real x
 local real y
 local real x1
 local real y1
 local real x2
 local real y2
 local integer rand
 if GetRandomInt(1,2)==1 then
 set x=GetLocationX(udg_RuneSpawn1Loc)
 set y=GetLocationY(udg_RuneSpawn1Loc)
 else
 set x=GetLocationX(udg_RuneSpawn2Loc)
@@ -17877,60 +18903,60 @@
 set y1=GetLocationY(udg_RuneSpawn1Loc)
 set x2=GetLocationX(udg_RuneSpawn2Loc)
 set y2=GetLocationY(udg_RuneSpawn2Loc)
 set tt_item1=null
 call EnumItemsInRect(gg_rct_RuneSpawn1,Condition(function GenericCondition_True),function PowerupSpawn_Find)
 if tt_item1==null then
 set taken1=true
 endif
 set tt_item1=null
 call EnumItemsInRect(gg_rct_RuneSpawn2,Condition(function GenericCondition_True),function PowerupSpawn_Find)
 if tt_item1==null then
 set taken2=true
 endif
 if udg_ModeER==false or GetTriggerEvalCount(GetTriggeringTrigger())<20 then
 if taken1 and taken2 then
-set rand=GetRandomInt(1,5)
+set rand=PowerupSpawn_GetLuck()
 if rand==1 then
 call CreateItem(powerup_illusion,x,y)
 elseif rand==2 then
 call CreateItem(powerup_haste,x,y)
 elseif rand==3 then
 call CreateItem(powerup_doubledamage,x,y)
 elseif rand==4 then
 call CreateItem(powerup_regeneration,x,y)
 elseif rand==5 then
 call CreateItem(powerup_invisibility,x,y)
 endif
 endif
 else
 if taken1 then
-set rand=GetRandomInt(1,5)
+set rand=PowerupSpawn_GetLuck()
 if rand==1 then
 call CreateItem(powerup_illusion,x1,y1)
 elseif rand==2 then
 call CreateItem(powerup_haste,x1,y1)
 elseif rand==3 then
 call CreateItem(powerup_doubledamage,x1,y1)
 elseif rand==4 then
 call CreateItem(powerup_regeneration,x1,y1)
 elseif rand==5 then
 call CreateItem(powerup_invisibility,x1,y1)
 endif
 endif
 if taken2 then
-set rand=GetRandomInt(1,5)
+set rand=PowerupSpawn_GetLuck()
 if rand==1 then
 call CreateItem(powerup_illusion,x2,y2)
 elseif rand==2 then
 call CreateItem(powerup_haste,x2,y2)
 elseif rand==3 then
 call CreateItem(powerup_doubledamage,x2,y2)
 elseif rand==4 then
 call CreateItem(powerup_regeneration,x2,y2)
 elseif rand==5 then
 call CreateItem(powerup_invisibility,x2,y2)
 endif
 endif
 endif
 return false
 endfunction
@@ -18124,31 +19150,31 @@
 set Recipe_Component_1[Recipe_Max]=indexid_staffofwizardry
 set Recipe_Component_2[Recipe_Max]=indexid_beltofgiantstrength
 set Recipe_Component_3[Recipe_Max]=indexid_recipe_necronomicon
 set Recipe_Result[Recipe_Max]=indexid_necronomiconlevel1
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_necronomiconlevel1
 set Recipe_Component_2[Recipe_Max]=indexid_recipe_necronomicon
 set Recipe_Result[Recipe_Max]=indexid_necronomiconlevel2
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_necronomiconlevel2
 set Recipe_Component_2[Recipe_Max]=indexid_recipe_necronomicon
 set Recipe_Result[Recipe_Max]=indexid_necronomiconlevel3
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_ultimateorb
 set Recipe_Component_2[Recipe_Max]=indexid_perseverance
-set Recipe_Component_4[Recipe_Max]=indexid_recipe_linkenssphere
+set Recipe_Component_3[Recipe_Max]=indexid_recipe_linkenssphere
 set Recipe_Result[Recipe_Max]=indexid_linkenssphere
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_demonedge
 set Recipe_Component_2[Recipe_Max]=indexid_sacredrelic
 set Recipe_Result[Recipe_Max]=indexid_divinerapier
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_crystalys
 set Recipe_Component_2[Recipe_Max]=indexid_demonedge
 set Recipe_Component_3[Recipe_Max]=indexid_recipe_burizadokyanon
 set Recipe_Result[Recipe_Max]=indexid_burizadokyanon
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_demonedge
 set Recipe_Component_2[Recipe_Max]=indexid_javelin
 set Recipe_Component_3[Recipe_Max]=indexid_javelin
 set Recipe_Result[Recipe_Max]=indexid_monkeykingbar
@@ -18263,31 +19289,31 @@
 set Recipe_Result[Recipe_Max]=indexid_hoodofdefiance
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_glovesofhaste
 set Recipe_Component_2[Recipe_Max]=indexid_helmofironwill
 set Recipe_Component_3[Recipe_Max]=indexid_bladesofattack
 set Recipe_Component_4[Recipe_Max]=indexid_recipe_armletofmordiggian
 set Recipe_Result[Recipe_Max]=indexid_armletofmordiggianoffcourier
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_mysticstaff
 set Recipe_Component_2[Recipe_Max]=indexid_platemail
 set Recipe_Component_3[Recipe_Max]=indexid_recipe_shivasguard
 set Recipe_Result[Recipe_Max]=indexid_shivasguard
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_oblivionstaff
 set Recipe_Component_2[Recipe_Max]=indexid_oblivionstaff
-set Recipe_Component_3[Recipe_Max]=indexid_oblivionstaff
+set Recipe_Component_3[Recipe_Max]=indexid_recipe_orchidmalevolence
 set Recipe_Result[Recipe_Max]=indexid_orchidmalevolence
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_bootsofspeed
 set Recipe_Component_2[Recipe_Max]=indexid_bladesofattack
 set Recipe_Component_3[Recipe_Max]=indexid_bladesofattack
 set Recipe_Result[Recipe_Max]=indexid_phaseboots
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_magicstick
 set Recipe_Component_2[Recipe_Max]=indexid_ironwoodbranch
 set Recipe_Component_3[Recipe_Max]=indexid_ironwoodbranch
 set Recipe_Component_4[Recipe_Max]=indexid_ironwoodbranch
 set Recipe_Component_5[Recipe_Max]=indexid_recipe_magicwand
 set Recipe_Result[Recipe_Max]=indexid_magicwand
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_quarterstaff
@@ -18332,33 +19358,58 @@
 set Recipe_Component_1[Recipe_Max]=indexid_robeofthemagi
 set Recipe_Component_2[Recipe_Max]=indexid_bracer
 set Recipe_Component_3[Recipe_Max]=indexid_recipe_ancientjangoo
 set Recipe_Result[Recipe_Max]=indexid_ancientjangoo
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_ancientjangoo
 set Recipe_Component_2[Recipe_Max]=indexid_recipe_ancientjangoo
 set Recipe_Result[Recipe_Max]=indexid_ancientjangoo
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_ancientjangooempty
 set Recipe_Component_2[Recipe_Max]=indexid_recipe_ancientjangoo
 set Recipe_Result[Recipe_Max]=indexid_ancientjangoo
 set Recipe_Max=Recipe_Max+1
 set Recipe_Component_1[Recipe_Max]=indexid_helmofironwill
 set Recipe_Component_2[Recipe_Max]=indexid_robeofthemagi
-set Recipe_Component_3[Recipe_Max]=indexid_robeofthemagi
-set Recipe_Component_4[Recipe_Max]=indexid_recipe_veilofdiscord
+set Recipe_Component_3[Recipe_Max]=indexid_recipe_veilofdiscord
 set Recipe_Result[Recipe_Max]=indexid_veilofdiscord
+set Recipe_Max=Recipe_Max+1
+set Recipe_Component_1[Recipe_Max]=indexid_bootsofspeed
+set Recipe_Component_2[Recipe_Max]=indexid_ringofprotection
+set Recipe_Component_3[Recipe_Max]=indexid_ringofregeneration
+set Recipe_Result[Recipe_Max]=indexid_ironboots
+set Recipe_Max=Recipe_Max+1
+set Recipe_Component_1[Recipe_Max]=indexid_staffofwizardry
+set Recipe_Component_2[Recipe_Max]=indexid_staffofwizardry
+set Recipe_Component_3[Recipe_Max]=indexid_vitalitybooster
+set Recipe_Result[Recipe_Max]=indexid_cripplingstaff
+set Recipe_Max=Recipe_Max+1
+set Recipe_Component_1[Recipe_Max]=indexid_sange
+set Recipe_Component_2[Recipe_Max]=indexid_talismanofevasion
+set Recipe_Result[Recipe_Max]=indexid_prudence
+set Recipe_Max=Recipe_Max+1
+set Recipe_Component_1[Recipe_Max]=indexid_craniumbasher
+set Recipe_Component_2[Recipe_Max]=indexid_sacredrelic
+set Recipe_Result[Recipe_Max]=indexid_annihilator
+set Recipe_Max=Recipe_Max+1
+set Recipe_Component_1[Recipe_Max]=indexid_wraithband
+set Recipe_Component_2[Recipe_Max]=indexid_ringofbasilius
+set Recipe_Result[Recipe_Max]=indexid_ringofaquila
+set Recipe_Max=Recipe_Max+1
+set Recipe_Component_1[Recipe_Max]=indexid_wraithband
+set Recipe_Component_2[Recipe_Max]=indexid_ringofbasiliusheroes
+set Recipe_Result[Recipe_Max]=indexid_ringofaquilaheroes
 endfunction
 function InitTrig_Recipe_Definitions takes nothing returns nothing
 call Initialize_Recipes()
 endfunction
 function AghanimsScepter_Init takes nothing returns nothing
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227899226
 set Item_Real[Item_Max]=1227895089
 set Item_Unit[Item_Max]=0
 set Item_Mute[Item_Max]=1227900249
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
 set Item_Cooldown[Item_Max]=60
 set indexid_aghanimsscepterfurion=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227894854
@@ -18748,30 +19799,38 @@
 set Item_Dummy[Item_Max]=1227902551
 set Item_Real[Item_Max]=1227902552
 set Item_Unit[Item_Max]=0
 set Item_Mute[Item_Max]=1227902553
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
 set Item_Cooldown[Item_Max]=60
 set indexid_aghanimssceptermeepo=Item_Max
 set Item_Max=Item_Max+1
 set Item_Dummy[Item_Max]=1227902554
 set Item_Real[Item_Max]=1227902768
 set Item_Unit[Item_Max]=0
 set Item_Mute[Item_Max]=1227902769
 set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
 set Item_Cooldown[Item_Max]=60
 set indexid_aghanimsscepterbeastmaster=Item_Max
+set Item_Max=Item_Max+1
+set Item_Dummy[Item_Max]=1227902802
+set Item_Real[Item_Max]=1227902803
+set Item_Unit[Item_Max]=0
+set Item_Mute[Item_Max]=1227902804
+set Item_Icon[Item_Max]="ReplaceableTextures\\CommandButtons\\BTNINV_Wand_05.blp"
+set Item_Cooldown[Item_Max]=60
+set indexid_aghanimssceptervisage=Item_Max
 endfunction
 function InitTrig_Aghanims_Scepter_Definitions takes nothing returns nothing
 call AghanimsScepter_Init()
 endfunction
 function DeliverItems_GoHome takes unit Source returns nothing
 local real x
 local real y
 if IsSent(GetOwningPlayer(Source))then
 set x=GetRectCenterX(gg_rct_Hero_Creation_NE)
 set y=GetRectCenterY(gg_rct_Hero_Creation_NE)
 else
 set x=GetRectCenterX(gg_rct_Hero_Creation_UD)
 set y=GetRectCenterY(gg_rct_Hero_Creation_UD)
 endif
 call IssuePointOrder(Source,"move",x,y)
@@ -18788,31 +19847,31 @@
 local item Item=GetEnumItem()
 if GetWidgetLife(Item)>0 and GetItemPlayer(Item)==deliveritems_player then
 call UnitAddItem(deliveritems_courier,Item)
 endif
 set Item=null
 endfunction
 function DeliverItems_Giving takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Courier=(LoadUnitHandle(hash_main,(Cache),(92)))
 local player p=(LoadPlayerHandle(hash_main,(Cache),(54)))
 local real x=(LoadReal(hash_main,(Cache),(6)))
 local real y=(LoadReal(hash_main,(Cache),(7)))
 local rect r=Rect(x-300,y-300,x+300,y+300)
-if GetTriggerEventId()==EVENT_UNIT_DEATH then
+if GetTriggerEventId()==EVENT_WIDGET_DEATH then
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 set deliveritems_player=p
 set deliveritems_source=Source
 set deliveritems_courier=Courier
 call EnumItemsInRect(r,Condition(function GenericCondition_True),function DeliverItems_GiveBack)
 else
 if GetTriggerEvalCount(t)>9 then
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 set deliveritems_player=p
 set deliveritems_source=Source
 set deliveritems_courier=Courier
 call EnumItemsInRect(r,Condition(function GenericCondition_True),function DeliverItems_GiveBack)
 else
@@ -18830,31 +19889,31 @@
 return false
 endfunction
 function DeliverItems_DropOff takes unit Courier,unit Source returns nothing
 local player p=GetOwningPlayer(Source)
 local integer i
 local item Item
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local real x=GetUnitX(Courier)
 local real y=GetUnitY(Courier)
 local integer indexId
 if IsTerrainPathable(x,y,PATHING_TYPE_WALKABILITY)then
 set x=GetUnitX(Source)
 set y=GetUnitY(Source)
 endif
-call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
+call TriggerRegisterDeathEvent(t,Source)
 call TriggerRegisterTimerEvent(t,0.01,true)
 call TriggerAddCondition(t,Condition(function DeliverItems_Giving))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(92),(Courier))
 call SavePlayerHandle(hash_main,(Cache),(54),(p))
 call SaveReal(hash_main,(Cache),(6),((x)*1.0))
 call SaveReal(hash_main,(Cache),(7),((y)*1.0))
 set i=0
 loop
 exitwhen i>5
 set Item=UnitItemInSlot(Courier,i)
 set indexId=GetIndex(Item)
 if Item!=null and GetItemPlayer(Item)==p and IsItemInCooldown(Item)==false and(indexId!=indexid_emptybottleinvisibility and indexId!=indexid_emptybottledoubledamage and indexId!=indexid_emptybottlehaste and indexId!=indexid_emptybottleregeneration and indexId!=indexid_emptybottleillusion)then
 call UnitRemoveItem(Courier,Item)
 call SetItemPosition(Item,x,y)
@@ -18905,31 +19964,31 @@
 call IssuePointOrder(Courier,"move",UpdatedX,UpdatedY)
 set Courier=null
 set Hero=null
 set t=null
 endfunction
 function DeliverItems_Iterate takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Courier=(LoadUnitHandle(hash_main,(Cache),(92)))
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local real x
 local real y
 local integer i
 local player p=GetOwningPlayer(Source)
 local item Item
-if GetTriggerEventId()==EVENT_UNIT_DEATH then
+if GetTriggerEventId()==EVENT_WIDGET_DEATH then
 if GetTriggerUnit()==Source then
 call DeliverItems_GoHome(Courier)
 endif
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 elseif GetTriggerEventId()==EVENT_UNIT_ISSUED_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_TARGET_ORDER or GetTriggerEventId()==EVENT_UNIT_ISSUED_POINT_ORDER then
 if(LoadInteger(hash_main,(Cache),(679)))==1 then
 call SaveInteger(hash_main,(Cache),(679),(0))
 elseif GetIssuedOrderId()!=852100 and GetIssuedOrderId()!=852090 then
 call CleanTrigger(t)
 endif
 else
 if DistanceBetweenUnits(Courier,Source)<150 then
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
@@ -18947,32 +20006,32 @@
 endfunction
 function DeliverItems takes unit Hero,boolean direct returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Courier=GetSellingUnit()
 local integer DeliveryIndex=(LoadInteger(hash_main,(GetHandleId(Courier)),(8000)))
 if Hero!=null then
 if Hero!=(LoadUnitHandle(hash_main,(GetHandleId(Courier)),(8002+DeliveryIndex)))and direct then
 set DeliveryIndex=DeliveryIndex+1
 call SaveInteger(hash_main,(GetHandleId(Courier)),(8000),(DeliveryIndex))
 call SaveUnitHandle(hash_main,(GetHandleId(Courier)),(8002+DeliveryIndex),(Hero))
 endif
 call SaveReal(hash_main,(Cache),(677),((GetUnitX(Hero))*1.0))
 call SaveReal(hash_main,(Cache),(678),((GetUnitY(Hero))*1.0))
 call IssueTargetOrder(Courier,"move",Hero)
-call TriggerRegisterUnitEvent(t,Courier,EVENT_UNIT_DEATH)
-call TriggerRegisterUnitEvent(t,Hero,EVENT_UNIT_DEATH)
+call TriggerRegisterDeathEvent(t,Courier)
+call TriggerRegisterDeathEvent(t,Hero)
 call TriggerRegisterUnitEvent(t,Courier,EVENT_UNIT_ISSUED_ORDER)
 call TriggerRegisterUnitEvent(t,Courier,EVENT_UNIT_ISSUED_TARGET_ORDER)
 call TriggerRegisterUnitEvent(t,Courier,EVENT_UNIT_ISSUED_POINT_ORDER)
 call TriggerRegisterTimerEvent(t,0.2,true)
 call TriggerAddCondition(t,Condition(function DeliverItems_Iterate))
 call SaveUnitHandle(hash_main,(Cache),(2),(Hero))
 call SaveUnitHandle(hash_main,(Cache),(92),(Courier))
 endif
 set t=null
 set Courier=null
 endfunction
 function CollectItems_Pickup takes nothing returns nothing
 local item Item=GetEnumItem()
 local unit u=pickupallitems_unit
 local player p=GetOwningPlayer(u)
@@ -19302,31 +20361,31 @@
 call DestroyItem(Item)
 endif
 if i4>0 then
 set Item=UnitItemInSlot(whichUnit,4)
 call DestroyItem(Item)
 endif
 if i5>0 then
 set Item=UnitItemInSlot(whichUnit,5)
 call DestroyItem(Item)
 endif
 set Item=UnitAddItemById(whichUnit,Item_Real[resultitem])
 call SetItemPlayer(Item,whichPlayer,true)
 call SetItemUserData(Item,0)
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIem\\AIemTarget.mdl",whichUnit,"origin"))
 if GetIndex(Item)==indexid_bloodstone then
-call SetItemCharges(Item,5)
+call SetItemCharges(Item,6)
 endif
 call EnableTrigger(t_itemtraffic)
 if IsPlayerAlly(GetLocalPlayer(),whichPlayer)==true then
 if resultitem==indexid_mekansm then
 call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,udg_Colors[GetPlayerId(whichPlayer)]+(PlayerNames[GetPlayerId((whichPlayer))])+"|r |c00ffff00"+GetObjectName(1848659032)+"|r")
 elseif resultitem==indexid_divinerapier then
 call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,4,udg_Colors[GetPlayerId(whichPlayer)]+(PlayerNames[GetPlayerId((whichPlayer))])+"|r |c00ffff00"+GetObjectName(1848659033)+"|r")
 endif
 endif
 set Item=null
 endfunction
 function Fuse takes player p,unit whichUnit,integer indexId returns boolean
 local integer i
 local integer x
 local integer y
@@ -20477,61 +21536,70 @@
 local integer scepter_indexid
 local integer scepter_abilityid
 local integer id
 set id=GetPlayerId(GetOwningPlayer(Unit))
 if(IsUnitType(Unit,UNIT_TYPE_HERO)==true or IsSpiritBear(Unit))and IsUnitIllusion(Unit)==false then
 if GetTriggerEventId()==EVENT_PLAYER_UNIT_PICKUP_ITEM then
 if GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_javelin]then
 set TotalCount_Javelin=TotalCount_Javelin+1
 set HasItem_Javelin[id]=HasItem_Javelin[id]+1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_kelensdagger]then
 set TotalCount_Dagger=TotalCount_Dagger+1
 set HasItem_Dagger[id]=HasItem_Dagger[id]+1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_bloodstone]then
 set TotalCount_Bloodstone=TotalCount_Bloodstone+1
 set HasItem_Bloodstone[id]=HasItem_Bloodstone[id]+1
-elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_craniumbasher]then
+elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_craniumbasher]or GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_annihilator]then
 set TotalCount_CraniumBasher=TotalCount_CraniumBasher+1
 set HasItem_CraniumBasher[id]=HasItem_CraniumBasher[id]+1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_heartoftarrasque]then
 set TotalCount_Heart=TotalCount_Heart+1
 set HasItem_Heart[id]=HasItem_Heart[id]+1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_linkenssphere]then
 set TotalCount_LinkenSphere=TotalCount_LinkenSphere+1
 set HasItem_LinkenSphere[id]=HasItem_LinkenSphere[id]+1
 call UnitAddItemById(Unit,powerup_linkensphere)
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_sangeandyasha]then
 set TotalCount_SangeAndYasha=TotalCount_SangeAndYasha+1
 set HasItem_SangeAndYasha[id]=HasItem_SangeAndYasha[id]+1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_sange]then
 set TotalCount_Sange=TotalCount_Sange+1
 set HasItem_Sange[id]=HasItem_Sange[id]+1
+elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_prudence]then
+set TotalCount_Prudence=TotalCount_Prudence+1
+set HasItem_Prudence[id]=HasItem_Prudence[id]+1
+elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_ironboots]then
+set TotalCount_IronBoots=TotalCount_IronBoots+1
+set HasItem_IronBoots[id]=HasItem_IronBoots[id]+1
 endif
 elseif GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM then
 if GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_javelin]then
 set HasItem_Javelin[id]=HasItem_Javelin[id]-1
 set TotalCount_Javelin=TotalCount_Javelin-1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_kelensdagger]then
 set HasItem_Dagger[id]=HasItem_Dagger[id]-1
 set TotalCount_Dagger=TotalCount_Dagger-1
+elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_ironboots]then
+set HasItem_IronBoots[id]=HasItem_IronBoots[id]-1
+set TotalCount_IronBoots=TotalCount_IronBoots-1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_bloodstone]then
 set HasItem_Bloodstone[id]=HasItem_Bloodstone[id]-1
 set TotalCount_Bloodstone=TotalCount_Bloodstone-1
-elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_craniumbasher]then
+elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_craniumbasher]or GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_annihilator]then
 set TotalCount_CraniumBasher=TotalCount_CraniumBasher-1
 set HasItem_CraniumBasher[id]=HasItem_CraniumBasher[id]-1
-if HasItem_CraniumBasher[id]<1 or FindItemOfTypeEx(Unit,Item_Real[indexid_craniumbasher],GetManipulatedItem())==null then
+if HasItem_CraniumBasher[id]<1 or FindItemOfTypeEx(Unit,Item_Real[indexid_craniumbasher],GetManipulatedItem())==null or FindItemOfTypeEx(Unit,Item_Real[indexid_annihilator],GetManipulatedItem())==null then
 call UnitRemoveAbility(Unit,abilityid_craniumbasher)
 endif
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_heartoftarrasque]then
 set HasItem_Heart[id]=HasItem_Heart[id]-1
 set TotalCount_Heart=TotalCount_Heart-1
 elseif GetItemTypeId(GetManipulatedItem())==Item_Real[indexid_linkenssphere]or GetItemTypeId(GetManipulatedItem())==Item_Mute[indexid_linkenssphere]then
 set TotalCount_LinkenSphere=IMaxBJ(TotalCount_LinkenSphere-1,0)
 set HasItem_LinkenSphere[id]=IMaxBJ(HasItem_LinkenSphere[id]-1,0)
 call UnitRemoveAbility(Unit,buffid_linkensphere)
 endif
 endif
 endif
 if GetTriggerEventId()==EVENT_PLAYER_UNIT_PAWN_ITEM then
 set Item=GetSoldItem()
 call SetItemUserData(Item,-2)
@@ -21024,30 +22092,39 @@
 set newItem=CreateItem(Item_Dummy[indexid_ultimateorb],x,y)
 call SetItemPlayer(newItem,tt_player1,false)
 call SetItemUserData(newItem,1)
 set newItem=CreateItem(Item_Dummy[indexid_recipe_mantastyle],x,y)
 call SetItemPlayer(newItem,tt_player1,false)
 call SetItemUserData(newItem,1)
 elseif indexId==indexid_etherealblade then
 set tt_player1=GetItemPlayer(Item)
 call RemoveItem(Item)
 set newItem=CreateItem(Item_Dummy[indexid_eaglehorn],x,y)
 call SetItemPlayer(newItem,tt_player1,false)
 call SetItemUserData(newItem,1)
 set newItem=CreateItem(Item_Dummy[indexid_ghostscepter],x,y)
 call SetItemPlayer(newItem,tt_player1,false)
 call SetItemUserData(newItem,1)
+elseif indexId==indexid_ringofaquila or indexId==indexid_ringofaquilaheroes then
+set tt_player1=GetItemPlayer(Item)
+call RemoveItem(Item)
+set newItem=CreateItem(Item_Dummy[indexid_wraithband],x,y)
+call SetItemPlayer(newItem,tt_player1,false)
+call SetItemUserData(newItem,1)
+set newItem=CreateItem(Item_Dummy[indexid_ringofbasilius],x,y)
+call SetItemPlayer(newItem,tt_player1,false)
+call SetItemUserData(newItem,1)
 endif
 set i=i+1
 endloop
 call EnableTrigger(t_manipulateitem)
 set u=null
 set Item=null
 set newItem=null
 endfunction
 function Dissassemble_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_disassemble or GetSpellAbilityId()==abilityid_disassemble_courier then
 call Disassemble()
 endif
 return false
 endfunction
 function InitTrig_Disassemble takes nothing returns nothing
@@ -21315,30 +22392,89 @@
 set id=GetPlayerId(GetItemPlayer(Item))
 call SetItemPosition(Item,ItemSpawnX[id],ItemSpawnY[id])
 endif
 endif
 set i=i+1
 endloop
 call RemoveRegion(r)
 set u=null
 set r=null
 endfunction
 function DropAllItems_Main takes nothing returns nothing
 if GetSpellAbilityId()==abilityid_dropallitems1 or GetSpellAbilityId()==abilityid_dropallitems2 then
 call DropAllItems()
 endif
 endfunction
+function IronBoots_ShouldDisable takes unit Source returns boolean
+local integer Cache=GetHandleId(Source)
+local integer i=0
+local real Time=(TimerGetElapsed(udg_GameTimer))
+local real Buffer=10
+loop
+exitwhen i>2
+if(LoadReal(hash_main,(Cache),(730+i)))<Time-Buffer then
+return false
+endif
+set i=i+1
+endloop
+return true
+endfunction
+function IronBoots_DamageTracker takes unit Source returns nothing
+local integer Cache=GetHandleId(Source)
+local integer LastUsedIndex=(LoadInteger(hash_main,(Cache),(729)))
+call SaveReal(hash_main,(Cache),(730+LastUsedIndex),(((TimerGetElapsed(udg_GameTimer)))*1.0))
+set LastUsedIndex=LastUsedIndex+1
+if LastUsedIndex==3 then
+set LastUsedIndex=0
+endif
+call SaveInteger(hash_main,(Cache),(729),(LastUsedIndex))
+endfunction
+function IronBoots_Update takes unit Hero returns nothing
+local integer i=0
+local item IronBoots
+local integer indexId
+local boolean DisableBoots=false
+if IronBoots_ShouldDisable(Hero)then
+set DisableBoots=true
+endif
+loop
+exitwhen i>5
+set IronBoots=UnitItemInSlot(Hero,i)
+set indexId=ItemToIndex(IronBoots)
+if indexId==indexid_ironboots and DisableBoots==true then
+call DisableTrigger(t_manipulateitem)
+set tt_player1=GetItemPlayer(IronBoots)
+call RemoveItem(IronBoots)
+set tt_item1=SafeUnitAddItemToSlotById(Hero,Item_Real[indexid_ironboots_disabled],i)
+call SetItemPlayer(tt_item1,tt_player1,false)
+call SetItemUserData(tt_item1,1)
+call EnableTrigger(t_manipulateitem)
+endif
+if indexId==indexid_ironboots_disabled and DisableBoots==false then
+call DisableTrigger(t_manipulateitem)
+set tt_player1=GetItemPlayer(IronBoots)
+call RemoveItem(IronBoots)
+set tt_item1=SafeUnitAddItemToSlotById(Hero,Item_Real[indexid_ironboots],i)
+call SetItemPlayer(tt_item1,tt_player1,false)
+call SetItemUserData(tt_item1,1)
+call EnableTrigger(t_manipulateitem)
+endif
+set i=i+1
+endloop
+set Hero=null
+set IronBoots=null
+endfunction
 function Heart_Update takes unit Hero returns nothing
 local integer i=0
 local item Heart
 local integer indexId
 local boolean DisableHeart=false
 local real time=4
 if IsUnitType(Hero,UNIT_TYPE_MELEE_ATTACKER)==false then
 set time=6
 endif
 if BlinkDamaged_Time[GetPlayerId(GetOwningPlayer(Hero))]+time>(TimerGetElapsed(udg_GameTimer))then
 set DisableHeart=true
 endif
 loop
 exitwhen i>5
 set Heart=UnitItemInSlot(Hero,i)
@@ -21358,30 +22494,33 @@
 call RemoveItem(Heart)
 set tt_item1=SafeUnitAddItemToSlotById(Hero,Item_Real[indexid_heartoftarrasque],i)
 call SetItemPlayer(tt_item1,tt_player1,false)
 call SetItemUserData(tt_item1,1)
 call EnableTrigger(t_manipulateitem)
 endif
 set i=i+1
 endloop
 set Hero=null
 set Heart=null
 endfunction
 function BlinkDagger_Damaged takes nothing returns nothing
 if GetEventDamage()>2 and GetEventDamageSource()!=GetTriggerUnit()and(IsRealPlayer(GetOwningPlayer(GetEventDamageSource()))or GetUnitTypeId(GetEventDamageSource())==1848651852)then
 if safedamage_urn[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]==false then
 set BlinkDamaged_Time[GetPlayerId(GetOwningPlayer(GetTriggerUnit()))]=(TimerGetElapsed(udg_GameTimer))
+if GetEventDamage()>20 then
+call IronBoots_DamageTracker(GetTriggerUnit())
+endif
 endif
 endif
 endfunction
 function BlinkDagger_Update takes unit Hero returns nothing
 local integer i=0
 local item Dagger
 local integer indexId
 local boolean DisableDagger=false
 if BlinkDamaged_Time[GetPlayerId(GetOwningPlayer(Hero))]+3>(TimerGetElapsed(udg_GameTimer))then
 set DisableDagger=true
 endif
 loop
 exitwhen i>5
 set Dagger=UnitItemInSlot(Hero,i)
 set indexId=ItemToIndex(Dagger)
@@ -21400,49 +22539,55 @@
 call RemoveItem(Dagger)
 set tt_item1=SafeUnitAddItemToSlotById(Hero,Item_Real[indexid_kelensdagger],i)
 call SetItemPlayer(tt_item1,tt_player1,false)
 call SetItemUserData(tt_item1,1)
 call EnableTrigger(t_manipulateitem)
 endif
 set i=i+1
 endloop
 set Hero=null
 set Dagger=null
 endfunction
 function BlinkDagger_Main takes nothing returns boolean
 local integer i=1
 local unit Hero
 local integer id
-if TotalCount_Dagger>0 or TotalCount_Heart>0 then
+if TotalCount_Dagger>0 or TotalCount_Heart>0 or TotalCount_IronBoots>0 then
 loop
 exitwhen i>5
 set id=GetPlayerId(udg_SentPlayers[i])
 set Hero=udg_Hero[id]
 if HasItem_Dagger[id]>0 and Hero!=null and GetUnitTypeId(Hero)>1 and IsUnitType(Hero,UNIT_TYPE_DEAD)==false then
 call BlinkDagger_Update(Hero)
 endif
 if HasItem_Heart[id]>0 and Hero!=null and GetUnitTypeId(Hero)>1 and IsUnitType(Hero,UNIT_TYPE_DEAD)==false then
 call Heart_Update(Hero)
 endif
+if HasItem_IronBoots[id]>0 and Hero!=null and GetUnitTypeId(Hero)>1 and IsUnitType(Hero,UNIT_TYPE_DEAD)==false then
+call IronBoots_Update(Hero)
+endif
 set id=GetPlayerId(udg_ScourgePlayers[i])
 set Hero=udg_Hero[id]
 if HasItem_Dagger[id]>0 and Hero!=null and GetUnitTypeId(Hero)>1 and IsUnitType(Hero,UNIT_TYPE_DEAD)==false then
 call BlinkDagger_Update(Hero)
 endif
 if HasItem_Heart[id]>0 and Hero!=null and GetUnitTypeId(Hero)>1 and IsUnitType(Hero,UNIT_TYPE_DEAD)==false then
 call Heart_Update(Hero)
 endif
+if HasItem_IronBoots[id]>0 and Hero!=null and GetUnitTypeId(Hero)>1 and IsUnitType(Hero,UNIT_TYPE_DEAD)==false then
+call IronBoots_Update(Hero)
+endif
 set i=i+1
 endloop
 endif
 set Hero=null
 return false
 endfunction
 function InitTrig_Blink_Dagger takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterTimerEvent(t,0.33,true)
 call TriggerAddCondition(t,Condition(function BlinkDagger_Main))
 set t=null
 endfunction
 function FountainBottle_Update takes nothing returns nothing
 local unit Hero=GetFilterUnit()
 local integer i=0
@@ -21700,31 +22845,32 @@
 call UnitRemoveAbility(Attacker,abilityid_craniumbasher)
 set Attacker=null
 return
 endif
 if Active and Cooldown==false and Remove==false then
 call SaveReal(hash_main,(Cache),(101),((CurrentTime+2)*1.0))
 if NextActive==false then
 call SaveBoolean(hash_main,(Cache),(100),(true))
 endif
 elseif Cooldown or Remove then
 call UnitRemoveAbility(Attacker,abilityid_craniumbasher)
 call SaveBoolean(hash_main,(Cache),(99),(false))
 call SaveBoolean(hash_main,(Cache),(100),(false))
 endif
 if NextActive then
-call UnitAddAbility(Attacker,abilityid_craniumbasher)
+call UnitAddAbility2(Attacker,abilityid_craniumbasher)
+call UnitMakeAbilityPermanent(Attacker,true,1093744437)
 call SaveBoolean(hash_main,(Cache),(99),(true))
 endif
 set Attacker=null
 endfunction
 function InitTrig_Cranium_Basher takes nothing returns nothing
 call SetPlayerAbilityAvailable(udg_SentPlayers[1],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[2],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[3],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[4],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[5],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[1],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[2],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[3],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[4],abilityid_craniumbasher,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[5],abilityid_craniumbasher,false)
@@ -21745,73 +22891,79 @@
 elseif GetUnitTypeId(GetTriggerUnit())==unitid_necrounit6 then
 call DamageTarget(GetDyingUnit(),LastWill_FindUnit(GetKillingUnit()),DAMAGE_PURE,600)
 endif
 endif
 return false
 endfunction
 function InitTrig_Last_Will takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterRealUnitEvent(t,EVENT_PLAYER_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function LastWill_Main))
 set t=null
 endfunction
 function Euls_Remove takes nothing returns boolean
 local unit Hero=GetTriggerUnit()
 local integer Level=1
-if FindItemOfTypeEx(Hero,Item_Real[indexid_bootsofspeed],GetManipulatedItem())!=null then
+if FindItemOfTypeEx(Hero,Item_Real[indexid_bootsofspeed],GetManipulatedItem())!=null or FindItemOfType(Hero,Item_Real[indexid_ironboots_disabled])!=null then
 set Level=2
 endif
 if FindItemOfTypeEx(Hero,Item_Real[indexid_phaseboots],GetManipulatedItem())!=null then
 set Level=3
 endif
 if FindItemOfTypeEx(Hero,Item_Real[indexid_powertreadsagility],GetManipulatedItem())!=null or FindItemOfTypeEx(Hero,Item_Real[indexid_powertreadsstrength],GetManipulatedItem())!=null or FindItemOfTypeEx(Hero,Item_Real[indexid_powertreadsintelligence],GetManipulatedItem())!=null then
 set Level=4
 endif
 if FindItemOfTypeEx(Hero,Item_Real[indexid_arcaneboots],GetManipulatedItem())!=null then
 set Level=5
 endif
-if FindItemOfTypeEx(Hero,Item_Real[indexid_bootsoftravel],GetManipulatedItem())!=null then
+if FindItemOfTypeEx(Hero,Item_Real[indexid_ironboots],GetManipulatedItem())!=null then
 set Level=6
 endif
+if FindItemOfTypeEx(Hero,Item_Real[indexid_bootsoftravel],GetManipulatedItem())!=null then
+set Level=7
+endif
 if FindItemOfTypeEx(Hero,Item_Real[indexid_eulsscepterofdivinity],GetManipulatedItem())!=null then
 call UnitAddAbility(Hero,abilityid_eulsmovement)
 call SetUnitAbilityLevel(Hero,abilityid_eulsmovement,Level)
 call UnitMakeAbilityPermanent(Hero,true,abilityid_eulsmovement)
 else
 call UnitRemoveAbility(Hero,abilityid_eulsmovement)
 endif
 set Hero=null
 return false
 endfunction
 function Euls_Add takes nothing returns boolean
 local unit Hero=GetTriggerUnit()
 local integer Level=1
-if FindItemOfType(Hero,Item_Real[indexid_bootsofspeed])!=null then
+if FindItemOfType(Hero,Item_Real[indexid_bootsofspeed])!=null or FindItemOfType(Hero,Item_Real[indexid_ironboots_disabled])!=null then
 set Level=2
 endif
 if FindItemOfType(Hero,Item_Real[indexid_phaseboots])!=null then
 set Level=3
 endif
 if FindItemOfType(Hero,Item_Real[indexid_powertreadsagility])!=null or FindItemOfType(Hero,Item_Real[indexid_powertreadsstrength])!=null or FindItemOfType(Hero,Item_Real[indexid_powertreadsintelligence])!=null then
 set Level=4
 endif
 if FindItemOfType(Hero,Item_Real[indexid_arcaneboots])!=null then
 set Level=5
 endif
-if FindItemOfType(Hero,Item_Real[indexid_bootsoftravel])!=null then
+if FindItemOfTypeEx(Hero,Item_Real[indexid_ironboots],GetManipulatedItem())!=null then
 set Level=6
 endif
+if FindItemOfType(Hero,Item_Real[indexid_bootsoftravel])!=null then
+set Level=7
+endif
 if FindItemOfType(Hero,Item_Real[indexid_eulsscepterofdivinity])!=null then
 call UnitAddAbility(Hero,abilityid_eulsmovement)
 call SetUnitAbilityLevel(Hero,abilityid_eulsmovement,Level)
 call UnitMakeAbilityPermanent(Hero,true,abilityid_eulsmovement)
 endif
 set Hero=null
 return false
 endfunction
 function InitTrig_Euls_Movement takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
 call TriggerAddCondition(t,Condition(function Euls_Add))
 set t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_DROP_ITEM)
 call TriggerAddCondition(t,Condition(function Euls_Remove))
@@ -22244,60 +23396,64 @@
 return unitid_goodcourier4
 elseif r==5 then
 return unitid_goodcourier5
 else
 return unitid_goodcourier6
 endif
 else
 if r==1 then
 return unitid_badcourier1
 elseif r==2 then
 return unitid_badcourier2
 elseif r==3 then
 return unitid_badcourier3
 elseif r==4 then
 return unitid_badcourier4
-else
+elseif r==5 then
 return unitid_badcourier5
+else
+return unitid_badcourier6
 endif
 endif
 return 0
 endfunction
 function SummonCourier_GetCrow takes player p returns integer
 if GetRandomInt(1,3)==1 then
 return unitid_jokecourier3
 elseif IsSent(p)then
 return unitid_goodcourier0
 else
 return unitid_badcourier0
 endif
 return 0
 endfunction
 function SummonCourier_Main takes nothing returns nothing
 local unit chicken=CreateUnit(GetOwningPlayer(GetTriggerUnit()),SummonCourier_GetCourier(GetOwningPlayer(GetTriggerUnit())),GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),GetUnitFacing(GetTriggerUnit()))
 local real x=GetUnitX(GetTriggerUnit())
 local real y=GetUnitY(GetTriggerUnit())
 local real a=GetUnitFacing(GetTriggerUnit())
+call CourierDeath_Register(chicken)
 call SetUnitPosition(chicken,x+25*Cos(a*bj_DEGTORAD),y+25*Sin(a*bj_DEGTORAD))
 if CourierWorker[GetPlayerId(GetOwningPlayer(chicken))]==false then
 call UnitRemoveType(chicken,UNIT_TYPE_PEON)
 else
 call UnitAddType(chicken,UNIT_TYPE_PEON)
 endif
 endfunction
 function SummonCourier_MainCrow takes nothing returns nothing
 local unit chicken=CreateUnit(GetOwningPlayer(GetTriggerUnit()),SummonCourier_GetCrow(GetOwningPlayer(GetTriggerUnit())),GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),GetUnitFacing(GetTriggerUnit()))
+call CourierDeath_Register(chicken)
 if CourierWorker[GetPlayerId(GetOwningPlayer(chicken))]==false then
 call UnitRemoveType(chicken,UNIT_TYPE_PEON)
 else
 call UnitAddType(chicken,UNIT_TYPE_PEON)
 endif
 call RegisterFlyingCourier(chicken)
 endfunction
 function SummonCourier takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_summoncourier then
 call SummonCourier_Main()
 endif
 if GetSpellAbilityId()==abilityid_summoncrow then
 call SummonCourier_MainCrow()
 endif
 return false
@@ -22504,31 +23660,33 @@
 elseif OldId==unitid_badcourier1 then
 set newability=abilityid_morphcarrionbeetletofelboar
 elseif OldId==unitid_badcourier2 then
 set newability=abilityid_morphdunewormtocarrionbeetle
 elseif OldId==unitid_badcourier3 then
 set newability=abilityid_morphfelboartorabit
 elseif OldId==unitid_goodcourier4 then
 set newability=abilityid_morphcrabtoseal
 elseif OldId==unitid_goodcourier5 then
 set newability=abilityid_morphsealtoskink
 elseif OldId==unitid_badcourier4 then
 set newability=abilityid_morphskinktodog
 elseif OldId==unitid_badcourier5 then
 set newability=abilityid_morphdogtoduneworm
 elseif OldId==unitid_goodcourier6 then
-set newability=abilityid_morphrabittochicken
+set newability=abilityid_morphrabittopack
+elseif OldId==unitid_badcourier6 then
+set newability=abilityid_morphpacktochicken
 endif
 if GetRandomInt(1,10)==1 then
 set newability=abilityid_morphminipudge
 endif
 if GetRandomInt(1,10)<3 then
 set newability=abilityid_morphminigrunt
 endif
 if OldId==unitid_jokecourier1 then
 set newability=abilityid_morphminitechies
 elseif OldId==unitid_jokecourier4 then
 set newability=abilityid_morphminitechies
 elseif OldId==unitid_jokecourier2 then
 set newability=abilityid_morphfelboartorabit
 endif
 if OldId==unitid_goodcourier0 then
@@ -22865,50 +24023,64 @@
 call TriggerRegisterTimerEvent(t,0.05,false)
 call TriggerAddCondition(t,Condition(function MorphCrow_Process))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 set t=null
 endfunction
 function MorphCrow_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_morphcrow then
 call MorphCrow(GetTriggerUnit())
 endif
 return false
 endfunction
 function CustomPickUpItems_Main takes nothing returns boolean
 local unit Hero=GetTriggerUnit()
 local item Item=GetManipulatedItem()
 local integer id=GetItemTypeId(Item)
+local integer i
 if(id==Item_Real[indexid_scrolloftownportal]or id==Item_Real[indexid_bootsoftravel])and IsUnitType(Hero,UNIT_TYPE_HERO)==true then
 set TP_Location_X[GetPlayerId(GetOwningPlayer(Hero))]=GetItemX(Item)
 set TP_Location_Y[GetPlayerId(GetOwningPlayer(Hero))]=GetItemY(Item)
 endif
 call RunesPickup(Hero,Item)
 call CloakFix(Hero,Item)
 if(GetItemTypeId(Item)==Item_Real[indexid_armletofmordiggianon]or GetItemTypeId(Item)==Item_Real[indexid_armletofmordiggianoff])and IsCourier(Hero)then
 call UnitRemoveItem(Hero,Item)
+elseif GetItemTypeId(Item)==Item_Real[indexid_magicwand]and IsUnitType(Hero,UNIT_TYPE_HERO)==true then
+set i=(LoadInteger(hash_main,(GetHandleId(Hero)),(750)))
+if i>0 then
+if(LoadBoolean(hash_main,(GetHandleId(Hero)),(751)))==false then
+call SaveBoolean(hash_main,(GetHandleId(Hero)),(751),(true))
+call SetItemCharges(Item,i)
+endif
+endif
 elseif GetItemTypeId(Item)==Item_Real[indexid_aegis]and GetUnitTypeId(Hero)!=1848651852 and AegisMSG_Disabled==false then
 set aegisholder=Hero
 set AegisMSG_Disabled=true
 call Traffic_RegisterData("AegisOn",GetPlayerId(GetOwningPlayer(Hero)))
 call DisplayTimedTextToForceEx(GetPlayersAll(),10.00,udg_Colors[GetPlayerId(GetOwningPlayer(Hero))]+GetUnitName(Hero)+"|r "+GetObjectName(MSG_CARRYINGAEGIS))
 elseif GetItemTypeId(Item)==Item_Real[indexid_recipe_flyingcourier]and IsBasicCourier(Hero)then
 call MorphCrow(Hero)
 elseif GetItemTypeId(Item)==Item_Real[indexid_aghanimsscepterenchantress]and GetUnitTypeId(Hero)==1164799855 then
 call SetPlayerTechResearched(GetOwningPlayer(Hero),1378889802,1)
 elseif GetItemTypeId(Item)==Item_Real[indexid_aghanimssceptermeepo]and GetUnitTypeId(Hero)==1211117641 then
 set tt_unit1=Hero
 call ExecuteFunc("DivdedWeStand_AghanimPickup")
+elseif GetItemTypeId(Item)==Item_Real[indexid_aghanimssceptertiny]and GetUnitTypeId(Hero)==1432580716 then
+call UnitAddAbility(Hero,grow_aghanim_treefix_to)
+call UnitRemoveAbility(Hero,grow_aghanim_treefix_to)
+call AddUnitAnimationProperties(Hero,"upgrade",true)
+call SetPlayerTechResearched(GetOwningPlayer(Hero),1378889803,1)
 endif
 set Hero=null
 set Item=null
 return false
 endfunction
 function InitTrig_Custom_Pick_Up_Item takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_PICKUP_ITEM)
 call TriggerAddCondition(t,Condition(function CustomPickUpItems_Main))
 set t=null
 endfunction
 function Tango_Iterate takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
@@ -23557,31 +24729,33 @@
 call UnitResetCooldown(GetTriggerUnit())
 endif
 endfunction
 function Orchid_Damaged takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local integer TargetIndex=(LoadInteger(hash_main,(Cache),(30)))
 local unit Target=TI_GetUnit(TargetIndex)
 local real Damage=(LoadReal(hash_main,(Cache),(20)))
 if GetTriggerEventId()!=EVENT_UNIT_DAMAGED or GetUnitAbilityLevel(GetTriggerUnit(),abilityid_orchidbuff)==0 then
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
 call TI_ClearUnit(TargetIndex)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
+set amp_allow=true
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,Damage)
+set amp_allow=false
 if Damage>0 then
 call TextTagOnUnitEx("+"+I2S(R2I(Damage)),1,Target,0.023,255,0,0,216)
 endif
 elseif GetEventDamage()>1 then
 call SaveReal(hash_main,(Cache),(20),((Damage+GetEventDamage()*0.25)*1.0))
 endif
 set t=null
 set Source=null
 set Target=null
 return false
 endfunction
 function Orchid_Delayed takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
@@ -23700,31 +24874,33 @@
 endif
 set Crow=null
 endfunction
 function CrowMana_Main takes nothing returns nothing
 if GetSpellAbilityId()==abilityid_crowmana then
 call CrowMana()
 endif
 endfunction
 function ShivasGuard_Damage takes nothing returns nothing
 local unit Target=GetEnumUnit()
 local group AlreadyDamaged=shivasguard_group
 local unit Source=shivasguard_unit
 if IsUnitInGroup(Target,AlreadyDamaged)==false then
 call GroupAddUnit(AlreadyDamaged,Target)
 call IssueTargetOrder(shivasguard_nuker,"slow",Target)
+set amp_allow=true
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,200)
+set amp_allow=false
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\FrostNova\\FrostNovaTarget.mdl",Target,"origin"))
 endif
 set Target=null
 set AlreadyDamaged=null
 set Source=null
 endfunction
 function ShivasGuard_Expire takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
 local group AlreadyDamaged=(LoadGroupHandle(hash_main,(Cache),(133)))
 local real d
 local real x
 local real x0=GetUnitX(Source)
@@ -23779,41 +24955,46 @@
 call SaveUnitHandle(hash_main,(Cache),(132),(Nuker))
 call SaveUnitHandle(hash_main,(Cache),(2),(Hero))
 call TriggerRegisterTimerEvent(t,0.06,true)
 call TriggerAddCondition(t,Condition(function ShivasGuard_Expire))
 set t=null
 set AlreadyDamaged=null
 set Caster=null
 set Nuker=null
 set Hero=null
 endfunction
 function ShivasGuard takes nothing returns nothing
 if GetSpellAbilityId()==abilityid_shivasguarditem then
 call ShivasGuard_Main()
 endif
 endfunction
+function MagicStick_RememberCharges takes unit Source,integer Charges returns nothing
+local integer Cache=GetHandleId(Source)
+call SaveInteger(hash_main,(Cache),(750),(Charges))
+endfunction
 function MagicStick_Cast takes nothing returns nothing
 local integer i=0
 local integer charges=0
 local boolean refilled=false
 if GetSpellAbilityId()==abilityid_magicstick then
 loop
 exitwhen i>5
 if ItemToIndex(UnitItemInSlot(GetTriggerUnit(),i))==indexid_magicstick or ItemToIndex(UnitItemInSlot(GetTriggerUnit(),i))==indexid_magicwand then
 set charges=GetItemCharges(UnitItemInSlot(GetTriggerUnit(),i))
 if charges>0 then
 call SetItemCharges(UnitItemInSlot(GetTriggerUnit(),i),0)
+call MagicStick_RememberCharges(GetTriggerUnit(),0)
 if refilled==false then
 set refilled=true
 call SetUnitState(GetTriggerUnit(),UNIT_STATE_MANA,GetUnitState(GetTriggerUnit(),UNIT_STATE_MANA)+15*charges)
 call SetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE,GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)+15*charges)
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Items\\AIre\\AIreTarget.mdl",GetTriggerUnit(),"origin"))
 endif
 endif
 return
 endif
 set i=i+1
 endloop
 endif
 endfunction
 function MagicStick_IsSpell takes integer id returns boolean
 local integer i=1
@@ -23830,35 +25011,37 @@
 if IsUnitVisible(Enemy,GetOwningPlayer(Source))==false and GetRandomInt(1,100)<10 then
 call PlaySoundOnUnitBJ(gg_snd_CryptFiendPissed2,100,Source)
 endif
 endfunction
 function MagicStick_GiveMana takes nothing returns nothing
 local unit Hero=GetEnumUnit()
 local integer i=0
 loop
 exitwhen i>5
 if IsUnitVisible(GetTriggerUnit(),GetOwningPlayer(GetEnumUnit()))==true then
 if ItemToIndex(UnitItemInSlot(Hero,i))==indexid_magicstick or ItemToIndex(UnitItemInSlot(Hero,i))==indexid_magicwand then
 if ItemToIndex(UnitItemInSlot(Hero,i))==indexid_magicwand then
 if GetItemCharges(UnitItemInSlot(Hero,i))==15 then
 call MagicStick_SpiderSense(GetTriggerUnit(),Hero)
 endif
+call MagicStick_RememberCharges(Hero,IMin(GetItemCharges(UnitItemInSlot(Hero,i))+1,15))
 call SetItemCharges(UnitItemInSlot(Hero,i),IMin(GetItemCharges(UnitItemInSlot(Hero,i))+1,15))
 else
 if GetItemCharges(UnitItemInSlot(Hero,i))==10 then
 call MagicStick_SpiderSense(GetTriggerUnit(),Hero)
 endif
+call MagicStick_RememberCharges(Hero,IMin(GetItemCharges(UnitItemInSlot(Hero,i))+1,10))
 call SetItemCharges(UnitItemInSlot(Hero,i),IMin(GetItemCharges(UnitItemInSlot(Hero,i))+1,10))
 endif
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",Hero,"chest"))
 set i=5
 endif
 endif
 set i=i+1
 endloop
 set Hero=null
 endfunction
 function MagicStick takes nothing returns nothing
 local group g=GetAvailableGroup()
 local unit Source=GetTriggerUnit()
 local real x=GetUnitX(Source)
 local real y=GetUnitY(Source)
@@ -24151,31 +25334,33 @@
 local unit Target=tt_unit2
 local real Damage=(LoadReal(hash_main,(Cache),(20)))
 local trigger t
 if Source!=Target then
 set t=CreateTrigger()
 set Cache=GetHandleId(t)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Target),etherblast_ms,false)
 call UnitAddAbility(Target,etherblast_ms)
 call UnitMakeAbilityPermanent(Target,true,etherblast_ms)
 call TriggerRegisterTimerEvent(t,0.1,true)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function EtherBlast_EndMS))
 call SaveUnitHandle(hash_main,(Cache),(2),(Target))
 call EtherBlast_Add(Target)
 call TextTagOnUnitEx("+"+I2S(R2I(Damage)),2,Target,0.027,3,216,120,216)
+set amp_allow=true
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,Damage)
+set amp_allow=false
 endif
 call EtherBlast_Add(Source)
 set Source=null
 set Target=null
 endfunction
 function EtherBlast takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local unit Target=GetSpellTargetUnit()
 local trigger t2=CreateProjectileToUnit(Source,Target,1747993171,"EtherBlast_Process",1000)
 local integer Cache2=GetHandleId(t2)
 call SaveReal(hash_main,(Cache2),(20),((GetHeroAgi(Source,true)*2.0+75)*1.0))
 set Source=null
 set Target=null
 set t2=null
 endfunction
@@ -24331,32 +25516,34 @@
 endfunction
 function StaffOfHealing_EnemyProcess takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>8 then
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 else
 if GetUnitState(Target,UNIT_STATE_LIFE)>(150.0/8.0+0.5)then
 call SetUnitState(Target,UNIT_STATE_LIFE,GetUnitState(Target,UNIT_STATE_LIFE)-150.0/8.0)
 else
 set safedamage_urn[GetPlayerId(GetOwningPlayer(Target))]=true
+set amp_allow=true
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,50)
 set safedamage_urn[GetPlayerId(GetOwningPlayer(Target))]=false
+set amp_allow=false
 endif
 endif
 set t=null
 set Source=null
 set Target=null
 return false
 endfunction
 function StaffOfHealing_Process takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and(IsCreepId(GetUnitTypeId(GetEventDamageSource()))==false and(GetOwningPlayer(GetEventDamageSource())!=udg_NeutralHostile or GetUnitTypeId(GetEventDamageSource())==1848651852)and GetEventDamage()>0)or damageevent_valid==true)then
 call UnitRemoveAbility(Target,1110459207)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
@@ -24407,31 +25594,31 @@
 else
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveEffectHandle(hash_main,(Cache),(32),(AddSpecialEffectTarget("war3mapImported\\Urn_Enemy.mdx",Target,"overhead")))
 call TriggerRegisterTimerEvent(t,1,true)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function StaffOfHealing_EnemyProcess))
 endif
 endif
 set Source=null
 set Caster=null
 set Target=null
 set t=null
 endfunction
 function StaffOfHealing_Main takes nothing returns nothing
-if GetSpellAbilityId()==abilityid_staffofhealing and(IsPlayerAlly(GetOwningPlayer(GetSpellTargetUnit()),GetOwningPlayer(GetTriggerUnit()))==true or IsBlocked(GetSpellTargetUnit())==false)then
+if GetSpellAbilityId()==abilityid_staffofhealing then
 call StaffOfHealing()
 endif
 endfunction
 function InitTrig_Staff_of_Healing takes nothing returns nothing
 local integer i=0
 loop
 exitwhen i>16
 set safedamage_urn[i]=false
 set i=i+1
 endloop
 endfunction
 function AncientJangoo_Hit takes nothing returns nothing
 if IsRealSummoned(GetEnumUnit())==false then
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),ancientjangoo_boost,false)
 call AddTimedAbilityAndRemove(GetEnumUnit(),ancientjangoo_boost,1,ancientjangoo_duration,ancientjangoo_boost_buffid)
@@ -24455,31 +25642,31 @@
 if GetSpellAbilityId()==abilityid_ancientjangoo then
 call AncientJangoo()
 endif
 endfunction
 function IsFakeHeroBuilding takes unit u returns boolean
 local integer unitid=GetUnitTypeId(u)
 return unitid==1211122232 or unitid==1848657482 or unitid==1848657481 or unitid==1848657462 or unitid==1848657480 or unitid==1966092371
 endfunction
 function SmokeOfDeceit_Find takes nothing returns boolean
 return IsUnitEnemy(GetFilterUnit(),smokeofdeceit_player)and IsDead(GetFilterUnit())==false and(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true or IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==true)and IsFakeHeroBuilding(GetFilterUnit())==false
 endfunction
 function SmokeOfDeceit_IsNearby takes unit Source returns boolean
 local group g=GetAvailableGroup()
 local boolean found
 set smokeofdeceit_player=GetOwningPlayer(Source)
-call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),975,Condition(function SmokeOfDeceit_Find))
+call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),1050,Condition(function SmokeOfDeceit_Find))
 set found=FirstOfGroup(g)!=null
 call KillGroup(g)
 return found
 endfunction
 function SmokeOfDeceit_End takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local group g
 local integer Count
 local boolean RemoveNext
 if GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED then
 if GetAttacker()==Source then
 call UnitRemoveAbility(Source,smokeofdeceit_invis)
 call UnitRemoveAbility(Source,smokeofdeceit_ms)
@@ -24487,31 +25674,31 @@
 call UnitRemoveAbility(Source,smokeofdeceit_phasebuff)
 if((LoadInteger(hash_main,(GetHandleId((Source))),((4302))))==HERO_STATE_ON)==false then
 call UnitSetUsesAltIcon(Source,false)
 endif
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 endif
 else
 set RemoveNext=(LoadBoolean(hash_main,(Cache),(671)))
 set Count=(LoadInteger(hash_main,(Cache),(34)))
 set Count=Count+1
 call SaveInteger(hash_main,(Cache),(34),(Count))
 set g=GetAvailableGroup()
 set smokeofdeceit_player=GetOwningPlayer(Source)
-call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),975,Condition(function SmokeOfDeceit_Find))
+call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),1050,Condition(function SmokeOfDeceit_Find))
 if GetUnitAbilityLevel(Source,1110456665)>0 then
 call SaveBoolean(hash_main,(Cache),(671),(true))
 elseif RemoveNext then
 call SaveBoolean(hash_main,(Cache),(671),(false))
 call UnitRemoveAbility(Source,smokeofdeceit_invis)
 call UnitAddAbility2(Source,smokeofdeceit_invis)
 endif
 if Count>400 or FirstOfGroup(g)!=null then
 call UnitRemoveAbility(Source,smokeofdeceit_invis)
 call UnitRemoveAbility(Source,smokeofdeceit_ms)
 call UnitRemoveAbility(Source,smokeofdeceit_buffid)
 call UnitRemoveAbility(Source,smokeofdeceit_phasebuff)
 if((LoadInteger(hash_main,(GetHandleId((Source))),((4302))))==HERO_STATE_ON)==false then
 call UnitSetUsesAltIcon(Source,false)
 endif
@@ -24580,90 +25767,245 @@
 local group g=GetAvailableGroup()
 local real x=GetSpellTargetX()
 local real y=GetSpellTargetY()
 call GroupEnumUnitsInRange(g,x,y,525,Condition(function GenericCondition_EnemyUnits))
 call ForGroup(g,function VeilOfDiscord_Hit)
 call KillGroup(g)
 call DestroyEffect(AddSpecialEffect(veilofdiscord_fx,x,y))
 set Source=null
 set g=null
 endfunction
 function VeilOfDiscord_Main takes nothing returns nothing
 if GetSpellAbilityId()==abilityid_veilofdiscord then
 call VeilOfDiscord()
 endif
 endfunction
-function Corruptor_Spawn takes unit Source,integer uid,real x,real y returns nothing
-local unit Treant=CreateUnit(GetOwningPlayer(Source),uid,x,y,0)
-call UnitApplyTimedLife(Treant,1112820806,15)
-set Treant=null
-endfunction
-function Corruptor_Main takes nothing returns nothing
-local unit Treant
-local real x
-local real y
-if GetSpellAbilityId()==abilityid_corruptor then
-set x=GetDestructableX(GetSpellTargetDestructable())
-set y=GetDestructableY(GetSpellTargetDestructable())
-call Corruptor_Spawn(GetTriggerUnit(),unitid_corruptor,x,y)
-elseif GetSpellAbilityId()==abilityid_corruptor_ranged then
-set x=GetDestructableX(GetSpellTargetDestructable())
-set y=GetDestructableY(GetSpellTargetDestructable())
-call Corruptor_Spawn(GetTriggerUnit(),unitid_corruptor_ranged,x,y)
-endif
-set Treant=null
-endfunction
-function MedallionOfCourage_Armor takes nothing returns boolean
+function CripplingStaff_Remove takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
-local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
-call UnitRemoveAbility(Source,medallion_armor)
-call UnitRemoveAbility(Target,medallion_armor)
-call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(175))))
-call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(176))))
+local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
+local real EndTime=(LoadReal(hash_main,(GetHandleId(Target)),(745)))
+if GetTriggerEventId()==EVENT_WIDGET_DEATH or(TimerGetElapsed(udg_GameTimer))>EndTime then
+call UnitRemoveAbility(Target,cripplingstaff_miss_buffid)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
+elseif GetUnitAbilityLevel(Target,cripplingstaff_miss_buffid)==0 then
+call IssueTargetOrder(Caster,"curse",Target)
+endif
 set t=null
-set Source=null
 set Target=null
+set Caster=null
 return false
 endfunction
-function MedallionOfCourage takes nothing returns nothing
-local trigger t=CreateTrigger()
-local integer Cache=GetHandleId(t)
-call TriggerRegisterTimerEvent(t,7,false)
-call TriggerAddCondition(t,Condition(function MedallionOfCourage_Armor))
-call SaveUnitHandle(hash_main,(Cache),(2),(GetTriggerUnit()))
-call SaveUnitHandle(hash_main,(Cache),(17),(GetSpellTargetUnit()))
-call SaveEffectHandle(hash_main,(Cache),(175),(AddSpecialEffectTarget(medallion_fx,GetSpellTargetUnit(),"chest")))
-call SaveEffectHandle(hash_main,(Cache),(176),(AddSpecialEffectTarget(medallion_fx,GetTriggerUnit(),"chest")))
-call UnitAddAbility(GetTriggerUnit(),medallion_armor)
-call UnitAddAbility(GetSpellTargetUnit(),medallion_armor)
-call UnitMakeAbilityPermanent(GetTriggerUnit(),true,medallion_armor)
-call UnitMakeAbilityPermanent(GetSpellTargetUnit(),true,medallion_armor)
-set t=null
-endfunction
-function MedallionOfCourage_Main takes nothing returns nothing
-if GetSpellAbilityId()==abilityid_medallion_of_courage and IsBlocked(GetSpellTargetUnit())==false then
-call MedallionOfCourage()
+function CripplingStaff takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local unit Target=GetSpellTargetUnit()
+local unit Caster=CreateUnit(GetOwningPlayer(Target),1697656901,GetUnitX(Target),GetUnitY(Target),0)
+local real d=cripplingstaff_duration
+local trigger t
+local integer Cache
+if IsMagicImmune(Target)==false then
+call UnitAddAbility2(Caster,cripplingstaff_miss)
+call IssueTargetOrder(Caster,"curse",Target)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Target),cripplingstaff_slow,false)
+call AddTimedAbilityAndRemove(Target,cripplingstaff_slow,1,d,cripplingstaff_slow_buffid)
+else
+call UnitAddAbility2(Caster,cripplingstaff_miss)
+call SetUnitAbilityLevel(Caster,cripplingstaff_miss,2)
+call IssueTargetOrder(Caster,"curse",Target)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Target),cripplingstaff_slow,false)
+call AddTimedAbilityAndRemove(Target,cripplingstaff_slow,1,d,cripplingstaff_slow_buffid)
 endif
+set t=CreateTrigger()
+set Cache=GetHandleId(t)
+call TriggerRegisterTimerEvent(t,0.01,true)
+call TriggerRegisterDeathEvent(t,Target)
+call TriggerAddCondition(t,Condition(function CripplingStaff_Remove))
+call SaveUnitHandle(hash_main,(Cache),(17),(Target))
+call SaveUnitHandle(hash_main,(Cache),(19),(Caster))
+call SaveReal(hash_main,(GetHandleId(Target)),(745),(((TimerGetElapsed(udg_GameTimer))+d)*1.0))
+set Source=null
+set Target=null
+set Caster=null
+set t=null
 endfunction
-function Regeneration_SelfClick takes nothing returns nothing
-local unit whichUnit=GetTriggerUnit()
+function CripplingStaff_This takes nothing returns nothing
+local unit Source=GetTriggerUnit()
 local unit Target=GetSpellTargetUnit()
-local unit Caster
+local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
+call UnitAddAbility(Caster,1093815091)
+call IssueTargetOrder(Caster,"slow",Target)
+set Source=null
+set Target=null
+set Caster=null
+endfunction
+function CripplingStaff_Main takes nothing returns nothing
+if GetSpellAbilityId()==abilityid_cripplingstaff and IsBlocked(GetSpellTargetUnit())==false then
+call CripplingStaff_This()
+endif
+endfunction
+function TranquilBoots_Heal takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+local integer Count=(LoadInteger(hash_main,(Cache),(34)))
+if GetTriggerEventId()==EVENT_WIDGET_DEATH or Count==10 or(GetTriggerEventId()==EVENT_UNIT_DAMAGED and GetEventDamage()>20)then
+call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+elseif GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
+set Count=Count+1
+call SaveInteger(hash_main,(Cache),(34),(Count))
+call SetUnitState(Source,UNIT_STATE_LIFE,GetUnitState(Source,UNIT_STATE_LIFE)+15)
+endif
+set t=null
+set Source=null
+return false
+endfunction
+function TranquilBoots takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local trigger t=CreateTrigger()
+local integer Cache=GetHandleId(t)
+call TriggerRegisterTimerEvent(t,1,true)
+call TriggerRegisterDeathEvent(t,Source)
+call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DAMAGED)
+call TriggerAddCondition(t,Condition(function TranquilBoots_Heal))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+call SaveInteger(hash_main,(Cache),(34),(0))
+call SaveEffectHandle(hash_main,(Cache),(32),(AddSpecialEffectTarget("war3mapImported\\TranquilBootsHeal.mdx",Source,"origin")))
+set Source=null
+set t=null
+endfunction
+function TranquilBoots_Main takes nothing returns nothing
+if GetSpellAbilityId()==abilityid_tranquilboots then
+call TranquilBoots()
+endif
+endfunction
+function Prudence takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local unit Target=GetSpellTargetUnit()
+local unit Caster=CreateUnit(GetOwningPlayer(Target),1697656901,GetUnitX(Target),GetUnitY(Target),0)
+local integer Level=2
+if IsUnitType(Target,UNIT_TYPE_MELEE_ATTACKER)==true then
+set Level=1
+endif
+call UnitAddAbility(Caster,1093815093)
+call SetUnitAbilityLevel(Caster,1093815093,Level)
+call IssueTargetOrder(Caster,"drunkenhaze",Target)
+set Source=null
+set Target=null
+set Caster=null
+endfunction
+function Prudence_Main takes nothing returns nothing
+if GetSpellAbilityId()==1093815092 and IsBlocked(GetSpellTargetUnit())==false then
+call Prudence()
+endif
+endfunction
+function Dagon takes integer Level,unit Source,unit Target returns nothing
+set amp_allow=true
+call DamageTarget(Source,Target,DAMAGE_MAGICAL,300+100*Level)
+set amp_allow=false
+endfunction
+function Dagon_Main takes nothing returns nothing
+local integer DagonLevel=0
+if GetSpellAbilityId()==1093677647 then
+set DagonLevel=1
+endif
+if GetSpellAbilityId()==1093679193 then
+set DagonLevel=2
+endif
+if GetSpellAbilityId()==1093679194 then
+set DagonLevel=3
+endif
+if GetSpellAbilityId()==1093679408 then
+set DagonLevel=4
+endif
+if GetSpellAbilityId()==1093679410 then
+set DagonLevel=5
+endif
+if DagonLevel>0 and IsBlocked(GetSpellTargetUnit())==false then
+call Dagon(DagonLevel,GetTriggerUnit(),GetSpellTargetUnit())
+endif
+endfunction
+function BladeOfTheReaper_Main takes nothing returns nothing
+if GetSpellAbilityId()==1093814353 then
+call BladeOfTheReaper_SpawnIllusion(GetTriggerUnit(),GetSpellTargetUnit())
+endif
+endfunction
+function Corruptor_Spawn takes unit Source,integer uid,real x,real y returns nothing
+local unit Treant=CreateUnit(GetOwningPlayer(Source),uid,x,y,0)
+call UnitApplyTimedLife(Treant,1112820806,15)
+set Treant=null
+endfunction
+function Corruptor_Main takes nothing returns nothing
+local unit Treant
+local real x
+local real y
+if GetSpellAbilityId()==abilityid_corruptor then
+set x=GetDestructableX(GetSpellTargetDestructable())
+set y=GetDestructableY(GetSpellTargetDestructable())
+call Corruptor_Spawn(GetTriggerUnit(),unitid_corruptor,x,y)
+elseif GetSpellAbilityId()==abilityid_corruptor_ranged then
+set x=GetDestructableX(GetSpellTargetDestructable())
+set y=GetDestructableY(GetSpellTargetDestructable())
+call Corruptor_Spawn(GetTriggerUnit(),unitid_corruptor_ranged,x,y)
+endif
+set Treant=null
+endfunction
+function MedallionOfCourage_Armor takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
+call UnitRemoveAbility(Source,medallion_armor)
+call UnitRemoveAbility(Target,medallion_armor)
+call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(175))))
+call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(176))))
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+set t=null
+set Source=null
+set Target=null
+return false
+endfunction
+function MedallionOfCourage takes nothing returns nothing
+local trigger t
+local integer Cache
+set t=CreateTrigger()
+set Cache=GetHandleId(t)
+call TriggerRegisterTimerEvent(t,7,false)
+call TriggerAddCondition(t,Condition(function MedallionOfCourage_Armor))
+call SaveUnitHandle(hash_main,(Cache),(2),(GetTriggerUnit()))
+call SaveUnitHandle(hash_main,(Cache),(17),(GetSpellTargetUnit()))
+call SaveEffectHandle(hash_main,(Cache),(175),(AddSpecialEffectTarget(medallion_fx,GetSpellTargetUnit(),"chest")))
+call SaveEffectHandle(hash_main,(Cache),(176),(AddSpecialEffectTarget(medallion_fx,GetTriggerUnit(),"chest")))
+call UnitAddAbility(GetTriggerUnit(),medallion_armor)
+call UnitAddAbility(GetSpellTargetUnit(),medallion_armor)
+call UnitMakeAbilityPermanent(GetTriggerUnit(),true,medallion_armor)
+call UnitMakeAbilityPermanent(GetSpellTargetUnit(),true,medallion_armor)
+set t=null
+endfunction
+function MedallionOfCourage_Main takes nothing returns nothing
+if GetSpellAbilityId()==abilityid_medallion_of_courage then
+call MedallionOfCourage()
+endif
+endfunction
+function Regeneration_SelfClick takes nothing returns nothing
+local unit whichUnit=GetTriggerUnit()
+local unit Target=GetSpellTargetUnit()
+local unit Caster
 if GetSpellTargetUnit()==null then
 if GetSpellAbilityId()==1095331948 then
 set Caster=CreateUnit(GetOwningPlayer(whichUnit),1697656901,GetUnitX(whichUnit),GetUnitY(whichUnit),0)
 call UnitAddAbility(Caster,1093752641)
 call IssueTargetOrderById(Caster,852609,whichUnit)
 set Caster=null
 elseif GetSpellAbilityId()==1095331954 then
 set Caster=CreateUnit(GetOwningPlayer(whichUnit),1697656901,GetUnitX(whichUnit),GetUnitY(whichUnit),0)
 call UnitAddAbility(Caster,1095331954)
 call IssueTargetOrderById(Caster,852609,whichUnit)
 set Caster=null
 endif
 endif
 set whichUnit=null
 set Target=null
@@ -24815,30 +26157,38 @@
 call MorphCrow_Main()
 call PipeOfInsight_Main()
 call MantaStyle_Spell()
 call StaffOfHealing_Main()
 call SoulRing_Main()
 call EtherBlast_Main()
 call Euls_Main()
 call ArcaneBoots_Main()
 call HandOfMidas_Main()
 call Regeneration_SelfClick_Main()
 call MedallionOfCourage_Main()
 call Corruptor_Main()
 call AncientJangoo_Main()
 call SmokeOfDeceit_Main()
 call VeilOfDiscord_Main()
+call CripplingStaff_Main()
+call BladeOfTheReaper_Main()
+call Dagon_Main()
+call TranquilBoots_Main()
+call Prudence_Main()
+if GetSpellAbilityId()==1093815095 and IsBlocked(GetSpellTargetUnit())==false then
+call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\LevelerStunFX.mdx",GetSpellTargetUnit(),"head"))
+endif
 return false
 endfunction
 function InitTrig_Cast_Item takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function CastItem_Main))
 call SetPlayerAbilityAvailable(udg_SentPlayers[1],1093752406,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[2],1093752406,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[3],1093752406,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[4],1093752406,false)
 call SetPlayerAbilityAvailable(udg_SentPlayers[5],1093752406,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[1],1093752406,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[2],1093752406,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[3],1093752406,false)
 call SetPlayerAbilityAvailable(udg_ScourgePlayers[4],1093752406,false)
@@ -25006,30 +26356,45 @@
 if indexId==indexid_ringofbasilius then
 set slot=GetItemSlot(whichUnit,whichItem)
 set tt_player1=GetItemPlayer(GetManipulatedItem())
 call RemoveItem(whichItem)
 set tt_item1=SafeUnitAddItemToSlotById(whichUnit,Item_Real[indexid_ringofbasiliusheroes],slot)
 call SetItemPlayer(tt_item1,tt_player1,false)
 call SetItemUserData(tt_item1,1)
 elseif indexId==indexid_ringofbasiliusheroes then
 set slot=GetItemSlot(whichUnit,whichItem)
 set tt_player1=GetItemPlayer(GetManipulatedItem())
 call RemoveItem(whichItem)
 set tt_item1=SafeUnitAddItemToSlotById(whichUnit,Item_Real[indexid_ringofbasilius],slot)
 call SetItemPlayer(tt_item1,tt_player1,false)
 call SetItemUserData(tt_item1,1)
 endif
+if indexId==indexid_ringofaquila then
+set slot=GetItemSlot(whichUnit,whichItem)
+set tt_player1=GetItemPlayer(GetManipulatedItem())
+call RemoveItem(whichItem)
+set tt_item1=SafeUnitAddItemToSlotById(whichUnit,Item_Real[indexid_ringofaquilaheroes],slot)
+call SetItemPlayer(tt_item1,tt_player1,false)
+call SetItemUserData(tt_item1,1)
+elseif indexId==indexid_ringofaquilaheroes then
+set slot=GetItemSlot(whichUnit,whichItem)
+set tt_player1=GetItemPlayer(GetManipulatedItem())
+call RemoveItem(whichItem)
+set tt_item1=SafeUnitAddItemToSlotById(whichUnit,Item_Real[indexid_ringofaquila],slot)
+call SetItemPlayer(tt_item1,tt_player1,false)
+call SetItemUserData(tt_item1,1)
+endif
 if indexId==indexid_monkeykingbar then
 set slot=GetItemSlot(whichUnit,whichItem)
 set tt_player1=GetItemPlayer(GetManipulatedItem())
 call RemoveItem(whichItem)
 set tt_item1=SafeUnitAddItemToSlotById(whichUnit,Item_Real[indexid_monkeykingbaroff],slot)
 call SetItemPlayer(tt_item1,tt_player1,false)
 call SetItemUserData(tt_item1,1)
 elseif indexId==indexid_monkeykingbaroff then
 set slot=GetItemSlot(whichUnit,whichItem)
 set tt_player1=GetItemPlayer(GetManipulatedItem())
 call RemoveItem(whichItem)
 set tt_item1=SafeUnitAddItemToSlotById(whichUnit,Item_Real[indexid_monkeykingbar],slot)
 call SetItemPlayer(tt_item1,tt_player1,false)
 call SetItemUserData(tt_item1,1)
 endif
@@ -30617,38 +31982,39 @@
 if(IsUnitAlly(Hero,GetLocalPlayer())and GetLocalPlayer()!=GetOwningPlayer(Hero))or(udg_ObserverMode and(GetLocalPlayer()==udg_Observer1 or GetLocalPlayer()==udg_Observer2))then
 call PingMinimapEx(x,y,3,255,255,255,false)
 endif
 set Hero=null
 set l=null
 endfunction
 function TeleportationEffect_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_bootsoftravel then
 call TeleportationEffect()
 endif
 return false
 endfunction
 function InitTrig_Teleportation_Effect takes nothing returns nothing
 endfunction
 function RestrictHeroes takes nothing returns nothing
-call TechHeroForAll(1214344551)
-call TechHeroForAll(1328558406)
-call TechHeroForAll(1160786506)
-call TechHeroForAll(1164277353)
 call TechHeroForAll(1160786502)
-call TechHeroForAll(1160786505)
-call TechHeroForAll(1160786520)
 call TechHeroForAll(1311780946)
+call TechHeroForAll(1160786520)
+call TechHeroForAll(1328558406)
+call TechHeroForAll(1160786506)
+call TechHeroForAll(1311788336)
+call TechHeroForAll(1160786738)
+call TechHeroForAll(1160786507)
+call TechHeroForAll(1211122767)
 endfunction
 function KillCourier_Sent takes nothing returns nothing
 if IsCourier(GetEnumUnit())and IsUnitAlly(GetEnumUnit(),udg_SentPlayers[0])==false and GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)>0.5 then
 call UnitRemoveAbility(GetEnumUnit(),1110456392)
 call DamageTarget(SentinelBuilding_Well,GetEnumUnit(),DAMAGE_PHYSICAL,500)
 endif
 endfunction
 function KillCourier_Scourge takes nothing returns nothing
 if IsCourier(GetEnumUnit())and IsUnitAlly(GetEnumUnit(),udg_ScourgePlayers[0])==false and GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)>0.5 then
 call UnitRemoveAbility(GetEnumUnit(),1110456392)
 call DamageTarget(ScourgeBuilding_Well,GetEnumUnit(),DAMAGE_PHYSICAL,500)
 endif
 endfunction
 function KillCourier takes nothing returns boolean
 local group g=GetAvailableGroup()
@@ -30856,51 +32222,51 @@
 call TriggerAddAction(gt_scourgewin,function EndGameCode_Scourge)
 endfunction
 function AntiTK_Percent takes real value returns boolean
 return(100*GetUnitState(GetTriggerUnit(),UNIT_STATE_LIFE)/GetUnitState(GetTriggerUnit(),UNIT_STATE_MAX_LIFE))<value
 endfunction
 function AntiTK_Building takes nothing returns boolean
 return AntiTK_Percent(10)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitTypeId(GetTriggerUnit())!=1702129516 and GetUnitTypeId(GetTriggerUnit())!=1970172012
 endfunction
 function AntiTK_Hero takes nothing returns boolean
 return AntiTK_Percent(25)and(GetUnitAbilityLevel(GetTriggerUnit(),1112433775)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1111847784)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110454321)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110458705)>0 or GetUnitAbilityLevel(GetTriggerUnit(),buffid_shadowword_damage)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455620)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455629)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455630)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455631)>0)
 endfunction
 function AntiTK_Creep takes nothing returns boolean
 return AntiTK_Percent(50)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==false and(IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false or GetUnitTypeId(GetTriggerUnit())==1700946284 or GetUnitTypeId(GetTriggerUnit())==1697657398 or GetUnitTypeId(GetTriggerUnit())==1970107511 or GetUnitTypeId(GetTriggerUnit())==1966092370)
 endfunction
 function AntiTK_Exception takes nothing returns boolean
-return GetUnitTypeId(GetTriggerUnit())==1966092371
+return GetUnitTypeId(GetTriggerUnit())==1966092371 or GetUnitTypeId(GetTriggerUnit())==1865429334
 endfunction
 function AntiTK_Main takes nothing returns nothing
-if not((AntiTK_Percent(10)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitTypeId(GetTriggerUnit())!=1702129516 and GetUnitTypeId(GetTriggerUnit())!=1970172012)or(AntiTK_Percent(25)and(GetUnitAbilityLevel(GetTriggerUnit(),1112433775)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1111847784)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110454321)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110458705)>0 or GetUnitAbilityLevel(GetTriggerUnit(),buffid_shadowword_damage)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455620)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455629)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455630)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455631)>0))or(AntiTK_Percent(50)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==false and(IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false or GetUnitTypeId(GetTriggerUnit())==1700946284 or GetUnitTypeId(GetTriggerUnit())==1697657398 or GetUnitTypeId(GetTriggerUnit())==1970107511 or GetUnitTypeId(GetTriggerUnit())==1966092370))or(GetUnitTypeId(GetTriggerUnit())==1966092371))then
+if not((AntiTK_Percent(10)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==true and GetUnitTypeId(GetTriggerUnit())!=1702129516 and GetUnitTypeId(GetTriggerUnit())!=1970172012)or(AntiTK_Percent(25)and(GetUnitAbilityLevel(GetTriggerUnit(),1112433775)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1111847784)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110454321)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110458705)>0 or GetUnitAbilityLevel(GetTriggerUnit(),buffid_shadowword_damage)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455620)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455629)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455630)>0 or GetUnitAbilityLevel(GetTriggerUnit(),1110455631)>0))or(AntiTK_Percent(50)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==false and(IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false or GetUnitTypeId(GetTriggerUnit())==1700946284 or GetUnitTypeId(GetTriggerUnit())==1697657398 or GetUnitTypeId(GetTriggerUnit())==1970107511 or GetUnitTypeId(GetTriggerUnit())==1966092370))or(GetUnitTypeId(GetTriggerUnit())==1966092371 or GetUnitTypeId(GetTriggerUnit())==1865429334))then
 call IssueImmediateOrder(GetAttacker(),"stop")
 endif
 endfunction
 function AntiTK takes nothing returns boolean
 if IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))then
 call AntiTK_Main()
 elseif IsUnitType(GetAttacker(),UNIT_TYPE_HERO)==true or IsSpiritBear(GetAttacker())then
 set antitk_playerid=GetPlayerId(GetOwningPlayer(GetAttacker()))
 if HasItem_Javelin[antitk_playerid]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and GetUnitTypeId(GetTriggerUnit())!=1848651852 and IsUnitIllusion(GetAttacker())==false and UnitHasItemOfType(GetAttacker(),Item_Real[indexid_javelin])==true then
 call Javelin()
 endif
-if HasItem_CraniumBasher[antitk_playerid]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and UnitHasItemOfType(GetAttacker(),Item_Real[indexid_craniumbasher])==true then
+if HasItem_CraniumBasher[antitk_playerid]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and(UnitHasItemOfType(GetAttacker(),Item_Real[indexid_craniumbasher])==true or UnitHasItemOfType(GetAttacker(),Item_Real[indexid_annihilator])==true)then
 call CraniumBasher_Main()
 endif
 if HasItem_SangeAndYasha[antitk_playerid]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and UnitHasItemOfType(GetAttacker(),Item_Real[indexid_sangeandyasha])==true then
 call SangeAndYasha_Main()
-elseif HasItem_Sange[antitk_playerid]>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and UnitHasItemOfType(GetAttacker(),Item_Real[indexid_sange])==true then
+elseif(HasItem_Sange[antitk_playerid]>0 or HasItem_Prudence[antitk_playerid]>0)and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitIllusion(GetAttacker())==false and(UnitHasItemOfType(GetAttacker(),Item_Real[indexid_sange])==true or UnitHasItemOfType(GetAttacker(),Item_Real[indexid_prudence])==true)then
 call Sange_Main()
 endif
 elseif GetUnitAbilityLevel(GetAttacker(),1093744467)>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false then
 call SiegeAI()
 endif
 return false
 endfunction
 function InitTrig_AntiTK takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_ATTACKED)
 call TriggerAddCondition(t,Condition(function AntiTK))
 set t=null
 endfunction
 function UnitDeath_Action takes nothing returns nothing
 call ChickenDeath()
@@ -34600,31 +35968,33 @@
 set CustomWater[9]=false
 set CustomWater[10]=false
 set CustomWater[11]=false
 set CustomWater[12]=false
 set CustomWater[13]=false
 set CustomWater[14]=false
 endfunction
 function Command_ItemSwap takes nothing returns nothing
 call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,udg_TextY,15.00,"This command has been temporarily disabled")
 endfunction
 function Command_Bonus takes nothing returns boolean
 call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,udg_TextY,10.00,"Total Bonus XP/Gold: "+I2S(Bonus_XP[GetPlayerId(GetTriggerPlayer())])+"/"+I2S(Bonus_Gold[GetPlayerId(GetTriggerPlayer())]))
 return false
 endfunction
 function Command_Bounty takes nothing returns boolean
+if bounty_totalgold>0 then
 call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,udg_TextY,10.00,GetObjectName(1848659023)+": "+I2S(bounty_totalgold))
+endif
 return false
 endfunction
 function Quote_ReplaySound takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local integer x=(LoadInteger(hash_main,(Cache),(148)))
 local player p=(LoadPlayerHandle(hash_main,(Cache),(54)))
 call SoundForPlayer(p,Quote_Options[x])
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 set t=null
 set p=null
 return false
 endfunction
 function Command_Quote takes nothing returns nothing
@@ -35334,30 +36704,36 @@
 endif
 endif
 endfunction
 function Command_NoSwitch takes nothing returns nothing
 if udg_Elapsed15==false and switch_enabled and GetTriggerPlayer()==udg_Host then
 set switch_enabled=false
 call DisplayTimedTextToPlayer(GetLocalPlayer(),0,0,10,GetObjectName(MSG_SWITCH_15))
 endif
 endfunction
 function Command_Sleep takes nothing returns nothing
 call SetUnitAnimation(udg_Hero[GetPlayerId(GetTriggerPlayer())],"sleep")
 endfunction
 function Command_Calm takes nothing returns nothing
 call SetUnitAnimationByIndex(udg_Hero[GetPlayerId(GetTriggerPlayer())],23)
 endfunction
+function Command_NoHat takes nothing returns nothing
+if udg_Hero[GetPlayerId(GetTriggerPlayer())]!=null then
+set nohat_setting[GetPlayerId(GetTriggerPlayer())]=1
+call UnitRemoveAbility(udg_Hero[GetPlayerId(GetTriggerPlayer())],1093815114)
+endif
+endfunction
 function Command_Tips takes nothing returns nothing
 if tips_enabled[GetPlayerId(GetTriggerPlayer())]==false then
 set tips_enabled[GetPlayerId(GetTriggerPlayer())]=true
 if GetObjectName(1848657992)=="Language: English"then
 call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"You have activated the -tips system.")
 call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,0,10,"Please remember that these are just introductory recommendations and are not the only way to play heroes.")
 endif
 if udg_Hero[GetPlayerId(GetTriggerPlayer())]!=null then
 call InitiateTips(GetTriggerPlayer(),GetUnitPointValue(udg_Hero[GetPlayerId(GetTriggerPlayer())]))
 endif
 endif
 endfunction
 function InitTrig_Tips takes nothing returns nothing
 set tips_enabled[0]=false
 set tips_enabled[1]=false
@@ -42922,50 +44298,51 @@
 set Target=null
 return false
 endfunction
 function Rum_Phase1 takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 local player p=(LoadPlayerHandle(hash_main,(Cache),(54)))
 local trigger Phase2=(LoadTriggerHandle(hash_main,(Cache),(135)))
 local integer Index=GetTriggerEvalCount(t)
 if GetTriggerEventId()!=EVENT_UNIT_DAMAGED then
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 call TriggerRegisterTimerEvent(Phase2,1,true)
 call TriggerAddCondition(Phase2,Condition(function Rum_Phase2))
+call UnitRemoveAbility(Target,buffid_rum_ms)
 else
 set Cache=GetHandleId(Phase2)
 call SetUnitState(Target,UNIT_STATE_LIFE,GetUnitState(Target,UNIT_STATE_LIFE)+0.5*GetEventDamage())
 call SavePlayerHandle(hash_main,(Cache),(1300+Index),(GetOwningPlayer(GetEventDamageSource())))
 call SaveReal(hash_main,(Cache),(1200+Index),((0.5*GetEventDamage())*1.0))
 call SaveInteger(hash_main,(Cache),(136),(Index))
 endif
 set t=null
 set Target=null
 set p=null
 set Phase2=null
 return false
 endfunction
 function GhostShip_Hit takes nothing returns nothing
 local unit Source=ghostship_source
 local unit Target=GetEnumUnit()
 local integer Level=ghostship_level
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
-local integer Duration=4+Level
+local integer Duration=8
 local trigger Phase2=CreateTrigger()
 call AddTimedAbility(Target,rum_bonus,1,Duration)
 call UnitMakeAbilityPermanent(Target,true,rum_bonus)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Target),rum_bonus,false)
 call TriggerRegisterTimerEvent(t,Duration+0.01,false)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DAMAGED)
 call TriggerAddCondition(t,Condition(function Rum_Phase1))
 call SavePlayerHandle(hash_main,(Cache),(54),(GetOwningPlayer(Source)))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 call SaveTriggerHandle(hash_main,(Cache),(135),(Phase2))
 call SaveUnitHandle(hash_main,(GetHandleId(Phase2)),(17),(Target))
 call SaveInteger(hash_main,(GetHandleId(Phase2)),(188),(Duration))
 set Source=null
 set Target=null
 set t=null
@@ -43055,46 +44432,50 @@
 local real SourceY=GetUnitY(Hero)
 local location l=GetSpellTargetLoc()
 local real x0=GetLocationX(l)
 local real y0=GetLocationY(l)
 local real Angle
 local real x1
 local real y1
 local real x2
 local real y2
 local trigger t
 local integer Cache
 local integer Level
 local unit Projectile
 local unit Projectile2
 local string s=""
+local integer shipid=unitid_ghostship
+if GetRandomInt(0,5)==0 then
+set shipid=unitid_ghostship_alt
+endif
 if IsPlayerAlly(GetOwningPlayer(Hero),GetLocalPlayer())or IsObserver(GetLocalPlayer())then
 set s="war3mapImported\\Whirlpool.mdx"
 endif
 if x0==GetUnitX(Hero)and y0==GetUnitY(Hero)then
 set x0=x0+50*Cos(GetUnitFacing(Hero)*bj_DEGTORAD)
 set y0=y0+50*Sin(GetUnitFacing(Hero)*bj_DEGTORAD)
 endif
 set Angle=Atan2(y0-SourceY,x0-SourceX)
 set x1=SourceX-1000*Cos(Angle)
 set y1=SourceY-1000*Sin(Angle)
 set x2=SourceX+1000*Cos(Angle)
 set y2=SourceY+1000*Sin(Angle)
 set t=CreateTrigger()
 set Cache=GetHandleId(t)
 set Level=GetUnitAbilityLevel(Hero,abilityid_ghostship)
-set Projectile=CreateUnit(GetOwningPlayer(Hero),unitid_ghostship,x1,y1,Atan2(y0-SourceY,x0-SourceX)*bj_RADTODEG)
+set Projectile=CreateUnit(GetOwningPlayer(Hero),shipid,x1,y1,Atan2(y0-SourceY,x0-SourceX)*bj_RADTODEG)
 set Projectile2=CreateUnit(GetOwningPlayer(Hero),unitid_ghostship2,x1,y1,Atan2(y0-SourceY,x0-SourceX)*bj_RADTODEG)
 call SetUnitVertexColor(Projectile,255,255,255,0)
 call SetUnitPathing(Projectile,false)
 call RemoveLocation(l)
 call SaveInteger(hash_main,(Cache),(5),(Level))
 call SaveReal(hash_main,(Cache),(13),((Angle)*1.0))
 call SaveUnitHandle(hash_main,(Cache),(45),(Projectile))
 call SaveUnitHandle(hash_main,(Cache),(186),(Projectile2))
 call SaveReal(hash_main,(Cache),(66),((x1)*1.0))
 call SaveReal(hash_main,(Cache),(67),((y1)*1.0))
 call SaveGroupHandle(hash_main,(Cache),(187),(GetAvailableGroup()))
 call DestroyEffect(AddSpecialEffect(s,SafeX(x2),SafeY(y2)))
 call TriggerRegisterTimerEvent(t,0.02,true)
 call TriggerAddCondition(t,Condition(function GhostShip_Move))
 set Hero=null
@@ -43343,31 +44724,31 @@
 local unit u=(LoadUnitHandle(hash_main,(Cache),(26)))
 call SaveInteger(hash_main,(GetHandleId(u)),(27),((LoadInteger(hash_main,(GetHandleId(u)),(27)))-1))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 set u=null
 set t=null
 return false
 endfunction
 function GoblinsGreed_Action takes nothing returns nothing
 local unit UnitVar=GetKillingUnit()
 local unit DeadUnit=GetTriggerUnit()
 local integer Cache=GetHandleId(UnitVar)
 local integer PreviousKills=(LoadInteger(hash_main,(Cache),(27)))
 local integer Level=GetUnitAbilityLevel(UnitVar,1093685043)
 local integer ExtraBonusGold=PreviousKills*2
-local integer TotalBonusGold=IMin(ExtraBonusGold+Level*2,18)
+local integer TotalBonusGold=IMin(ExtraBonusGold+Level*2,26)
 local texttag tt=CreateTextTag()
 local player p=GetOwningPlayer(UnitVar)
 local trigger t=CreateTrigger()
 set GG_Bonus[GetPlayerId(p)]=GG_Bonus[GetPlayerId(p)]+TotalBonusGold
 call TriggerRegisterTimerEvent(t,20,false)
 call TriggerAddCondition(t,Condition(function GoblinsGreed_Decrement))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(26),(UnitVar))
 call SaveInteger(hash_main,(Cache),(27),(PreviousKills+1))
 call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,TotalBonusGold+GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD))
 call SetTextTagText(tt,"+"+I2S(TotalBonusGold),0.025)
 call SetTextTagPosUnit(tt,DeadUnit,0)
 call SetTextTagColor(tt,255,220,0,255)
 call SetTextTagVelocity(tt,0,0.03)
 if GetLocalPlayer()==p then
 call SetTextTagVisibility(tt,true)
@@ -44098,35 +45479,35 @@
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Trig_Call_of_the_Wild_Conditions))
 call TriggerAddAction(t,function Trig_Call_of_the_Wild_Actions)
 endfunction
 function Track_GiveBounty takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local integer Cache=GetHandleId(Source)
 local player p=(LoadPlayerHandle(hash_main,(Cache),(54)))
 local integer Level=(LoadInteger(hash_main,(Cache),(5)))
 local texttag tt=CreateTextTag()
 local integer Gold
 local integer i=1
 local unit u
 local player p2
 if Level==1 then
-set Gold=75
-elseif Level==2 then
 set Gold=150
+elseif Level==2 then
+set Gold=200
 else
-set Gold=225
+set Gold=250
 endif
 call SetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD,GetPlayerState(p,PLAYER_STATE_RESOURCE_GOLD)+Gold)
 call SetTextTagText(tt,"+"+I2S(Gold),0.025)
 call SetTextTagPosUnit(tt,udg_Hero[GetPlayerId(p)],100)
 call SetTextTagColor(tt,255,220,0,255)
 call SetTextTagVelocity(tt,0,0.03)
 call SetTextTagVisibility(tt,false)
 if GetLocalPlayer()==p then
 call SetTextTagVisibility(tt,true)
 endif
 call SetTextTagFadepoint(tt,2)
 call SetTextTagLifespan(tt,3)
 call SetTextTagPermanent(tt,false)
 set ReliableGold[GetPlayerId(p)]=ReliableGold[GetPlayerId(p)]+Gold
 set bounty_totalgold=bounty_totalgold+Gold
@@ -46068,44 +47449,62 @@
 set Caster=null
 set l=null
 endfunction
 function CrystalNova_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_crystalnova then
 call CrystalNova()
 endif
 return false
 endfunction
 function Register_CrystalNova takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function CrystalNova_Main))
 set t=null
 endfunction
-function StormDies_Main takes nothing returns nothing
-call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",GetTriggerUnit(),"origin"))
-call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\ManaFlare\\ManaFlareBoltImpact.mdl",GetTriggerUnit(),"origin"))
+function EmberDies_TakeTwo takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+call SetUnitAnimationByIndex(Source,8)
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+set t=null
+set Source=null
+return false
 endfunction
-function StormDies takes nothing returns boolean
-if GetUnitTypeId(GetTriggerUnit())==unitid_raijin then
-call StormDies_Main()
+function EmberDies takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local trigger t=CreateTrigger()
+local integer Cache=GetHandleId(t)
+call SetUnitAnimationByIndex(Source,7)
+call TriggerRegisterTimerEvent(t,2.5,false)
+call TriggerAddCondition(t,Condition(function EmberDies_TakeTwo))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+set t=null
+set Source=null
+endfunction
+function EmberDies_Main takes nothing returns boolean
+if GetUnitTypeId(GetTriggerUnit())==1311788336 then
+call EmberDies()
 endif
 return false
 endfunction
-function Register_StormDies takes nothing returns nothing
+function Register_EmberDies takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_DEATH)
-call TriggerAddCondition(t,Condition(function StormDies))
+call TriggerAddCondition(t,Condition(function EmberDies_Main))
 set t=null
 endfunction
 function StaticRemnant_Damage takes nothing returns nothing
 call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\ChimaeraLightningMissile\\ChimaeraLightningMissile.mdl",GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit())))
 call DamageTarget(staticremnant_source,GetEnumUnit(),DAMAGE_MAGICAL,staticremnant_damage)
 endfunction
 function StaticRemnant_Expire takes nothing returns boolean
 local trigger t2=GetTriggeringTrigger()
 local integer Cache2=GetHandleId(t2)
 local trigger t1=(LoadTriggerHandle(hash_main,(Cache2),(9)))
 local integer Cache1=GetHandleId(t1)
 local unit Remnant=(LoadUnitHandle(hash_main,(Cache2),(8)))
 local group g
 local integer Level=(LoadInteger(hash_main,(Cache2),(5)))
 if GetTriggerEventId()==EVENT_UNIT_DEATH then
@@ -46209,31 +47608,31 @@
 function Overload_Damage takes nothing returns nothing
 local unit Caster=CreateUnit(GetOwningPlayer(overload_source),1697656901,GetUnitX(GetEnumUnit()),GetUnitY(GetEnumUnit()),0)
 call UnitAddAbility2(Caster,abilityid_overloadslow)
 call IssueTargetOrder(Caster,"slow",GetEnumUnit())
 call DamageTarget(overload_source,GetEnumUnit(),DAMAGE_MAGICAL,overload_damage)
 set Caster=null
 endfunction
 function Overload_SuccessfulAttack takes unit Source,unit Target returns nothing
 local integer Cache=GetHandleId(Source)
 local group g=GetAvailableGroup()
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(200))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(201))))
 call SaveInteger(hash_main,(GetHandleId((Source))),((4264)),(HERO_STATE_OFF))
 set tt_unit1=Source
 set overload_source=Source
-set overload_damage=GetUnitAbilityLevel(Source,abilityid_overload)*15+15
+set overload_damage=GetUnitAbilityLevel(Source,abilityid_overload)*20+10
 call GroupEnumUnitsInRange(g,GetUnitX(Target),GetUnitY(Target),300,Condition(function GenericCondition_EnemyUnitsEx))
 call ForGroup(g,function Overload_Damage)
 call KillGroup(g)
 call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\Thunderclap\\ThunderClapCaster.mdl",GetUnitX(Target),GetUnitY(Target)))
 set g=null
 endfunction
 function Overload_UnitDamaged takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local integer TargetIndex=(LoadInteger(hash_main,(Cache),(30)))
 local unit Target=TI_GetUnit(TargetIndex)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local trigger oldt=(LoadTriggerHandle(hash_main,(Cache),(202)))
 if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
 if GetEventDamageSource()==Source and((LoadInteger(hash_main,(GetHandleId((Source))),((4264))))==HERO_STATE_ON)==true then
@@ -46528,72 +47927,153 @@
 call InterruptUnit(GetTriggerUnit())
 call Error(GetOwningPlayer(GetTriggerUnit()),GetObjectName(MSG_NOMANA))
 endif
 endif
 return false
 endfunction
 function Register_BallLightning takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function BallLightning_Main))
 set t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_CAST)
 call TriggerAddCondition(t,Condition(function BallLightning_PreMain))
 set t=null
 endfunction
+function DragonsTail_Upgrade takes unit Source returns nothing
+local integer Level=GetUnitAbilityLevel(Source,abilityid_dragonstail_learn)
+if GetUnitTypeId(Source)==1215063922 then
+call SetUnitAbilityLevel(Source,abilityid_dragonstail,Level)
+else
+call SetUnitAbilityLevel(Source,abilityid_dragonstail,Level+4)
+endif
+endfunction
+function DragonsTail_Learned_Main takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local integer Level=GetUnitAbilityLevel(Source,abilityid_dragonstail_learn)
+if Level==1 then
+call UnitAddAbility2(Source,abilityid_dragonstail)
+endif
+call DragonsTail_Upgrade(Source)
+set Source=null
+endfunction
+function DragonsTail_Learned takes nothing returns boolean
+if GetLearnedSkill()==abilityid_dragonstail_learn and IsUnitIllusion(GetTriggerUnit())==false then
+call DragonsTail_Learned_Main()
+endif
+return false
+endfunction
 function DragonsTail takes nothing returns nothing
 local unit u=GetTriggerUnit()
 if GetUnitTypeId(u)==1211117639 or GetUnitTypeId(u)==1211117638 or GetUnitTypeId(u)==1211117637 then
 call SetUnitAnimation(u,"stand")
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Defend\\DefendCaster.mdl",u,"head"))
 elseif GetUnitTypeId(u)==1215063922 then
 call SetUnitAnimation(u,"stand defend")
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Human\\Defend\\DefendCaster.mdl",u,"origin"))
 endif
 set u=null
 endfunction
 function DragonsTail_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_dragonstail then
 call DragonsTail()
 endif
 return false
 endfunction
 function Register_DragonsTail takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function DragonsTail_Main))
+set t=CreateTrigger()
+call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
+call TriggerAddCondition(t,Condition(function DragonsTail_Learned))
+call PreloadAbility(abilityid_dragonstail)
 set t=null
 endfunction
 constant function DragonsBlood_RawCode takes nothing returns integer
 return 1093681996
 endfunction
 constant function DragonsBlood_ArmorCode takes nothing returns integer
 return 1378889782
 endfunction
 function DragonsBlood_Condition takes nothing returns boolean
 return GetLearnedSkill()==(1093681996)and IsUnitIllusion(GetTriggerUnit())==false
 endfunction
 function DragonsBlood_Action takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 call SetPlayerTechResearched(GetOwningPlayer(Hero),(1378889782),GetPlayerTechCount(GetOwningPlayer(Hero),(1378889782),true)+1)
 endfunction
 function RegisterDragonsBlood takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
 call TriggerAddCondition(t,Condition(function DragonsBlood_Condition))
 call TriggerAddAction(t,function DragonsBlood_Action)
 endfunction
+function DragonForm_Morphed takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+call DragonsTail_Upgrade(Source)
+call CleanTrigger(t)
+call FlushChildHashtable(hash_main,(Cache))
+set t=null
+set Source=null
+return false
+endfunction
+function DragonForm_Death takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+call DragonsTail_Upgrade(Source)
+call CleanTrigger(t)
+call FlushChildHashtable(hash_main,(Cache))
+set t=null
+set Source=null
+return false
+endfunction
+function DragonForm_FixOnRespawn takes nothing returns nothing
+if GetUnitAbilityLevel(tt_unit1,abilityid_dragonstail)>0 then
+call DragonsTail_Upgrade(tt_unit1)
+endif
+endfunction
+function DragonForm takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local trigger t=CreateTrigger()
+local integer Cache=GetHandleId(t)
+call TriggerRegisterTimerEvent(t,0.01,false)
+call TriggerAddCondition(t,Condition(function DragonForm_Morphed))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+set t=CreateTrigger()
+set Cache=GetHandleId(t)
+call TriggerRegisterDeathEvent(t,Source)
+call TriggerAddCondition(t,Condition(function DragonForm_Death))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+set Source=null
+set t=null
+endfunction
+function DragonForm_Main takes nothing returns boolean
+if GetSpellAbilityId()==abilityid_dragonform then
+call DragonForm()
+endif
+return false
+endfunction
+function Register_DragonForm takes nothing returns nothing
+local trigger t=CreateTrigger()
+call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
+call TriggerAddCondition(t,Condition(function DragonForm_Main))
+set t=null
+endfunction
 function Trig_Aftershock_Func008C takes nothing returns boolean
 if((GetSpellAbilityId()==abilityid_fissure))then
 return true
 endif
 if((GetSpellAbilityId()==1093682252))then
 return true
 endif
 if((GetSpellAbilityId()==abilityid_echoslam))then
 return true
 endif
 if((GetSpellAbilityId()==abilityid_echoslam_upgrade))then
 return true
 endif
 return false
 endfunction
@@ -47389,40 +48869,36 @@
 set Hero=null
 endfunction
 function WanningRift_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_wanningrift then
 call WanningRift()
 endif
 return false
 endfunction
 function Register_WanningRift takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function WanningRift_Main))
 set t=null
 endfunction
 function PrismaticPrison_MainStun takes unit Source,unit Target,integer Level,integer Type returns nothing
-local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
-call UnitAddAbility2(Caster,abilityid_prismaticprisonstunmain)
-call SetUnitAbilityLevel(Caster,abilityid_prismaticprisonstunmain,Level)
-call IssueTargetOrder(Caster,"thunderbolt",Target)
+call Stun(Source,Target,0.75+0.75*Level)
 if Type==1 then
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,Level*50+50)
 else
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,Level*50+50+100)
 endif
-set Caster=null
 endfunction
 function PrismaticPrison_MiniStun takes unit Source,unit Target returns nothing
 local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
 call UnitAddAbility2(Caster,abilityid_prismaticprisonstun)
 call IssueTargetOrder(Caster,"thunderbolt",Target)
 set Caster=null
 endfunction
 function PrismaticPrison_Iterate takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local integer Level=(LoadInteger(hash_main,(Cache),(5)))
 local integer Type=(LoadInteger(hash_main,(Cache),(152)))
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local integer TargetIndex=(LoadInteger(hash_main,(Cache),(30)))
 local unit Target=TI_GetUnit(TargetIndex)
@@ -48659,31 +50135,31 @@
 return false
 endfunction
 function Register_DualBreath takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function DualBreath_Main))
 call PreloadAbility(abilityid_dualbreathfrost)
 call PreloadAbility(abilityid_dualbreathfire)
 call PreloadAbility(abilityid_dualbreathfrosteffect)
 set t=null
 endfunction
 function Omnislash_Effect takes unit Hero,unit Target returns nothing
 local real a=GetRandomReal(0,360)
 local real x=GetUnitX(Target)+50*Cos(a*bj_DEGTORAD)
 local real y=GetUnitY(Target)+50*Sin(a*bj_DEGTORAD)
-local real dmg=GetRandomReal(150,250)
+local real dmg=GetRandomReal(175,250)
 call SetUnitPosition(Hero,x,y)
 call SetUnitFacing(Hero,bj_RADTODEG*Atan2(GetUnitY(Target)-GetUnitY(Hero),GetUnitX(Target)-GetUnitX(Hero)))
 call SetUnitAnimation(Hero,"Attack")
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\NightElf\\Blink\\BlinkCaster.mdl",Hero,"chest"))
 call DamageTarget(Hero,Target,DAMAGE_PHYSICAL,dmg)
 call IssueTargetOrder(Hero,"attack",Target)
 endfunction
 function Omnislash_FirstTime takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Hero=(LoadUnitHandle(hash_main,(Cache),(14)))
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 call Omnislash_Effect(Hero,Target)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
@@ -48739,40 +50215,40 @@
 set NextTarget=null
 return false
 endfunction
 function Omnislash takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 local unit Target=GetSpellTargetUnit()
 local integer Level=GetUnitAbilityLevel(Hero,abilityid_omnislash)
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local integer BFLevel=GetUnitAbilityLevel(Hero,abilityid_bladefury)
 local player p=GetOwningPlayer(Hero)
 local integer Limit=3
 if Level==0 then
 set Level=GetUnitAbilityLevel(Hero,abilityid_omnislashupgrade)
 if Level==1 then
-set Limit=5
+set Limit=6
 elseif Level==2 then
-set Limit=7
+set Limit=9
 elseif Level==3 then
-set Limit=10
+set Limit=12
 endif
 elseif Level==2 then
-set Limit=5
+set Limit=6
 elseif Level==3 then
-set Limit=8
+set Limit=9
 endif
 call SetPlayerAbilityAvailable(p,abilityid_bladefury,false)
 call SetUnitVertexColor(Hero,255,255,255,125)
 call SetUnitPathing(Hero,false)
 call SetUnitInvulnerable(Hero,true)
 call SaveInteger(hash_main,(GetHandleId((Hero))),((4253)),(HERO_STATE_ON))
 call SaveUnitHandle(hash_main,(Cache),(14),(Hero))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 call TriggerRegisterTimerEvent(t,0,false)
 call TriggerAddCondition(t,Condition(function Omnislash_FirstTime))
 set t=CreateTrigger()
 set Cache=GetHandleId(t)
 call SaveUnitHandle(hash_main,(Cache),(14),(Hero))
 call SaveInteger(hash_main,(Cache),(216),(Limit))
 call SaveInteger(hash_main,(Cache),(325),(BFLevel))
@@ -50058,31 +51534,31 @@
 local real OriginalX
 local real OriginalY
 call SetUnitX(Projectile,NewX)
 call SetUnitY(Projectile,NewY)
 set udg_TempUnit=Hero
 call GroupEnumUnitsInRange(GroupVar,NewX,NewY,140,CondVar)
 set Target=FirstOfGroup(GroupVar)
 call KillGroup(GroupVar)
 if Target!=null then
 if IsUnitType(Target,UNIT_TYPE_HERO)==true then
 set Arrow_Hits[GetPlayerId(GetOwningPlayer(Hero))]=Arrow_Hits[GetPlayerId(GetOwningPlayer(Hero))]+1
 call Traffic_RegisterData("AA_Hits"+I2S(GetPlayerId(GetOwningPlayer(Hero))),Arrow_Hits[GetPlayerId(GetOwningPlayer(Hero))])
 endif
 set OriginalX=(LoadReal(hash_main,(Cache),(191)))
 set OriginalY=(LoadReal(hash_main,(Cache),(192)))
-set Caster=CreateUnit(GetOwningPlayer(Hero),1697656901,SourceX,SourceY,0)
+set Caster=CreateUnit(GetOwningPlayer(Target),1697656901,SourceX,SourceY,0)
 call UnitAddAbility2(Caster,(1093684279))
 call SetUnitAbilityLevel(Caster,(1093684279),ElunesArrow_GetStunLevel(OriginalX,OriginalY,SourceX,SourceY))
 if IssueTargetOrder(Caster,"thunderbolt",Target)then
 endif
 call UnitDamageTarget(Hero,Target,90*GetUnitAbilityLevel(Hero,(1093684280)),true,false,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
 call KillUnit(Projectile)
 call KillTimer(t)
 elseif(NewX-TargetX)*(NewX-TargetX)+(NewY-TargetY)*(NewY-TargetY)<1600 then
 call KillUnit(Projectile)
 call KillTimer(t)
 endif
 endfunction
 function ElunesArrow_Action takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 local real SourceX=SafeX(GetUnitX(Hero))
@@ -50667,72 +52143,74 @@
 if IsUnitInGroup(GetEnumUnit(),songofthesiren_group)==false then
 call GroupAddUnit(songofthesiren_group,GetEnumUnit())
 call SetUnitOwner(songofthesiren_caster,GetOwningPlayer(GetEnumUnit()),false)
 call IssueTargetOrder(songofthesiren_caster,"sleep",GetEnumUnit())
 endif
 endfunction
 function SongOfTheSiren_Execute takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local real x=GetUnitX(Source)
 local real y=GetUnitY(Source)
 local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
 local group g
 local group AlreadyHit=(LoadGroupHandle(hash_main,(Cache),(187)))
+if GetTriggerEvalCount(t)==10 then
+call UnitAddAbility2(Source,abilityid_songofthesiren_end)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_songofthesiren,false)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_songofthesiren_end,true)
+endif
 if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetTriggerEvalCount(t)>140 or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and GetSpellAbilityId()==abilityid_songofthesiren_end)then
 if(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==0 or(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==abilityid_songofthesiren then
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_songofthesiren,true)
 endif
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_songofthesiren_end,false)
 call ForGroup(AlreadyHit,function SongOfTheSiren_RemoveAll)
 call KillGroup(AlreadyHit)
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 else
 set g=GetAvailableGroup()
 set tt_unit1=Source
 set songofthesiren_source=Source
 set songofthesiren_caster=Caster
 set songofthesiren_group=AlreadyHit
-call GroupEnumUnitsInRange(g,x,y,775,Condition(function GenericCondition_EnemyUnitsExNoImmuneAndStructure))
+call GroupEnumUnitsInRange(g,x,y,1250+25,Condition(function GenericCondition_EnemyUnitsExNoImmuneAndStructure))
 call ForGroup(g,function SongOfTheSiren_Process)
 set songofthesiren_g=g
 set songofthesiren_g2=GetAvailableGroup()
 call ForGroup(AlreadyHit,function SongOfTheSiren_Adjust)
 call GroupRemoveGroup(songofthesiren_g2,AlreadyHit)
 call KillGroup(g)
 call KillGroup(songofthesiren_g2)
 endif
 set t=null
 set g=null
 set Source=null
 set AlreadyHit=null
 set Caster=null
 return false
 endfunction
 function SongOfTheSiren takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=GetTriggerUnit()
 local real x=GetUnitX(Source)
 local real y=GetUnitY(Source)
 local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,x,y,0)
-call UnitAddAbility2(Source,abilityid_songofthesiren_end)
-call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_songofthesiren,false)
-call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_songofthesiren_end,true)
 call UnitAddAbility(Caster,songofthesiren_sleep)
 call TriggerRegisterTimerEvent(t,0.05,true)
 call TriggerRegisterDeathEvent(t,Source)
 call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function SongOfTheSiren_Execute))
 call SaveGroupHandle(hash_main,(Cache),(187),(GetAvailableGroup()))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(19),(Caster))
 call SaveEffectHandle(hash_main,(Cache),(32),(AddSpecialEffectTarget("war3mapImported\\SongOfTheSiren_2.mdx",Source,"origin")))
 set t=null
 set Source=null
 endfunction
 function SongOfTheSiren_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_songofthesiren then
 call SongOfTheSiren()
@@ -51068,30 +52546,32 @@
 endfunction
 function MC_BL_WhichUnits takes nothing returns boolean
 local unit FilterUnit=GetFilterUnit()
 local unit UnitVar=GetTriggerUnit()
 if IsUnitAlly(FilterUnit,GetOwningPlayer(UnitVar))and GetUnitState(FilterUnit,UNIT_STATE_LIFE)>0 and GetUnitAbilityLevel(FilterUnit,1113746543)==0 then
 if(GetOwningPlayer(FilterUnit)==udg_SentPlayers[0]or GetOwningPlayer(FilterUnit)==udg_ScourgePlayers[0])then
 if(GetUnitTypeId(FilterUnit)==1969711215 or GetUnitTypeId(FilterUnit)==1966092337 or GetUnitTypeId(FilterUnit)==1970169187 or GetUnitTypeId(FilterUnit)==1966092338)then
 return true
 endif
 if(GetUnitTypeId(FilterUnit)==1702061422 or GetUnitTypeId(FilterUnit)==1697656918 or GetUnitTypeId(FilterUnit)==1701081721 or GetUnitTypeId(FilterUnit)==1697656919)then
 return true
 endif
 return false
 elseif IsUnitType(FilterUnit,UNIT_TYPE_HERO)==true then
 return true
+elseif GetOwningPlayer(FilterUnit)==GetOwningPlayer(UnitVar)then
+return true
 endif
 endif
 return false
 endfunction
 function Bloodlust takes integer r returns nothing
 local unit UnitVar=GetTriggerUnit()
 local integer Level=r
 local group GroupVar=GetAvailableGroup()
 local unit Caster
 local unit TempUnit
 local integer SpellId=GetSpellAbilityId()
 local integer loopcurrent=1
 if r==2 then
 call TextTagOnUnitEx(GetObjectName(1848658743),5,GetTriggerUnit(),0.03,255,0,0,255)
 elseif r==3 then
@@ -51331,31 +52811,31 @@
 set t=null
 endfunction
 function Juxtapose_IsImage takes nothing returns boolean
 if GetUnitAbilityLevel(GetFilterUnit(),buffid_juxtapose)>0 then
 set tt_int1=tt_int1+1
 endif
 return false
 endfunction
 function Juxtapose takes nothing returns nothing
 local unit Lancer=GetAttacker()
 local group g=GetAvailableGroup()
 local integer Rand=GetRandomInt(1,100)
 local integer JuxLevel=GetUnitAbilityLevel(Lancer,abilityid_juxtapose)
 local integer EdgeLevel=GetUnitAbilityLevel(Lancer,abilityid_phantomedge)
 local unit Caster
-local integer MaxIllusions=2+JuxLevel
+local integer MaxIllusions=2*JuxLevel
 local integer JuxChance=12
 set tt_int1=0
 call GroupEnumUnitsOfPlayer(g,GetOwningPlayer(Lancer),Condition(function Juxtapose_IsImage))
 call KillGroup(g)
 if tt_int1<MaxIllusions then
 if IsUnitIllusion(Lancer)==false and Rand<=(JuxChance+2*EdgeLevel)then
 set Caster=CreateUnit(GetOwningPlayer(Lancer),1697656901,GetUnitX(Lancer),GetUnitY(Lancer),0)
 call UnitAddAbility2(Caster,abilityid_juxtaposeimage)
 call IssueTargetOrderById(Caster,852274,Lancer)
 endif
 if IsUnitIllusion(Lancer)==true and Rand<=(1+2*EdgeLevel)and EdgeLevel>0 then
 set Caster=CreateUnit(GetOwningPlayer(Lancer),1697656901,GetUnitX(Lancer),GetUnitY(Lancer),0)
 call UnitAddAbility2(Caster,abilityid_juxtaposeimage)
 call IssueTargetOrderById(Caster,852274,Lancer)
 endif
@@ -52078,31 +53558,31 @@
 endif
 set t=null
 set Source=null
 set Target=null
 set Caster=null
 return false
 endfunction
 function IsAttackOrb takes integer id returns boolean
 return id==1093682265 or id==1093752642 or id==1093677622 or id==1093679446 or id==1095263841 or id==1093684314 or id==1093685582 or id==1093685065
 endfunction
 function LastWord_Cast takes nothing returns boolean
 local unit Target=GetTriggerUnit()
 local unit Source=(LoadUnitHandle(hash_main,(GetHandleId(GetTriggeringTrigger())),(2)))
 local trigger t
 if GetUnitAbilityLevel(GetTriggerUnit(),1110455638)>0 and GetUnitAbilityLevel(GetTriggerUnit(),1093678162)==0 and IsGlobalSpellIgnore(GetSpellAbilityId())==false and GetSpellAbilityId()!=1095328363 and GetSpellAbilityId()!=1093678426 and GetSpellAbilityId()!=1093682768 and GetSpellAbilityId()!=1093685593 and GetSpellAbilityId()!=1093678680 and GetSpellAbilityId()!=1093681489 and GetSpellAbilityId()!=abilityid_wex and GetSpellAbilityId()!=abilityid_quas and GetSpellAbilityId()!=abilityid_exort and GetSpellAbilityId()!=1093743191 and GetSpellAbilityId()!=1093678667 and GetSpellAbilityId()!=1097163124 and GetSpellAbilityId()!=1093683801 and GetSpellAbilityId()!=1093682767 and GetSpellAbilityId()!=abilityid_unstableconcoction and GetSpellAbilityId()!=abilityid_iceblast and GetSpellAbilityId()!=1093751096 and GetSpellAbilityId()!=1093751361 and GetSpellAbilityId()!=1093751126 and GetSpellAbilityId()!=abilityid_invoke and GetSpellAbilityId()!=abilityid_invokeupgrade and GetSpellAbilityId()!=abilityid_sunray and IsAttackOrb(GetSpellAbilityId())==false then
-if IsSilenced(Source)==false and IsStunned(Source)==false and IsUnitEnemy(Target,GetOwningPlayer(Source))==true then
+if IsUnitEnemy(Target,GetOwningPlayer(Source))==true and IsItemAbility(GetSpellAbilityId())==false then
 if((LoadInteger(hash_main,(GetHandleId((Target))),((4305))))==HERO_STATE_ON)==false then
 set t=CreateTrigger()
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_SPELL_ENDCAST)
 call TriggerAddCondition(t,Condition(function LastWord_End))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(2),(Source))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(17),(Target))
 set t=null
 endif
 endif
 endif
 set Target=null
 set Source=null
 return false
 endfunction
 function LastWord_Process takes nothing returns nothing
@@ -52225,31 +53705,31 @@
 call VolumeGroupSetVolume(SOUND_VOLUMEGROUP_MUSIC,.0)
 call RemoveLocation(PointVar)
 set t=null
 set PointVar=null
 endfunction
 function GS takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Trig_Global_Silence_Conditions))
 call TriggerAddAction(t,function Trig_Global_Silence_Actions)
 endfunction
 function GlaivesOfWisdom_Attack_Damage takes nothing returns boolean
 local real d
 if GetUnitAbilityLevel(GetTriggerUnit(),buffid_glaivesofwisdom)>0 and GetUnitAbilityLevel(GetEventDamageSource(),abilityid_glaivesofwisdom)>0 and(LoadUnitHandle(hash_main,(GetHandleId(GetTriggeringTrigger())),(2)))==GetEventDamageSource()then
 call UnitRemoveAbility(GetTriggerUnit(),buffid_glaivesofwisdom)
-set d=(0.2+0.1*I2R(GetUnitAbilityLevel(GetEventDamageSource(),abilityid_glaivesofwisdom)))*GetHeroInt(GetEventDamageSource(),true)
+set d=(0.15+0.15*I2R(GetUnitAbilityLevel(GetEventDamageSource(),abilityid_glaivesofwisdom)))*GetHeroInt(GetEventDamageSource(),true)
 call TextTagOnUnitEx("+"+I2S(R2I(d)),1,GetTriggerUnit(),0.023,3,216,216,216)
 call DisableTrigger(GetTriggeringTrigger())
 call DamageTarget(GetEventDamageSource(),GetTriggerUnit(),DAMAGE_PURE,d)
 call FlushChildHashtable(hash_main,(GetHandleId(GetTriggeringTrigger())))
 call CleanTrigger(GetTriggeringTrigger())
 endif
 return false
 endfunction
 function GlaivesOfWisdom_Attack_Child takes nothing returns nothing
 local trigger t
 local unit Target
 local unit Source
 if GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
 set Target=GetSpellTargetUnit()
 set Source=GetTriggerUnit()
@@ -52396,31 +53876,31 @@
 endfunction
 function Shrapnel_Iterate takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
 local integer Level=(LoadInteger(hash_main,(Cache),(5)))
 local real x=(LoadReal(hash_main,(Cache),(6)))
 local real y=(LoadReal(hash_main,(Cache),(7)))
 local group g=GetAvailableGroup()
 local real d
 local real a
 local real x2
 local real y2
 set tt_unit1=Source
-call GroupEnumUnitsInRange(g,x,y,350,Condition(function GenericCondition_EnemyUnitsAndStructureEx))
+call GroupEnumUnitsInRange(g,x,y,375,Condition(function GenericCondition_EnemyUnitsAndStructureEx))
 set shrapnel_source=Source
 set shrapnel_damage=Level*12
 set shrapnel_caster=Caster
 call ForGroup(g,function Shrapnel_Hit)
 call KillGroup(g)
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(309))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(175))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(176))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(177))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(178))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(179))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(180))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(330))))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(331))))
 if GetTriggerEvalCount(t)==8 then
@@ -52710,53 +54190,53 @@
 set t=null
 endfunction
 function Backstab takes nothing returns nothing
 local unit Source=GetAttacker()
 local unit Target=GetTriggerUnit()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_backstab)
 local boolean Free=(LoadBoolean(hash_main,(GetHandleId(Source)),(332)))
 local real d=RAbsBJ(GetUnitFacing(Target)-GetUnitFacing(Source))
 if d>180 then
 set d=360-d
 endif
 if d<=105 or Free then
 call SaveBoolean(hash_main,(GetHandleId(Source)),(332),(false))
 if GetUnitAbilityLevel(Target,1093678162)==0 then
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\Stampede\\StampedeMissileDeath.mdl",Target,"chest"))
-call DamageTarget(Source,Target,DAMAGE_PHYSICAL,GetHeroAgi(Source,true)*0.25*Level)
+call DamageTarget(Source,Target,DAMAGE_PHYSICAL,GetHeroAgi(Source,true)*(0.25*Level+0.25))
 endif
 endif
 set Source=null
 set Target=null
 endfunction
 function Backstab_Main takes nothing returns boolean
 if GetUnitAbilityLevel(GetAttacker(),abilityid_backstab)>0 and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false and IsUnitAlly(GetTriggerUnit(),GetOwningPlayer(GetAttacker()))==false then
 call Backstab()
 endif
 return false
 endfunction
 function Register_Backstab takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_ATTACKED)
 call TriggerAddCondition(t,Condition(function Backstab_Main))
 set t=null
 endfunction
 function Warcry_Add takes nothing returns nothing
 if IsRealSummoned(GetEnumUnit())then
 return
 endif
-call AddTimedAbilityAndRemove(GetEnumUnit(),warcry_abilityid,1,6,1110458966)
+call AddTimedAbilityAndRemove(GetEnumUnit(),warcry_abilityid,1,8,1110458966)
 call UnitMakeAbilityPermanent(GetEnumUnit(),true,warcry_abilityid)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetEnumUnit()),warcry_abilityid,false)
 endfunction
 function Warcry takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_warcry)
 local group g=GetAvailableGroup()
 if Level==1 then
 set warcry_abilityid=warcry_abilityid_1
 elseif Level==2 then
 set warcry_abilityid=warcry_abilityid_2
 elseif Level==3 then
 set warcry_abilityid=warcry_abilityid_3
 elseif Level==4 then
 set warcry_abilityid=warcry_abilityid_4
@@ -52778,37 +54258,39 @@
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Warcry_Main))
 set t=null
 endfunction
 function GodStrength_End takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Hero=(LoadUnitHandle(hash_main,(Cache),(14)))
 local integer Count=(LoadInteger(hash_main,(Cache),(34)))
 if GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT then
 set Count=Count+1
 call SaveInteger(hash_main,(Cache),(34),(Count))
 endif
 if(GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT and Count>1)or(GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and IsPurge(GetSpellAbilityId())and GetSpellTargetUnit()==Hero)then
+if(GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT and Count>1)then
 if IsDead(Hero)==false then
 call UnitRemoveAbility(Hero,abilityid_godstrengthbonus)
 call UnitRemoveAbility(Hero,1110454329)
 call UnitRemoveAbility(Hero,1110459472)
 endif
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
+endif
 elseif GetTriggerEventId()!=EVENT_PLAYER_UNIT_SPELL_EFFECT then
 call DestroyEffect(AddSpecialEffectTarget("war3mapImported\\BattleCryCaster.mdx",Hero,"overhead"))
 call UnitAddAbility2(Hero,abilityid_godstrengthbonus)
 call SetUnitAbilityLevel(Hero,abilityid_godstrengthbonus,GetUnitAbilityLevel(Hero,abilityid_godstrength))
 call UnitMakeAbilityPermanent(Hero,true,abilityid_godstrengthbonus)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Hero),abilityid_godstrengthbonus,false)
 endif
 set t=null
 set Hero=null
 return false
 endfunction
 function GodStrength takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Hero=GetTriggerUnit()
@@ -54425,31 +55907,31 @@
 return true
 endif
 if((GetUnitTypeId(GetFilterUnit())==1848651856))then
 return true
 endif
 if((GetUnitTypeId(GetFilterUnit())==1848651857))then
 return true
 endif
 if((GetUnitTypeId(GetFilterUnit())==1848651854))then
 return true
 endif
 endif
 return false
 endfunction
 function LandMine_TripHeroes takes nothing returns boolean
-return(GetUnitTypeId(GetFilterUnit())==1211117637 or GetUnitTypeId(GetFilterUnit())==1211117639 or GetUnitTypeId(GetFilterUnit())==1211117638 or GetUnitTypeId(GetFilterUnit())==1160786000 or GetUnitTypeId(GetFilterUnit())==1311780930 or GetUnitTypeId(GetFilterUnit())==1430468144 or GetUnitTypeId(GetFilterUnit())==1162032951 or GetUnitTypeId(GetFilterUnit())==1429221456 or GetUnitTypeId(GetFilterUnit())==1160786510 or GetUnitTypeId(GetFilterUnit())==1160786511 or GetUnitTypeId(GetFilterUnit())==1328558390 or GetUnitTypeId(GetFilterUnit())==1328558391 or GetUnitTypeId(GetFilterUnit())==1160786502)and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(tt_unit1))
+return(GetUnitTypeId(GetFilterUnit())==1211117637 or GetUnitTypeId(GetFilterUnit())==1211117639 or GetUnitTypeId(GetFilterUnit())==1211117638 or GetUnitTypeId(GetFilterUnit())==1160786000 or GetUnitTypeId(GetFilterUnit())==1311780930 or GetUnitTypeId(GetFilterUnit())==1430468144 or GetUnitTypeId(GetFilterUnit())==1162032951 or GetUnitTypeId(GetFilterUnit())==1429221456 or GetUnitTypeId(GetFilterUnit())==1160786510 or GetUnitTypeId(GetFilterUnit())==1160786511 or GetUnitTypeId(GetFilterUnit())==1328558390 or GetUnitTypeId(GetFilterUnit())==1328558391 or GetUnitTypeId(GetFilterUnit())==1160786502 or GetUnitTypeId(GetFilterUnit())==1211122767)and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(tt_unit1))
 endfunction
 function LandMine_Scan takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Mine=(LoadUnitHandle(hash_main,(Cache),(347)))
 local group g
 if GetTriggerEventId()==EVENT_UNIT_DEATH then
 call DestroyEffect(AddSpecialEffect("war3mapImported\\NewGroundEX.mdx",GetUnitX(Mine),GetUnitY(Mine)))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 else
 set g=GetAvailableGroup()
 set tt_unit1=Mine
 call GroupEnumUnitsInRange(g,GetUnitX(Mine),GetUnitY(Mine),200,Condition(function LandMine_TripHeroes))
 if FirstOfGroup(g)!=null then
@@ -54608,31 +56090,31 @@
 set l=null
 endfunction
 function MarchOfTheMachines_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_marchofthemachines then
 call MarchOfTheMachines()
 endif
 return false
 endfunction
 function Register_MarchOfTheMachines takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function MarchOfTheMachines_Main))
 set t=null
 endfunction
 function Trig_Laser_Conditions takes nothing returns boolean
-return GetSpellAbilityId()==1093678137
+return GetSpellAbilityId()==1093678137 and IsBlocked(GetSpellTargetUnit())==false
 endfunction
 function Trig_Laser_Actions takes nothing returns nothing
 call UnitDamageTarget(GetTriggerUnit(),GetSpellTargetUnit(),GetUnitAbilityLevel(GetTriggerUnit(),1093678137)*80,true,false,ATTACK_TYPE_HERO,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
 endfunction
 function Laser takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Trig_Laser_Conditions))
 call TriggerAddAction(t,function Trig_Laser_Actions)
 endfunction
 function Toss_DealDamage takes nothing returns nothing
 if IsUnitType(GetEnumUnit(),UNIT_TYPE_STRUCTURE)==true then
 call DamageTarget(toss_source,GetEnumUnit(),DAMAGE_MAGICAL,toss_damage/3)
 else
 call DamageTarget(toss_source,GetEnumUnit(),DAMAGE_MAGICAL,toss_damage)
@@ -54784,30 +56266,34 @@
 if GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_CAST then
 call Toss_Precast()
 else
 call Toss()
 endif
 endif
 return false
 endfunction
 function Register_Toss takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_CAST)
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Toss_Main))
 set t=null
 endfunction
+function Grow_InitAghanim takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+call HideAbilityForAll(1093815115)
+endfunction
 function WarClub_UnitDamaged takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local integer OldCache=(LoadInteger(hash_main,(Cache),(375)))
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local integer Count
 if GetTriggerEventId()==EVENT_UNIT_DAMAGED then
 if GetEventDamageSource()==Source and GetEventDamage()>20 then
 set Count=(LoadInteger(hash_main,(GetHandleId(Source)),(674)))
 if((LoadInteger(hash_main,(GetHandleId((Source))),((4297))))==HERO_STATE_ON)==false then
 call AddHeroState(Source,4297,0.1)
 call SaveInteger(hash_main,(GetHandleId(Source)),(674),(Count+1))
 endif
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
@@ -54880,30 +56366,40 @@
 call AddHeroState(GetTriggerUnit(),4296,29.9)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),abilityid_warclub_fake,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),abilityid_warclub_real,true)
 call UnitAddAbility2(GetTriggerUnit(),abilityid_warclub_real)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),warclub_cleave,false)
 call UnitAddAbility2(GetTriggerUnit(),warclub_cleave)
 call IssueTargetOrder(GetTriggerUnit(),"grabtree",GetSpellTargetDestructable())
 set t=CreateTrigger()
 call TriggerRegisterTimerEvent(t,30,false)
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_ATTACKED)
 call TriggerAddCondition(t,Condition(function WarClub_End))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(2),(GetTriggerUnit()))
 call SaveInteger(hash_main,(GetHandleId(t)),(34),(0))
 call SaveInteger(hash_main,(GetHandleId(GetTriggerUnit())),(674),(0))
 set t=null
+elseif GetSpellAbilityId()==grow_aghanim_treefix then
+call RemoveDestructable(GetSpellTargetDestructable())
+call ShowUnit(GetTriggerUnit(),false)
+call ShowUnit(GetTriggerUnit(),true)
+call UnitRemoveAbility(GetTriggerUnit(),1097625443)
+call UnitAddAbility(GetTriggerUnit(),grow_aghanim_treefix_to)
+call UnitRemoveAbility(GetTriggerUnit(),grow_aghanim_treefix_to)
+call UnitAddAbility(GetTriggerUnit(),grow_aghanim_treefix_from)
+call UnitRemoveAbility(GetTriggerUnit(),grow_aghanim_treefix_from)
+call AddUnitAnimationProperties(GetTriggerUnit(),"upgrade",false)
 endif
 return false
 endfunction
 function WarClub_Scan takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 if(FindItemOfType((Source),Item_Real[indexid_aghanimssceptertiny])!=null)then
 if((LoadInteger(hash_main,(GetHandleId((Source))),((4296))))==HERO_STATE_ON)==false then
 if GetUnitAbilityLevel(Source,abilityid_warclub_fake)==0 and GetUnitAbilityLevel(Source,abilityid_warclub_real)==0 then
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_warclub_fake,true)
 call UnitAddAbility2(Source,abilityid_warclub_fake)
 endif
 endif
 else
@@ -54976,44 +56472,44 @@
 call TriggerAddAction(t,function Grow_ModelGrow)
 call TriggerRegisterTimerEvent(t,2.00,true)
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(298),(Tiny))
 call SetUnitScale(Tiny,0.5+0.25*Level,0.5+0.25*Level,0.5+0.25*Level)
 set t=CreateTrigger()
 set rectRegion=CreateRegion()
 call RegionAddRect(rectRegion,GetWorldBounds())
 call TriggerRegisterEnterRegion(t,rectRegion,Condition(function TriggerRegisterAnyUnitEvent_True))
 call TriggerAddCondition(t,Condition(function Grow_AdjustImages))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(298),(Tiny))
 set t=null
 set rectRegion=null
 set t=CreateTrigger()
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(2),(Tiny))
 call TriggerRegisterTimerEvent(t,0.5,true)
-call TriggerAddCondition(t,Condition(function WarClub_Scan))
 set t=null
 endif
 set Hero=null
 set Caster=null
 endfunction
 function RegisterGrow takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
 call TriggerAddCondition(t,Condition(function Grow_Conditions))
 call TriggerAddAction(t,function Grow_Actions)
 set t=CreateTrigger()
-call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_CAST)
+call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function WarClub_Cast))
+call Grow_InitAghanim()
 set t=null
 endfunction
 function CraggyExterior_Attacked takes nothing returns boolean
 local unit Source=GetTriggerUnit()
 local unit Target=GetAttacker()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_craggyexterior)
 local unit Caster
 if GetRandomInt(1,100)<=Level*6 and DistanceBetweenUnits(Source,Target)<325 then
 set Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
 call UnitAddAbility2(Caster,craggyexterior_stun)
 call SetUnitAbilityLevel(Caster,craggyexterior_stun,Level)
 call IssueTargetOrder(Caster,"thunderbolt",Target)
 set Caster=null
 endif
 set Source=null
@@ -55181,31 +56677,31 @@
 call SetUnitAbilityLevel(GetTriggerUnit(),1093679429,GetUnitAbilityLevel(GetTriggerUnit(),1093681733))
 endfunction
 function BerserkerL takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
 call TriggerAddCondition(t,Condition(function Trig_Berserker_Rage_learned_Conditions))
 call TriggerAddAction(t,function Trig_Berserker_Rage_learned_Actions)
 endfunction
 constant function BeastRage_AbilityCode takes nothing returns integer
 return 1093685040
 endfunction
 constant function BeastRage_EffectCode takes nothing returns integer
 return 1093684826
 endfunction
 function BeastRage_Conditions takes nothing returns boolean
-return GetUnitAbilityLevel(GetAttacker(),(1093685040))>0 and((LoadInteger(hash_main,(GetHandleId((GetAttacker()))),((4271))))==HERO_STATE_ON)==false and IsUnitType(GetTriggerUnit(),UNIT_TYPE_STRUCTURE)==false
+return GetUnitAbilityLevel(GetAttacker(),(1093685040))>0 and((LoadInteger(hash_main,(GetHandleId((GetAttacker()))),((4271))))==HERO_STATE_ON)==false
 endfunction
 function BeastRage_Actions takes nothing returns nothing
 local unit Attacker=GetAttacker()
 local unit Target=GetTriggerUnit()
 local integer Cache=GetHandleId(Attacker)
 local integer PreviousTargetIndex=(LoadInteger(hash_main,(Cache),(237)))
 local unit PreviousTarget=TI_GetUnit(PreviousTargetIndex)
 local integer Counter=IMax((LoadInteger(hash_main,(Cache),(236))),0)
 local integer Level=GetUnitAbilityLevel(Attacker,(1093685040))
 if PreviousTarget!=Target then
 set Counter=1
 else
 set Counter=IMin(Counter+1,2+Level)
 endif
 call AddAbilityLevel(Attacker,(1093684826),Counter)
@@ -55649,31 +57145,31 @@
 set t=null
 endfunction
 function Enrage_Update takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local integer Level=GetUnitAbilityLevel(Source,abilityid_enrage)
 local integer Bonus
 local integer LastBonus
 if GetTriggerEventId()==EVENT_UNIT_DEATH or GetUnitAbilityLevel(Source,buffid_enrage)==0 or(GetTriggerEventId()==EVENT_PLAYER_UNIT_SPELL_EFFECT and Source==GetSpellTargetUnit()and IsPurge(GetSpellAbilityId()))then
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 call UnitRemoveAbility(Source,buffid_enrage)
 call AddDamageBonus(Source,0)
 else
-set Bonus=R2I(GetUnitState(Source,UNIT_STATE_LIFE)*(0.03+0.01*Level))
+set Bonus=R2I(GetUnitState(Source,UNIT_STATE_LIFE)*(0.04+0.01*Level))
 set LastBonus=(LoadInteger(hash_main,(Cache),(238)))
 if Bonus!=LastBonus then
 call SaveInteger(hash_main,(Cache),(238),(Bonus))
 call AddDamageBonus(Source,Bonus)
 endif
 endif
 set t=null
 set Source=null
 return false
 endfunction
 function Enrage takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 call TriggerRegisterTimerEvent(t,0.25,true)
 call TriggerRegisterUnitEvent(t,GetTriggerUnit(),EVENT_UNIT_DEATH)
@@ -56182,30 +57678,31 @@
 endif
 set Hero=null
 return false
 endfunction
 function Refraction_Attacked takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local unit Hero=(LoadUnitHandle(hash_main,(GetHandleId(t)),(14)))
 local integer Cache=GetHandleId(Hero)
 local integer Remaining=(LoadInteger(hash_main,(Cache),(351)))
 if GetTriggerEventId()==EVENT_UNIT_DEATH or(GetTriggerEventId()==EVENT_PLAYER_UNIT_ATTACKED and GetAttacker()==Hero and IsUnitAlly(GetAttacker(),GetOwningPlayer(GetTriggerUnit()))==false)then
 if GetTriggerEventId()!=EVENT_UNIT_DEATH and Remaining>0 and GetEventDamage()>0 then
 call SaveInteger(hash_main,(Cache),(351),(Remaining-1))
 else
 call UnitRemoveAbility(Hero,abilityid_refractionbonusdamage)
 call UnitRemoveAbility(Hero,abilityid_refractionbonusdamagebuff)
+call UnitRemoveAbility(Hero,1110456393)
 call SaveInteger(hash_main,(Cache),(351),(0))
 endif
 endif
 set t=null
 set Hero=null
 return false
 endfunction
 function Refraction_Reset takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local unit Hero=(LoadUnitHandle(hash_main,(GetHandleId(t)),(14)))
 local integer Cache=GetHandleId(Hero)
 call SaveInteger(hash_main,(Cache),(352),(0))
 call SaveInteger(hash_main,(Cache),(351),(0))
 call UnitRemoveAbility(Hero,abilityid_refractionbonusdamage)
 call UnitRemoveAbility(Hero,abilityid_refractionbonusdamagebuff)
@@ -56213,35 +57710,35 @@
 call FlushChildHashtable(hash_main,(GetHandleId(t)))
 call CleanTrigger(t)
 set t=null
 set Hero=null
 return false
 endfunction
 function Refraction_Main takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 local integer Cache=GetHandleId(Hero)
 local trigger t=CreateTrigger()
 call TriggerRegisterTimerEvent(t,17,false)
 call TriggerAddCondition(t,Condition(function Refraction_Reset))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(14),(Hero))
 call PlaySoundAtPos(gg_snd_Vacuum,GetUnitX(Hero),GetUnitY(Hero))
 call UnitAddAbility2(Hero,abilityid_refractionpreventionbuff)
-call SaveInteger(hash_main,(Cache),(352),(GetUnitAbilityLevel(Hero,abilityid_refraction)+1))
+call SaveInteger(hash_main,(Cache),(352),(GetUnitAbilityLevel(Hero,abilityid_refraction)+2))
 call UnitAddAbility2(Hero,abilityid_refractionbonusdamage)
 call SetUnitAbilityLevel(Hero,abilityid_refractionbonusdamage,GetUnitAbilityLevel(Hero,abilityid_refraction))
 call UnitAddAbility2(Hero,abilityid_refractionbonusdamagebuff)
-call SaveInteger(hash_main,(Cache),(351),(GetUnitAbilityLevel(Hero,abilityid_refraction)+1))
+call SaveInteger(hash_main,(Cache),(351),(GetUnitAbilityLevel(Hero,abilityid_refraction)+2))
 set Hero=null
 endfunction
 function Refraction_MainLearn takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 local trigger t
 set t=CreateTrigger()
 call TriggerRegisterUnitEvent(t,Hero,EVENT_UNIT_DAMAGED)
 call TriggerRegisterUnitEvent(t,Hero,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function Refraction_PreventDamage))
 call SaveInteger(hash_main,(GetHandleId(Hero)),(352),(0))
 set t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_ATTACKED)
 call TriggerRegisterUnitEvent(t,Hero,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function Refraction_Attacked))
 call SaveUnitHandle(hash_main,(GetHandleId(t)),(14),(Hero))
@@ -56836,31 +58333,31 @@
 call SaveBoolean(hash_main,(Cache),(15),(Scepter))
 call SaveInteger(hash_main,(Cache),(30),(TI_AddUnit(Target)))
 call SaveReal(hash_main,(Cache),(193),((Rate)*1.0))
 call SaveInteger(hash_main,(Cache),(361),(0))
 call TriggerRegisterTimerEvent(t,20,false)
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_ATTACKED)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DAMAGED)
 call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function FocusFire_Hit))
 set Source=null
 set Target=null
 set t=null
 endfunction
 function FocusFire_Main takes nothing returns boolean
-if GetSpellAbilityId()==abilityid_focusfire or GetSpellAbilityId()==abilityid_focusfireupgrade then
+if(GetSpellAbilityId()==abilityid_focusfire or GetSpellAbilityId()==abilityid_focusfireupgrade)and IsBlocked(GetSpellTargetUnit())==false then
 call FocusFire()
 endif
 return false
 endfunction
 function Register_FocusFire takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function FocusFire_Main))
 set t=null
 endfunction
 function ThundergodWrath_Filter takes nothing returns boolean
 return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and GetUnitTypeId(GetFilterUnit())!=1211117642 and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(thundergodwrath_source))==true
 endfunction
 function ThundergodWrath_Enum takes nothing returns nothing
 local real x=GetUnitX(GetEnumUnit())
@@ -56912,31 +58409,31 @@
 endfunction
 constant function StaticField_WrathOfGod2Code takes nothing returns integer
 return 1093810504
 endfunction
 function StaticField_Condition takes nothing returns boolean
 return(GetSpellAbilityId()==(1093683779)or GetSpellAbilityId()==(1093677616)or GetSpellAbilityId()==(1093810503)or GetSpellAbilityId()==(1093810504))and GetUnitAbilityLevel(GetTriggerUnit(),(1093684789))>0
 endfunction
 function StaticField_ShockThem takes nothing returns nothing
 local real CurrentLife=GetUnitState(GetEnumUnit(),UNIT_STATE_LIFE)
 local real LifeFactor=0.03+0.02*GetUnitAbilityLevel(GetTriggerUnit(),(1093684789))
 local real Damage=CurrentLife*LifeFactor
 call UnitDamageTarget(GetTriggerUnit(),GetEnumUnit(),Damage,true,true,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_MAGIC,WEAPON_TYPE_WHOKNOWS)
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Other\\ForkedLightning\\ForkedLightningTarget.mdl",GetEnumUnit(),"overhead"))
 endfunction
 function StaticField_WhichToShock takes nothing returns boolean
-return IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitVisible(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))
+return GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit()))and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false
 endfunction
 function StaticField_Action takes nothing returns nothing
 local location PointVar=GetUnitLoc(GetTriggerUnit())
 local group GroupVar=GetAvailableGroup()
 local real x=GetLocationX(PointVar)
 local real y=GetLocationY(PointVar)
 local boolexpr CondVar=Condition(function StaticField_WhichToShock)
 call GroupEnumUnitsInRange(GroupVar,x,y,1025,CondVar)
 call ForGroup(GroupVar,function StaticField_ShockThem)
 call RemoveLocation(PointVar)
 call KillGroup(GroupVar)
 endfunction
 function RegisterStaticField takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
@@ -57088,34 +58585,38 @@
 set Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 set Level=(LoadInteger(hash_main,(Cache),(5)))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
 call SaveBoolean(hash_main,(GetHandleId(Target)),(363),(false))
 call TI_ClearUnit(TargetIndex)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 call PreventDamage(GetTriggerUnit(),Life)
 call AphoticShield_Explode(Source,GetTriggerUnit(),Level)
 elseif GetEventDamage()>0 then
 call PreventDamage(GetTriggerUnit(),GetEventDamage())
 call SaveReal(hash_main,(Cache),(362),((Life-GetEventDamage())*1.0))
 endif
 endif
 else
+set Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+set Level=(LoadInteger(hash_main,(Cache),(5)))
 call SaveBoolean(hash_main,(GetHandleId(Target)),(363),(false))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
+call TI_ClearUnit(TargetIndex)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
+call AphoticShield_Explode(Source,Target,Level)
 endif
 set t=null
 return false
 endfunction
 function AphoticShield takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Target=GetSpellTargetUnit()
 local unit Source=GetTriggerUnit()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_aphoticshield)
 local integer Cache2=GetHandleId(Target)
 local real Life
 if(LoadBoolean(hash_main,(Cache2),(363)))==true then
 call TriggerEvaluate((LoadTriggerHandle(hash_main,(Cache2),(364))))
 endif
@@ -59193,60 +60849,62 @@
 set Target=null
 return false
 endfunction
 function AstralImprisonment_Finish takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 call SaveInteger(hash_main,(GetHandleId((Target))),((4303)),(HERO_STATE_OFF))
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
 call SetUnitInvulnerable(Target,false)
 call PauseUnit(Target,false)
 call ShowUnit(Target,true)
 call ClearSelectionForPlayer(GetOwningPlayer(Target))
 call SelectUnitAddForPlayer(Target,GetOwningPlayer(Target))
+call RemoveSavedHandle(hash_main,(GetHandleId(Source)),(748))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 set t=null
 set Source=null
 set Target=null
 return false
 endfunction
 function AstralImprisonment takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local unit Target=GetSpellTargetUnit()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_astralimprisonment)
 local integer StolenInt=IMin(GetHeroInt(Target,false),Level*2)
 local trigger t
 local integer Cache
 local unit Caster=CreateUnit(GetOwningPlayer(Target),1865429305,GetUnitX(Target),GetUnitY(Target),0)
 call UnitApplyTimedLife(Caster,1112820806,Level+1)
 if(IsUnitEnemy(Target,GetOwningPlayer(Source)))==false or IsBlocked(GetSpellTargetUnit())==false then
 call SaveInteger(hash_main,(GetHandleId((Target))),((4303)),(HERO_STATE_ON))
 set t=CreateTrigger()
 set Cache=GetHandleId(t)
 call SelectUnitRemoveForPlayer(Target,GetOwningPlayer(Target))
 call SetUnitInvulnerable(Target,true)
 call PauseUnit(Target,true)
 call ShowUnit(Target,false)
 call SaveEffectHandle(hash_main,(Cache),(32),(AddSpecialEffect("Abilities\\Spells\\Demon\\DarkConversion\\ZombifyTarget.mdl",GetUnitX(Target),GetUnitY(Target))))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 call TriggerRegisterTimerEvent(t,Level,false)
 call TriggerAddCondition(t,Condition(function AstralImprisonment_Finish))
 if(IsUnitEnemy(Target,GetOwningPlayer(Source)))==true then
+call SaveUnitHandle(hash_main,(GetHandleId(Source)),(748),(Target))
 call SetHeroInt(Target,GetHeroInt(Target,false)-StolenInt,true)
 call SetHeroInt(Source,GetHeroInt(Source,false)+StolenInt,true)
 set t=CreateTrigger()
 set Cache=GetHandleId(t)
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 call SaveInteger(hash_main,(Cache),(262),(StolenInt))
 call TriggerRegisterTimerEvent(t,60,false)
 call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function AstralImprisonment_RestoreInt))
 endif
 endif
 set Source=null
 set Target=null
@@ -59308,71 +60966,79 @@
 function SanitysEclipseWhichUnits takes nothing returns boolean
 if(IsUnitType(GetFilterUnit(),UNIT_TYPE_HERO)==true)then
 if(IsUnitEnemy(GetFilterUnit(),GetOwningPlayer(GetTriggerUnit())))then
 return true
 endif
 endif
 return false
 endfunction
 function Trig_Sanitys_Eclipse_Actions takes nothing returns nothing
 local unit UnitVar=GetTriggerUnit()
 local integer level=GetUnitAbilityLevel(UnitVar,1093685067)
 local real x=GetLocationX(GetSpellTargetLoc())
 local real y=GetLocationY(GetSpellTargetLoc())
 local group GroupVar=GetAvailableGroup()
 local integer offset=0
+local unit AstralTarget=(LoadUnitHandle(hash_main,(GetHandleId(UnitVar)),(748)))
 if level==0 then
 set level=GetUnitAbilityLevel(UnitVar,abilityid_sanityseclipse_upgrade)
 endif
 call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosTarget.mdl",x,y))
 loop
 exitwhen offset>=360
 call DestroyEffect(AddSpecialEffect("Abilities\\Spells\\Human\\MarkOfChaos\\MarkOfChaosTarget.mdl",x+(200+level*50)*Cos(offset*bj_DEGTORAD),y+(200+level*50)*Sin(offset*bj_DEGTORAD)))
 set offset=offset+45
 endloop
 call GroupEnumUnitsInRange(GroupVar,x,y,300+level*100,Condition(function SanitysEclipseWhichUnits))
+if AstralTarget!=null and DistanceBetweenXY(x,y,GetUnitX(AstralTarget),GetUnitY(AstralTarget))<(300+level*100)then
+call SetUnitInvulnerable(AstralTarget,false)
+call GroupAddUnit(GroupVar,AstralTarget)
+endif
 call ForGroup(GroupVar,function SanitysEclipseDamage)
+if AstralTarget!=null and IsDead(AstralTarget)==false then
+call SetUnitInvulnerable(AstralTarget,true)
+endif
 call KillGroup(GroupVar)
 endfunction
 function RegisterSanitys_Eclipse takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Trig_Sanitys_Eclipse_Conditions))
 call TriggerAddAction(t,function Trig_Sanitys_Eclipse_Actions)
 endfunction
 function IonShell_Damage takes nothing returns nothing
 
@@ -62326,31 +63993,31 @@
 call IssueImmediateOrder(Caster,"thunderclap")
 call SelectUnitForPlayerSingle(Source,GetOwningPlayer(Source))
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 set t=null
 set Source=null
 set Caster=null
 return false
 endfunction
 function Reincarnation_Dead takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local integer Level=GetUnitAbilityLevel(Source,abilityid_reincarnation)
 if TimerGetRemaining(CTimer[GetPlayerId(GetOwningPlayer(Source))])==0 and GetUnitState(Source,UNIT_STATE_MANA)>=140 then
-call TimerStart(CTimer[GetPlayerId(GetOwningPlayer(Source))],380-80*Level,false,null)
+call TimerStart(CTimer[GetPlayerId(GetOwningPlayer(Source))],360-100*Level,false,null)
 set t=CreateTrigger()
 set Cache=GetHandleId(t)
 call TriggerRegisterTimerEvent(t,3+0.01,false)
 call TriggerAddCondition(t,Condition(function Reincarnation_Control))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 endif
 set t=null
 set Source=null
 return false
 endfunction
 function Reincarnation_Learned takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=GetTriggerUnit()
 call TriggerRegisterDeathEvent(t,Source)
@@ -62435,31 +64102,31 @@
 set udg_TempReal=DistanceBetweenUnitAndPoint(udg_TempUnit,TargetLoc)
 set udg_TempLoc=TargetLoc
 call ForGroup(GroupVar,function Poof_GetClosestKobold)
 set Target=udg_TempUnit
 set x=GetUnitX(Target)
 set y=GetUnitY(Target)
 endif
 call KillGroup(GroupVar)
 call RemoveLocation(TargetLoc)
 endif
 if ProperTarget then
 call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\ToonBoom\\ToonBoom.mdl",SourceX,SourceY))
 call DestroyEffect(AddSpecialEffect("Objects\\Spawnmodels\\Other\\ToonBoom\\ToonBoom.mdl",x,y))
 call SetUnitX(Source,x)
 call SetUnitY(Source,y)
-set udg_TempReal=20+GetUnitAbilityLevel(GetTriggerUnit(),(1093684792))*30
+set udg_TempReal=60+GetUnitAbilityLevel(GetTriggerUnit(),(1093684792))*20
 set CondVar=Condition(function Poof_UnitsToDamage)
 set GroupVar=GetAvailableGroup()
 call GroupEnumUnitsInRange(GroupVar,SourceX,SourceY,400,CondVar)
 call ForGroup(GroupVar,function Poof_DamageUnits)
 call KillGroup(GroupVar)
 set GroupVar=GetAvailableGroup()
 call GroupEnumUnitsInRange(GroupVar,x,y,400,CondVar)
 call ForGroup(GroupVar,function Poof_DamageUnits)
 call KillGroup(GroupVar)
 endif
 endfunction
 function Poof_StartCondition takes nothing returns boolean
 return GetSpellAbilityId()==(1093684792)
 endfunction
 function Poof_PlayAnimAgain takes nothing returns nothing
@@ -62575,30 +64242,36 @@
 constant function DoubleTrouble_PrimaryUnitCode takes nothing returns integer
 return 1211117641
 endfunction
 constant function DoubleTrouble_SecondaryUnitCode takes nothing returns integer
 return 1211117642
 endfunction
 constant function DoubleTrouble_Ability1 takes nothing returns integer
 return 1093684792
 endfunction
 constant function DoubleTrouble_Ability2 takes nothing returns integer
 return 1093684802
 endfunction
 constant function DoubleTrouble_Ability3 takes nothing returns integer
 return 1093684791
 endfunction
+constant function DoubleTrouble_Item9 takes nothing returns integer
+return Item_Real[indexid_ironboots_disabled]
+endfunction
+constant function DoubleTrouble_Item8 takes nothing returns integer
+return Item_Real[indexid_ironboots]
+endfunction
 constant function DoubleTrouble_Item7 takes nothing returns integer
 return Item_Real[indexid_arcaneboots]
 endfunction
 constant function DoubleTrouble_Item6 takes nothing returns integer
 return Item_Real[indexid_phaseboots]
 endfunction
 constant function DoubleTrouble_Item5 takes nothing returns integer
 return Item_Real[indexid_powertreadsagility]
 endfunction
 constant function DoubleTrouble_Item4 takes nothing returns integer
 return Item_Real[indexid_powertreadsstrength]
 endfunction
 constant function DoubleTrouble_Item3 takes nothing returns integer
 return Item_Real[indexid_powertreadsintelligence]
 endfunction
@@ -62836,107 +64509,123 @@
 call EnableTrigger(gg_trg_Deathtrigger)
 endfunction
 function DoubleTrouble_ItemCondition takes nothing returns boolean
 return DoubleTrouble_IsKobold(GetTriggerUnit())and IsUnitIllusion(GetTriggerUnit())==false
 endfunction
 function DoubleTrouble_GiveItem takes unit NewHero,unit Hero returns nothing
 local trigger t=(LoadTriggerHandle(hash_main,(GetHandleId(GetOwningPlayer(Hero))),(369)))
 local integer i=0
 local boolean Item1=false
 local boolean Item2=false
 local boolean Item3=false
 local boolean Item4=false
 local boolean Item5=false
 local boolean Item6=false
 local boolean Item7=false
+local boolean Item8=false
+local boolean Item9=false
 call DisableTrigger(t)
 call DisableTrigger(t_manipulateitem)
 loop
 exitwhen i>5
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_bootsofspeed])then
 set Item1=true
 endif
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_bootsoftravel])then
 set Item2=true
 endif
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_powertreadsintelligence])then
 set Item3=true
 endif
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_powertreadsstrength])then
 set Item4=true
 endif
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_powertreadsagility])then
 set Item5=true
 endif
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_phaseboots])then
 set Item6=true
 endif
 if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_arcaneboots])then
 set Item7=true
 endif
+if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_ironboots])then
+set Item8=true
+endif
+if GetItemTypeId(UnitItemInSlot(Hero,i))==(Item_Real[indexid_ironboots_disabled])then
+set Item9=true
+endif
 set i=i+1
 endloop
-if Item7 then
+if Item9 then
+call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_ironboots_disabled]),0,0))
+elseif Item8 then
+call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_ironboots]),0,0))
+elseif Item7 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_arcaneboots]),0,0))
 elseif Item6 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_phaseboots]),0,0))
 elseif Item5 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_powertreadsagility]),0,0))
 elseif Item4 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_powertreadsstrength]),0,0))
 elseif Item3 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_powertreadsintelligence]),0,0))
 elseif Item2 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_bootsoftravel]),0,0))
 elseif Item1 then
 call UnitAddItem(NewHero,CreateItem((Item_Real[indexid_bootsofspeed]),0,0))
 endif
 call EnableTrigger(t)
 call EnableTrigger(t_manipulateitem)
 endfunction
 function DoubleTrouble_ItemAction takes nothing returns nothing
 local unit Kobold=GetTriggerUnit()
 local integer i=0
 local boolean Item1=false
 local boolean Item2=false
 local boolean Item3=false
 local boolean Item4=false
 local boolean Item5=false
 local boolean Item6=false
 local boolean Item7=false
+local boolean Item8=false
+local boolean Item9=false
 local integer PlayerCache=GetHandleId(GetOwningPlayer(Kobold))
 local unit Kobold0=(LoadUnitHandle(hash_main,(PlayerCache),(699)))
 local unit Kobold1=(LoadUnitHandle(hash_main,(PlayerCache),(700)))
 local unit Kobold2=(LoadUnitHandle(hash_main,(PlayerCache),(701)))
 local unit Kobold3=(LoadUnitHandle(hash_main,(PlayerCache),(702)))
 local unit Kobold4=(LoadUnitHandle(hash_main,(PlayerCache),(703)))
 local integer TempItem
 local boolean ItemDropped=false
 local integer Count1=0
 local integer Count2=0
 local integer Count3=0
 local integer Count4=0
 local integer Count5=0
 local integer Count6=0
 local integer Count7=0
+local integer Count8=0
+local integer Count9=0
 call DisableTrigger(GetTriggeringTrigger())
 if GetUnitTypeId(Kobold)==(1211117642)then
 call UnitRemoveItemFromSlot(Kobold,0)
 call EnableTrigger(GetTriggeringTrigger())
 return
 endif
-if not(GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_bootsofspeed])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_bootsoftravel])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_powertreadsintelligence])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_powertreadsstrength])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_powertreadsagility])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_phaseboots])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_arcaneboots]))then
+if not(GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_bootsofspeed])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_bootsoftravel])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_powertreadsintelligence])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_powertreadsstrength])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_powertreadsagility])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_phaseboots])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_arcaneboots])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_ironboots])or GetItemTypeId(GetManipulatedItem())==(Item_Real[indexid_ironboots_disabled]))then
 call EnableTrigger(GetTriggeringTrigger())
 return
 endif
 call DisableTrigger(t_manipulateitem)
 if GetTriggerEventId()==EVENT_PLAYER_UNIT_DROP_ITEM then
 set ItemDropped=true
 endif
 loop
 exitwhen i>5
 set TempItem=GetItemTypeId(UnitItemInSlot(Kobold,i))
 if TempItem==(Item_Real[indexid_bootsofspeed])then
 set Count1=Count1+1
 if(not(ItemDropped and TempItem==GetItemTypeId(GetManipulatedItem())))or(Count1>1 and TempItem==GetItemTypeId(GetManipulatedItem()))then
 set Item1=true
 endif
@@ -62965,43 +64654,71 @@
 set Item5=true
 endif
 endif
 if TempItem==(Item_Real[indexid_phaseboots])then
 set Count6=Count6+1
 if(not(ItemDropped and TempItem==GetItemTypeId(GetManipulatedItem())))or(Count6>1 and TempItem==GetItemTypeId(GetManipulatedItem()))then
 set Item6=true
 endif
 endif
 if TempItem==(Item_Real[indexid_arcaneboots])then
 set Count7=Count7+1
 if(not(ItemDropped and TempItem==GetItemTypeId(GetManipulatedItem())))or(Count7>1 and TempItem==GetItemTypeId(GetManipulatedItem()))then
 set Item7=true
 endif
 endif
+if TempItem==(Item_Real[indexid_ironboots])then
+set Count8=Count8+1
+if(not(ItemDropped and TempItem==GetItemTypeId(GetManipulatedItem())))or(Count8>1 and TempItem==GetItemTypeId(GetManipulatedItem()))then
+set Item8=true
+endif
+endif
+if TempItem==(Item_Real[indexid_ironboots_disabled])then
+set Count9=Count9+1
+if(not(ItemDropped and TempItem==GetItemTypeId(GetManipulatedItem())))or(Count8>1 and TempItem==GetItemTypeId(GetManipulatedItem()))then
+set Item9=true
+endif
+endif
 set i=i+1
 endloop
 call RemoveItem(UnitRemoveItemFromSlot(Kobold1,0))
 if Kobold2!=null then
 call RemoveItem(UnitRemoveItemFromSlot(Kobold2,0))
 endif
 if Kobold3!=null then
 call RemoveItem(UnitRemoveItemFromSlot(Kobold3,0))
 endif
 if Kobold4!=null then
 call RemoveItem(UnitRemoveItemFromSlot(Kobold4,0))
 endif
-if Item7 then
+if Item9 then
+call UnitAddItem(Kobold1,CreateItem((Item_Real[indexid_ironboots_disabled]),0,0))
+if Kobold2!=null then
+call UnitAddItem(Kobold2,CreateItem((Item_Real[indexid_ironboots_disabled]),0,0))
+endif
+if Kobold3!=null then
+call UnitAddItem(Kobold3,CreateItem((Item_Real[indexid_ironboots_disabled]),0,0))
+endif
+elseif Item8 then
+call UnitAddItem(Kobold1,CreateItem((Item_Real[indexid_ironboots]),0,0))
+if Kobold2!=null then
+call UnitAddItem(Kobold2,CreateItem((Item_Real[indexid_ironboots]),0,0))
+endif
+if Kobold3!=null then
+call UnitAddItem(Kobold3,CreateItem((Item_Real[indexid_ironboots]),0,0))
+endif
+elseif Item7 then
 call UnitAddItem(Kobold1,CreateItem((Item_Real[indexid_arcaneboots]),0,0))
 if Kobold2!=null then
 call UnitAddItem(Kobold2,CreateItem((Item_Real[indexid_arcaneboots]),0,0))
 endif
 if Kobold3!=null then
 call UnitAddItem(Kobold3,CreateItem((Item_Real[indexid_arcaneboots]),0,0))
 endif
 elseif Item6 then
 call UnitAddItem(Kobold1,CreateItem((Item_Real[indexid_phaseboots]),0,0))
 if Kobold2!=null then
 call UnitAddItem(Kobold2,CreateItem((Item_Real[indexid_phaseboots]),0,0))
 endif
 if Kobold3!=null then
 call UnitAddItem(Kobold3,CreateItem((Item_Real[indexid_phaseboots]),0,0))
 endif
@@ -63397,31 +65114,31 @@
 if GetTriggerEventId()==EVENT_WIDGET_DEATH or GetUnitState(Source,UNIT_STATE_MANA)<20*Level or(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==-1 or(GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT and(GetSpellAbilityId()==abilityid_pulsenova_disabled or GetSpellAbilityId()==abilityid_spellsteal))then
 if(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==0 or(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==abilityid_pulsenova then
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_pulsenova,true)
 endif
 if(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==0 or(LoadInteger(hash_main,(GetHandleId(Source)),(704)))==abilityid_pulsenovaupgraded then
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_pulsenovaupgraded,true)
 endif
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_pulsenova_disabled,false)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 elseif GetTriggerEventId()!=EVENT_UNIT_SPELL_EFFECT then
 call SetUnitState(Source,UNIT_STATE_MANA,GetUnitState(Source,UNIT_STATE_MANA)-20*Level)
 set tt_unit1=Source
 set pulsenova_source=Source
 set g=GetAvailableGroup()
-call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),425,Condition(function GenericCondition_EnemyUnitsEx))
+call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),475,Condition(function GenericCondition_EnemyUnitsEx))
 call ForGroup(g,function PulseNova_Hit)
 call KillGroup(g)
 set g=null
 endif
 set t=null
 return false
 endfunction
 function PulseNova takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 call DestroyEffect(AddSpecialEffectTarget(pulsenova_fx,Source,"origin"))
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_pulsenova,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_pulsenovaupgraded,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_pulsenova_disabled,true)
@@ -63449,60 +65166,67 @@
 endfunction
 function ChainFrost_Loop takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 local unit VisualCaster=(LoadUnitHandle(hash_main,(Cache),(374)))
 local integer Level=(LoadInteger(hash_main,(Cache),(5)))
 local integer CurrentCount=(LoadInteger(hash_main,(Cache),(233)))
 local integer MaxCount=(LoadInteger(hash_main,(Cache),(12)))
 local unit Caster
 local group g
 local real a
 local real x
 local real y
+local integer Ignore=(LoadInteger(hash_main,(Cache),(720)))
+if Ignore>0 then
+set Ignore=Ignore-1
+call SaveInteger(hash_main,(Cache),(720),(Ignore))
+return false
+endif
 if DistanceBetweenXY(GetUnitX(VisualCaster),GetUnitY(VisualCaster),GetUnitX(Target),GetUnitY(Target))>20 then
 set a=AngleBetweenXY(GetUnitX(VisualCaster),GetUnitY(VisualCaster),GetUnitX(Target),GetUnitY(Target))
 call SetUnitFacing(VisualCaster,a)
 set x=GetUnitX(VisualCaster)+13.5*Cos(a*bj_DEGTORAD)
 set y=GetUnitY(VisualCaster)+13.5*Sin(a*bj_DEGTORAD)
 call SetUnitX(VisualCaster,x)
 call SetUnitY(VisualCaster,y)
 else
 if IsDead(Target)==false then
 set Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
 call UnitAddAbility2(Caster,abilityid_chainfrosteffect)
 call SetUnitAbilityLevel(Caster,abilityid_chainfrosteffect,Level)
 call IssueTargetOrder(Caster,"frostnova",Target)
 endif
 if CurrentCount>MaxCount then
 call RemoveUnit(VisualCaster)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 else
 set g=GetAvailableGroup()
 set tt_unit1=Source
 call GroupEnumUnitsInRange(g,GetUnitX(Target),GetUnitY(Target),600,Condition(function GenericCondition_EnemyUnitsWithAncientsVisibleEx))
 call GroupRemoveUnit(g,Target)
 set Target=GroupPickRandomUnit(g)
 call KillGroup(g)
 if Target==null then
 call RemoveUnit(VisualCaster)
 call FlushChildHashtable(hash_main,(Cache))
 call CleanTrigger(t)
 else
+call SaveInteger(hash_main,(Cache),(720),(10))
 call SaveInteger(hash_main,(Cache),(233),(CurrentCount+1))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 endif
 endif
 endif
 set t=null
 set Source=null
 set Target=null
 set VisualCaster=null
 set Caster=null
 set g=null
 return false
 endfunction
 function ChainFrost takes nothing returns nothing
 local unit Source=GetTriggerUnit()
@@ -63511,30 +65235,31 @@
 local integer MaxCount=7
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit VisualCaster
 if GetSpellAbilityId()==abilityid_chainfrostupgraded then
 set Level=GetUnitAbilityLevel(Source,abilityid_chainfrostupgraded)+1
 set MaxCount=7
 endif
 set VisualCaster=CreateUnit(GetOwningPlayer(Source),unitid_chainfrostunit,GetUnitX(Source),GetUnitY(Source),0)
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 call SaveUnitHandle(hash_main,(Cache),(374),(VisualCaster))
 call SaveInteger(hash_main,(Cache),(5),(Level))
 call SaveInteger(hash_main,(Cache),(233),(1))
 call SaveInteger(hash_main,(Cache),(12),(MaxCount))
+call SaveInteger(hash_main,(Cache),(720),(0))
 call TriggerRegisterTimerEvent(t,0.02,true)
 call TriggerAddCondition(t,Condition(function ChainFrost_Loop))
 set Source=null
 set Target=null
 set VisualCaster=null
 set t=null
 endfunction
 function ChainFrost_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_chainfrost or GetSpellAbilityId()==abilityid_chainfrostupgraded then
 call ChainFrost()
 endif
 return false
 endfunction
 function Register_ChainFrost takes nothing returns nothing
 local trigger t=CreateTrigger()
@@ -63833,55 +65558,57 @@
 call UnitRemoveAbility(Source,1093750614)
 call UnitRemoveAbility(Source,1093750615)
 call UnitRemoveAbility(Source,1093750616)
 call UnitRemoveAbility(Source,1093750617)
 call UnitRemoveAbility(Source,1395667021)
 call UnitRemoveAbility(Source,1093750618)
 call UnitRemoveAbility(Source,1395667022)
 call UnitRemoveAbility(Source,1093750832)
 call UnitRemoveAbility(Source,1093750833)
 call UnitRemoveAbility(Source,1093750839)
 call UnitRemoveAbility(Source,1093750849)
 call UnitRemoveAbility(Source,1093750835)
 call UnitRemoveAbility(Source,1093750836)
 call UnitRemoveAbility(Source,1093750837)
 call UnitRemoveAbility(Source,1093750838)
+call UnitRemoveAbility(Source,1093812551)
 endfunction
 function Devour_Absorb takes unit Source,unit Target returns nothing
 local integer TargetID=GetUnitTypeId(Target)
 local integer Ability1=0
 local integer Ability2=0
 if TargetID==1848658008 then
 set Ability1=1093750609
 elseif TargetID==1852796263 then
 set Ability1=1093750610
 elseif TargetID==1852207221 then
 set Ability1=1093750611
 elseif TargetID==1853060204 then
 set Ability1=1093750612
 elseif TargetID==1853055348 then
 set Ability1=1093750613
 elseif TargetID==1853060200 then
 set Ability1=1093750614
 set Ability2=1093750615
 elseif TargetID==1848651859 then
 set Ability1=1093750616
 set Ability2=1093750617
 elseif TargetID==1852534636 then
 set Ability1=1395667021
 elseif TargetID==1852207976 then
 set Ability1=1093750618
+set Ability2=1093812551
 elseif TargetID==1852010091 then
 set Ability1=1395667022
 set Ability2=1093750832
 elseif TargetID==1852272243 then
 set Ability1=1093750833
 elseif TargetID==1852270641 then
 set Ability1=1093750839
 set Ability2=1093750849
 elseif TargetID==1852798821 then
 set Ability1=1093750835
 set Ability2=1093750836
 elseif TargetID==1852077175 then
 set Ability1=1093750837
 set Ability2=1093750838
 elseif TargetID==1853320295 then
@@ -64069,31 +65796,31 @@
 local integer Cache=GetHandleId(t)
 local integer Level=GetUnitAbilityLevel(Source,abilityid_scorchedearth)
 if Level==1 then
 call UnitAddAbility2(Source,scorchedearth_bonus_1)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),scorchedearth_bonus_1,false)
 elseif Level==2 then
 call UnitAddAbility2(Source,scorchedearth_bonus_2)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),scorchedearth_bonus_2,false)
 elseif Level==3 then
 call UnitAddAbility2(Source,scorchedearth_bonus_3)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),scorchedearth_bonus_3,false)
 elseif Level==4 then
 call UnitAddAbility2(Source,scorchedearth_bonus_4)
 call SetPlayerAbilityAvailable(GetOwningPlayer(Source),scorchedearth_bonus_4,false)
 endif
-call TriggerRegisterTimerEvent(t,6+2*Level,false)
+call TriggerRegisterTimerEvent(t,8+2*Level,false)
 call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function ScorchedEarth_End))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 set Source=null
 set t=null
 endfunction
 function ScorchedEarth_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_scorchedearth then
 call ScorchedEarth()
 endif
 return false
 endfunction
 function Register_ScorchedEarth takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
@@ -64553,30 +66280,31 @@
 set g=null
 endfunction
 function MysticSnake_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_mysticsnake then
 call MysticSnake()
 endif
 return false
 endfunction
 function Register_MysticSnake takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function MysticSnake_Main))
 set t=null
 endfunction
 function StoneGaze_Purge takes nothing returns nothing
+call GroupAddUnit(stonegaze_group,GetEnumUnit())
 call IssueTargetOrder(stonegaze_caster,"purge",GetEnumUnit())
 endfunction
 function StoneGaze_IsFacing takes unit Source,unit Target returns boolean
 local real a=AngleBetweenUnits(Target,Source)
 local real face=GetUnitFacing(Target)
 local real c1
 local real c2
 local real d1=-1.0
 local real d2=-1.0
 local real e1
 local real e2
 local real f1=-1.0
 local real f2=-1.0
 if IsUnitVisible(Source,GetOwningPlayer(Target))==false then
 return false
@@ -64592,67 +66320,71 @@
 if face+stonegaze_spread>=360 then
 set f1=0
 set f2=0+(stonegaze_spread-(e2-e1))
 endif
 if a<0 then
 set a=a+360
 elseif a>360 then
 set a=a-360
 endif
 if(a>c1 and a<c2)or(d1!=-1 and a>d1 and a<d2)or(a>e1 and a<e2)or(f1!=-1 and a>f1 and a<f2)then
 return true
 endif
 return false
 endfunction
 function StoneGaze_Which takes nothing returns boolean
-return(IsUnitEnemy(tt_unit1,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit())))and StoneGaze_IsFacing(tt_unit1,GetFilterUnit())and GetUnitAbilityLevel(GetFilterUnit(),1110458961)==0
+return(IsUnitEnemy(tt_unit1,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit())))and IsUnitInGroup(GetFilterUnit(),stonegaze_group)==false and StoneGaze_IsFacing(tt_unit1,GetFilterUnit())and GetUnitAbilityLevel(GetFilterUnit(),1110458961)==0
 endfunction
 function StoneGaze_Iterate takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local integer Level=GetUnitAbilityLevel(Source,abilityid_stonegaze)
 local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
 local group g=GetAvailableGroup()
+local group AlreadyHit=(LoadGroupHandle(hash_main,(Cache),(187)))
 set stonegaze_caster=Caster
 set stonegaze_source=Source
 set tt_unit1=Source
+set stonegaze_group=AlreadyHit
 call GroupEnumUnitsInRange(g,GetUnitX(Source),GetUnitY(Source),825,Condition(function StoneGaze_Which))
 call ForGroup(g,function StoneGaze_Purge)
 call KillGroup(g)
 call DestroyEffect((LoadEffectHandle(hash_main,(Cache),(32))))
-if GetTriggerEvalCount(t)>6 then
+if GetTriggerEvalCount(t)>100 then
 call CleanTrigger(t)
 call FlushChildHashtable(hash_main,(Cache))
+call KillGroup(AlreadyHit)
 else
 call SaveEffectHandle(hash_main,(Cache),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\EtherealForm\\SpiritWalkerChange.mdl",Source,"chest")))
 endif
 set Source=null
 set Caster=null
 set g=null
 set t=null
 return false
 endfunction
 function StoneGaze takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Caster=CreateUnit(GetOwningPlayer(GetTriggerUnit()),1697656901,GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit()),0)
-call TriggerRegisterTimerEvent(t,0.1,true)
+call TriggerRegisterTimerEvent(t,0.05,true)
 call TriggerAddCondition(t,Condition(function StoneGaze_Iterate))
 call SaveUnitHandle(hash_main,(Cache),(2),(GetTriggerUnit()))
 call SaveUnitHandle(hash_main,(Cache),(19),(Caster))
 call UnitAddAbility2(Caster,stonegaze_purge)
+call SaveGroupHandle(hash_main,(Cache),(187),(GetAvailableGroup()))
 call SaveEffectHandle(hash_main,(Cache),(32),(AddSpecialEffectTarget("Abilities\\Spells\\Orc\\EtherealForm\\SpiritWalkerChange.mdl",GetTriggerUnit(),"chest")))
 call SetUnitAbilityLevel(Caster,stonegaze_purge,GetUnitAbilityLevel(GetTriggerUnit(),abilityid_stonegaze))
 call TriggerEvaluate(t)
 set t=null
 set Caster=null
 endfunction
 function StoneGaze_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_stonegaze then
 call StoneGaze()
 endif
 return false
 endfunction
 function Register_StoneGaze takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
@@ -64664,31 +66396,31 @@
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),splitshot_dmg_1,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),splitshot_dmg_2,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),splitshot_dmg_3,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),splitshot_dmg_4,false)
 call SetPlayerAbilityAvailable(GetOwningPlayer(GetTriggerUnit()),splitshot_spellbook,false)
 endif
 return false
 endfunction
 function Register_Splitshot takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Splitshot_Main))
 set t=null
 endfunction
 function Wound_Slow takes integer Count,unit Source,unit Target returns nothing
-local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
+local unit Caster=CreateUnit(GetOwningPlayer(Target),1697656901,GetUnitX(Target),GetUnitY(Target),0)
 if Count==0 then
 call IssueTargetOrder(Source,"attack",Target)
 elseif Count==1 then
 call UnitAddAbility2(Caster,abilityid_woundslow)
 call SetUnitAbilityLevel(Caster,abilityid_woundslow,1)
 call IssueTargetOrder(Caster,"slow",Target)
 elseif Count==2 then
 call UnitAddAbility2(Caster,abilityid_woundslow)
 call SetUnitAbilityLevel(Caster,abilityid_woundslow,1)
 call IssueTargetOrder(Caster,"slow",Target)
 elseif Count==3 then
 call UnitAddAbility2(Caster,abilityid_woundslow)
 call SetUnitAbilityLevel(Caster,abilityid_woundslow,2)
 call IssueTargetOrder(Caster,"slow",Target)
 elseif Count==4 then
@@ -65070,31 +66802,31 @@
 call Feast_Learned()
 endif
 return false
 endfunction
 function Register_Feast takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
 call TriggerAddCondition(t,Condition(function Feast))
 set t=null
 endfunction
 function Heartstopper_Damage takes nothing returns nothing
 local unit Target=GetEnumUnit()
 local unit Source=heartstopper_source
 local real CurrentHP=GetUnitState(Target,UNIT_STATE_LIFE)
 local real MaxHP=GetUnitState(Target,UNIT_STATE_MAX_LIFE)
-local real HPLoss=((0.002+0.002*heartstopper_level)*MaxHP)/2
+local real HPLoss=((0.003+0.002*heartstopper_level)*MaxHP)/2
 if CurrentHP<HPLoss then
 call SetUnitState(Target,UNIT_STATE_LIFE,1)
 call DamageTarget(Source,Target,DAMAGE_PURE,100)
 call DamageTarget(Source,Target,DAMAGE_MAGICAL,100)
 call DamageTarget(Source,Target,DAMAGE_PHYSICAL,100)
 else
 call SetUnitState(Target,UNIT_STATE_LIFE,RMax(GetUnitState(Target,UNIT_STATE_LIFE)-HPLoss,1))
 endif
 set Target=null
 set Source=null
 endfunction
 function Heartstopper_WhichUnits takes nothing returns boolean
 return(IsUnitEnemy(tt_unit1,GetOwningPlayer(GetFilterUnit()))and(GetUnitAbilityLevel(GetFilterUnit(),1093678162)==0 and IsUnitType(GetFilterUnit(),UNIT_TYPE_STRUCTURE)==false and IsDead(GetFilterUnit())==false)and(IsUnitType(GetFilterUnit(),UNIT_TYPE_ANCIENT)==false or GenericCondition_IsBear(GetFilterUnit())))and GetUnitAbilityLevel(GetFilterUnit(),buffid_heartstopper)>0
 endfunction
 function Heartstopper takes nothing returns boolean
@@ -65129,31 +66861,35 @@
 endfunction
 function Register_Heartstopper takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
 call TriggerAddCondition(t,Condition(function Heartstopper_Main))
 set t=null
 endfunction
 function Trig_Sadist_Conditions takes nothing returns boolean
 if(not(UnitHasBuffBJ(GetKillingUnitBJ(),1110454866)==true))then
 return false
 endif
 return true
 endfunction
 function Trig_Sadist_Actions takes nothing returns nothing
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\ReplenishMana\\SpiritTouchTarget.mdl",GetKillingUnit(),"origin"))
+if IsUnitType(GetTriggerUnit(),UNIT_TYPE_HERO)==true and GetUnitAbilityLevel(GetKillingUnit(),1093678640)==4 then
+call SetUnitState(GetKillingUnit(),UNIT_STATE_MANA,GetUnitState(GetKillingUnit(),UNIT_STATE_MANA)+600)
+else
 call SetUnitManaBJ(GetKillingUnitBJ(),(GetUnitStateSwap(UNIT_STATE_MANA,GetKillingUnitBJ())+(12.00*I2R(GetUnitAbilityLevelSwapped(1093678640,GetKillingUnitBJ())))))
+endif
 endfunction
 function Sadist takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function Trig_Sadist_Conditions))
 call TriggerAddAction(t,function Trig_Sadist_Actions)
 endfunction
 function DeathPulse_Process takes nothing returns nothing
 local integer Cache=GetHandleId(GetTriggeringTrigger())
 local unit Source=tt_unit1
 local unit Target=tt_unit2
 local real Damage=(LoadReal(hash_main,(Cache),(20)))
 local real Heal=(LoadReal(hash_main,(Cache),(21)))
 if IsUnitAlly(Target,GetOwningPlayer(Source))then
 call SetUnitState(Target,UNIT_STATE_LIFE,GetUnitState(Target,UNIT_STATE_LIFE)+Heal)
@@ -65173,39 +66909,39 @@
 function DeathPulse_HitCheck takes nothing returns nothing
 if IsUnitVisible(GetEnumUnit(),GetOwningPlayer(tt_unit1))then
 call DeathPulse_Hit()
 endif
 endfunction
 function DeathPulse_Main takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 local group g=GetAvailableGroup()
 local integer Level=GetUnitAbilityLevel(Hero,abilityid_deathpulse)
 local real r
 local real Damage
 local real Heal
 if Level==1 then
 set Damage=75
 set Heal=50
-set r=400
+set r=500
 elseif Level==2 then
 set Damage=125
 set Heal=75
-set r=450
+set r=500
 elseif Level==3 then
 set Damage=200
 set Heal=100
-set r=475
+set r=500
 elseif Level==4 then
 set Damage=275
 set Heal=130
 set r=500
 endif
 set tt_unit1=Hero
 set tt_real1=Damage
 set tt_real2=Heal
 call GroupEnumUnitsInRange(g,GetUnitX(Hero),GetUnitY(Hero),r,Condition(function GenericCondition_AllUnitsWithAncients))
 call GroupRemoveUnit(g,Hero)
 call ForGroup(g,function DeathPulse_HitCheck)
 call KillGroup(g)
 call SetUnitState(Hero,UNIT_STATE_LIFE,GetUnitState(Hero,UNIT_STATE_LIFE)+Heal)
 set Hero=null
 set g=null
@@ -65388,62 +67124,62 @@
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function WatcherSuicide_Main))
 call PreloadAbility(scarab_silence)
 set t=null
 endfunction
 function Necromastry_Process takes nothing returns nothing
 local integer Cache=GetHandleId(GetTriggeringTrigger())
 local unit Source=tt_unit2
 local integer souls=GetUnitAbilityLevel(Source,abilityid_necromastryhelper)
 local integer maxsouls
 local integer Level=GetUnitAbilityLevel(Source,abilityid_necromastry)
 set souls=souls+1
 if Level==1 then
 set maxsouls=8
 elseif Level==2 then
-set maxsouls=15
+set maxsouls=16
 elseif Level==3 then
-set maxsouls=23
+set maxsouls=24
 else
-set maxsouls=30
+set maxsouls=32
 endif
 set maxsouls=maxsouls+1
 set souls=IMinBJ(maxsouls,souls)
 call SetUnitAbilityLevel(Source,abilityid_necromastryhelper,souls)
 call SaveInteger(hash_main,(GetHandleId(Source)),(710),(souls))
 set Source=null
 endfunction
 function Necromastry_Kill takes nothing returns nothing
 local integer souls
 local integer Level
 local integer maxsouls
 local trigger t
 local integer Cache
 local unit Source=GetKillingUnit()
 if GetUnitTypeId(Source)==1697656899 then
 set Source=udg_Hero[GetPlayerId(GetOwningPlayer(GetKillingUnit()))]
 endif
 set souls=GetUnitAbilityLevel(Source,abilityid_necromastryhelper)
 set Level=GetUnitAbilityLevel(Source,abilityid_necromastry)
 if Level==1 then
 set maxsouls=8
 elseif Level==2 then
-set maxsouls=15
+set maxsouls=16
 elseif Level==3 then
-set maxsouls=23
+set maxsouls=24
 else
-set maxsouls=30
+set maxsouls=32
 endif
 if souls<=maxsouls then
 set t=CreateProjectileToUnit(GetTriggerUnit(),Source,1747993426,"Necromastry_Process",500)
 set Cache=GetHandleId(t)
 set t=null
 call DestroyEffect(AddSpecialEffect("Abilities\\Weapons\\ZigguratMissile\\ZigguratMissile.mdl",GetUnitX(GetTriggerUnit()),GetUnitY(GetTriggerUnit())))
 endif
 endfunction
 function Necromastry_Death takes nothing returns nothing
 call SaveInteger(hash_main,(GetHandleId(GetTriggerUnit())),(710),(R2I(GetUnitAbilityLevel(GetTriggerUnit(),abilityid_necromastryhelper)*0.5)+1))
 call SetUnitAbilityLevel(GetTriggerUnit(),abilityid_necromastryhelper,R2I(GetUnitAbilityLevel(GetTriggerUnit(),abilityid_necromastryhelper)*0.5)+1)
 endfunction
 function Necromastry_Main takes nothing returns boolean
 if GetUnitAbilityLevel(GetKillingUnit(),abilityid_necromastry)>0 and IsUnitIllusion(GetTriggerUnit())==false then
 call Necromastry_Kill()
@@ -65451,35 +67187,35 @@
 call Necromastry_Kill()
 endif
 if GetUnitAbilityLevel(GetTriggerUnit(),abilityid_necromastry)>0 and IsUnitIllusion(GetTriggerUnit())==false then
 call Necromastry_Death()
 endif
 return false
 endfunction
 function Necromastry_Command takes nothing returns boolean
 local unit Hero=udg_Hero[GetPlayerId(GetTriggerPlayer())]
 local integer Souls=GetUnitAbilityLevel(Hero,abilityid_necromastryhelper)-1
 local integer MaxSouls=0
 local integer Level=GetUnitAbilityLevel(Hero,abilityid_necromastry)
 if Level==1 then
 set MaxSouls=8
 elseif Level==2 then
-set MaxSouls=15
+set MaxSouls=16
 elseif Level==3 then
-set MaxSouls=23
+set MaxSouls=24
 elseif Level==4 then
-set MaxSouls=30
+set MaxSouls=32
 endif
 set Souls=IMaxBJ(IMinBJ(Souls,MaxSouls),0)
 if GetUnitTypeId(Hero)==1315334514 then
 call DisplayTimedTextToPlayer(GetTriggerPlayer(),0,udg_TextY,10.00,GetObjectName(1848658757)+" "+I2S(Souls)+"/"+I2S(MaxSouls))
 endif
 return false
 endfunction
 function RegisterNecromastry takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_DEATH)
 call TriggerAddCondition(t,Condition(function Necromastry_Main))
 set t=CreateTrigger()
 call TriggerRegisterPlayerChatEvent(t,udg_SentPlayers[1],"-stats",true)
 call TriggerRegisterPlayerChatEvent(t,udg_SentPlayers[2],"-stats",true)
 call TriggerRegisterPlayerChatEvent(t,udg_SentPlayers[3],"-stats",true)
@@ -65859,31 +67595,31 @@
 call SetUnitAbilityLevel(GetTriggerUnit(),1093679171,GetUnitAbilityLevel(GetTriggerUnit(),1093679173))
 endif
 endif
 endfunction
 function Hunter takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_HERO_SKILL)
 call TriggerAddCondition(t,Condition(function Trig_NS_Learn_Abilities_Conditions))
 call TriggerAddAction(t,function Trig_NS_Learn_Abilities_Actions)
 endfunction
 function StiflingKnife_Hit takes nothing returns nothing
 local integer Cache=GetHandleId(GetTriggeringTrigger())
 local unit Source=tt_unit1
 local unit Target=tt_unit2
 local integer Level=(LoadInteger(hash_main,(Cache),(5)))
-local real Damage=Level*40
+local real Damage=Level*50
 local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
 call UnitAddAbility2(Caster,abilityid_stiflingknifeslow)
 call SetUnitAbilityLevel(Caster,abilityid_stiflingknifeslow,Level)
 call IssueTargetOrder(Caster,"slow",Target)
 if IsUnitType(Target,UNIT_TYPE_HERO)==true then
 set Damage=Damage/2
 endif
 call DamageTarget(Source,Target,DAMAGE_PURE,Damage)
 set Source=null
 set Target=null
 set Caster=null
 endfunction
 function StiflingKnife takes nothing returns nothing
 local unit Hero=GetTriggerUnit()
 local unit Target=GetSpellTargetUnit()
@@ -66389,31 +68125,31 @@
 call ForGroup(g,function Expulsion_Heal)
 call KillGroup(g)
 endif
 set g=null
 set Hero=null
 set Corpse=null
 set t=null
 return false
 endfunction
 function Expulsion_Main takes nothing returns nothing
 local real x=GetUnitX(GetTriggerUnit())
 local real y=GetUnitY(GetTriggerUnit())
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 call PlaySoundAtPos(gg_snd_FlameStrikeTargetWaveNonLoop101,x,y)
-call TriggerRegisterTimerEvent(t,1.25,true)
+call TriggerRegisterTimerEvent(t,1.5,true)
 call TriggerAddCondition(t,Condition(function Expulsion_Loop))
 call UnitAddAbility2(GetTriggerUnit(),abilityid_expulsion_aura)
 call SaveUnitHandle(hash_main,(Cache),(14),(GetTriggerUnit()))
 call SaveReal(hash_main,(Cache),(6),((x)*1.0))
 call SaveReal(hash_main,(Cache),(7),((y)*1.0))
 call SaveBoolean(hash_main,(Cache),(307),(false))
 call SaveBoolean(hash_main,(Cache),(308),(false))
 set t=null
 endfunction
 function Expulsion takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_expulsion then
 call Expulsion_Main()
 endif
 return false
 endfunction
@@ -66931,30 +68667,31 @@
 set Dying=null
 endif
 return false
 endfunction
 function FleahHeap_GiveBonus takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local unit Source=(LoadUnitHandle(hash_main,(GetHandleId(t)),(2)))
 local integer Cache=GetHandleId(Source)
 local integer FleshHeapTally=(LoadInteger(hash_main,(Cache),(672)))
 local integer FleshHeapLast=(LoadInteger(hash_main,(Cache),(673)))
 local integer Level=GetUnitAbilityLevel(Source,abilityid_fleshheap)
 local integer FleshHeapProposed=R2I(I2R(FleshHeapTally)*(0.6+0.3*Level))
 if FleshHeapProposed>FleshHeapLast then
 call ModifyHeroStat(bj_HEROSTAT_STR,Source,bj_MODIFYMETHOD_ADD,FleshHeapProposed-FleshHeapLast)
 call SaveInteger(hash_main,(Cache),(673),(FleshHeapProposed))
+call TextTagOnUnitEx("+"+I2S(FleshHeapProposed-FleshHeapLast)+" "+GetObjectName(1848659274),3,Source,0.023,0,255,0,230)
 endif
 set t=null
 set Source=null
 return false
 endfunction
 function FleahHeap takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 call TriggerRegisterTimerEvent(t,0.5,true)
 call TriggerAddCondition(t,Condition(function FleahHeap_GiveBonus))
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 set Source=null
 set t=null
 endfunction
@@ -67520,31 +69257,31 @@
 call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 elseif DeadUnit==Target then
 call StaticLink_RemoveDamage(Target,0)
 call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
 call SaveUnitHandle(hash_main,(Cache),(2),(Source))
 call SaveUnitHandle(hash_main,(Cache),(17),(null))
 else
 call StaticLink_AddDamage(Source,0)
 call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
 call SaveUnitHandle(hash_main,(Cache),(2),(null))
 call SaveUnitHandle(hash_main,(Cache),(17),(Target))
 endif
-call TriggerRegisterTimerEvent(t,13,false)
+call TriggerRegisterTimerEvent(t,18,false)
 call TriggerAddCondition(t,Condition(function StaticLink_DelayedRemove_Finished))
 endfunction
 function StaticLink_Follow takes nothing returns boolean
 local trigger t=GetTriggeringTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
 local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
 local lightning Light=(LoadLightningHandle(hash_main,(Cache),(196)))
 local integer Level=(LoadInteger(hash_main,(Cache),(5)))
 local integer Count=GetTriggerEvalCount(t)
 local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
 call MoveLightning(Light,true,GetUnitX(Source),GetUnitY(Source),GetUnitX(Target),GetUnitY(Target))
 call SetUnitX(Caster,GetUnitX(Target))
 call SetUnitY(Caster,GetUnitY(Target))
 if DistanceBetweenXY(GetUnitX(Source),GetUnitY(Source),GetUnitX(Target),GetUnitY(Target))>700 or GetTriggerEventId()==EVENT_UNIT_DEATH or IsUnitVisible(Target,GetOwningPlayer(Source))==false then
@@ -68530,31 +70267,33 @@
 function RegisterDesolate takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_ATTACKED)
 call TriggerAddCondition(t,Condition(function Desolate_Condition))
 call TriggerAddAction(t,function Desolate_Action)
 endfunction
 function Dispersion_Damage takes nothing returns nothing
 local real d=DistanceBetweenUnits(GetTriggerUnit(),GetEnumUnit())-25
 local real factor=0
 if d<300 then
 set factor=1
 elseif d<1000 then
 set factor=(1000-d)/700
 endif
 if factor>0 then
+set safedamage_urn[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=true
 call DamageTarget(GetTriggerUnit(),GetEnumUnit(),DAMAGE_PURE,dispersion_damage*factor)
+set safedamage_urn[GetPlayerId(GetOwningPlayer(GetEnumUnit()))]=false
 call DestroyEffect(AddSpecialEffectTarget("Abilities\\Spells\\Undead\\DeathandDecay\\DeathandDecayDamage.mdl",GetEnumUnit(),"chest"))
 endif
 endfunction
 function Dispersion_Main takes nothing returns boolean
 local unit Hero=GetTriggerUnit()
 local real Damage=GetEventDamage()
 local integer Level=GetUnitAbilityLevel(Hero,abilityid_dispersion)
 local group g
 if IsLegitDamage(Damage)then
 set g=GetAvailableGroup()
 set dispersion_damage=Damage*(0.06+0.04*Level)
 call PreventDamage(Hero,dispersion_damage)
 call GroupEnumUnitsInRange(g,GetUnitX(Hero),GetUnitY(Hero),1025,Condition(function GenericCondition_EnemyUnits))
 call ForGroup(g,function Dispersion_Damage)
 call KillGroup(g)
@@ -69076,31 +70815,31 @@
 endif
 set a=AngleBetweenUnits(Source,Target)*bj_DEGTORAD
 call SetUnitFacing(Source,a*bj_RADTODEG)
 set x=LastX+rate*Cos(a)
 set y=LastY+rate*Sin(a)
 call SetUnitX(Source,x)
 call SetUnitY(Source,y)
 call SetUnitX(Caster,GetUnitX(Target))
 call SetUnitY(Caster,GetUnitY(Target))
 call SaveReal(hash_main,(Cache),(23),((x)*1.0))
 call SaveReal(hash_main,(Cache),(24),((y)*1.0))
 set charge_group=(LoadGroupHandle(hash_main,(Cache),(187)))
 set g=GetAvailableGroup()
 set tt_unit1=Source
 set charge_source=Source
-call GroupEnumUnitsInRange(g,x,y,275,Condition(function GenericCondition_EnemyUnitsEx))
+call GroupEnumUnitsInRange(g,x,y,325,Condition(function GenericCondition_EnemyUnitsEx))
 call GroupRemoveUnit(g,Target)
 set charge_level=Level
 call ForGroup(g,function ChargeOfDarkness_Bash)
 call KillGroup(g)
 set g=null
 if d<3000 and GetUnitAbilityLevel(Target,chargeofdarkness_icon)==0 then
 call UnitAddAbility2(Target,chargeofdarkness_icon)
 endif
 endif
 endif
 set t=null
 set Source=null
 set Target=null
 set Caster=null
 return false
@@ -69211,31 +70950,31 @@
 else
 set Alpha=200-Count
 endif
 call SetUnitVertexColor(Source,255,255,255,255*(100-Alpha)/100)
 if Count==100 then
 set Level=(LoadInteger(hash_main,(Cache),(5)))
 set Angle=Atan2(GetUnitY(Target)-GetUnitY(Source),GetUnitX(Target)-GetUnitX(Source))
 call SetUnitPosition(Source,GetUnitX(Target)+80*Cos(Angle),GetUnitY(Target)+80*Sin(Angle))
 call SetUnitAnimation(Source,"attack")
 call IssueTargetOrder(Source,"attack",Target)
 if GetUnitAbilityLevel(Source,abilityid_netherstrike)>0 then
 call NetherStrike_GreaterBash(Source,Target)
 else
 call NetherStrike_AffectArea(Source,Target)
 endif
-call DamageTarget(Source,Target,DAMAGE_MAGICAL,100*Level)
+call DamageTarget(Source,Target,DAMAGE_MAGICAL,50+100*Level)
 endif
 endif
 set t=null
 set Source=null
 set Target=null
 return false
 endfunction
 function NetherStrike takes nothing returns nothing
 local trigger t=CreateTrigger()
 local integer Cache=GetHandleId(t)
 local unit Source=GetTriggerUnit()
 local unit Target=GetSpellTargetUnit()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_netherstrike)
 if Level==0 then
 set Level=GetUnitAbilityLevel(Source,abilityid_netherstrikeupgrade)
@@ -69433,31 +71172,31 @@
 call IssueTargetOrder(Image,"attack",Target)
 call SetUnitMoveSpeed(Image,522)
 call SetUnitVertexColorBJ(Image,100,100,100,60)
 endif
 set t=null
 set Target=null
 set Source=null
 set Caster=null
 return false
 endfunction
 function Reflection_Add takes nothing returns nothing
 local unit Source=GetTriggerUnit()
 local unit Target=GetEnumUnit()
 local integer Level=GetUnitAbilityLevel(Source,abilityid_reflection)
 local integer id
-local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Target),GetUnitY(Target),0)
+local unit Caster=CreateUnit(GetOwningPlayer(Source),1697656901,GetUnitX(Source),GetUnitY(Source),0)
 local trigger t
 local integer Cache
 if Level==1 then
 set id=reflection_slow_1
 elseif Level==2 then
 set id=reflection_slow_2
 elseif Level==3 then
 set id=reflection_slow_3
 elseif Level==4 then
 set id=reflection_slow_4
 endif
 call SetPlayerAbilityAvailable(GetOwningPlayer(Target),id,false)
 if IsRealSummoned(Target)==false then
 call AddTimedAbilityAndRemove(Target,id,1,4,reflection_slow_buffid)
 endif
@@ -69548,30 +71287,175 @@
 function MetaMorph_Main takes nothing returns boolean
 if GetSpellAbilityId()==abilityid_metamorph and GetUnitTypeId(GetTriggerUnit())==1164277353 then
 call MetaMorph_Delay()
 endif
 return false
 endfunction
 function Register_MetaMorph takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function MetaMorph_Main))
 set t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SUMMON)
 call TriggerAddCondition(t,Condition(function MetaMorph_ImageEnter))
 set t=null
 endfunction
+function Soulsteal_Drain takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
+local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
+local integer Level=(LoadInteger(hash_main,(Cache),(5)))
+if GetTriggerEventId()==EVENT_UNIT_DEATH or GetTriggerEvalCount(t)>(4*(4+Level))or IsMagicImmune(Target)or DistanceBetweenUnits(Source,Target)>700 then
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+call KillUnit(Caster)
+elseif GetTriggerEventId()==EVENT_UNIT_SPELL_EFFECT then
+if GetTriggerEvalCount(t)>1 and GetSpellAbilityId()==abilityid_soulsteal_secondary then
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+call UnitRemoveAbility(Source,abilityid_soulsteal_secondary)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_soulsteal,true)
+call KillUnit(Caster)
+endif
+elseif IsUnitVisible(Target,GetOwningPlayer(Source))==false then
+if(LoadInteger(hash_main,(Cache),(34)))==1 then
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+call KillUnit(Caster)
+else
+call SaveInteger(hash_main,(Cache),(34),(1))
+endif
+else
+call SaveInteger(hash_main,(Cache),(34),(0))
+if IsUnitAlly(Source,GetOwningPlayer(Target))==false then
+call SetUnitState(Source,UNIT_STATE_LIFE,GetUnitState(Source,UNIT_STATE_LIFE)+Level*25.0/4.0)
+else
+call SetUnitState(Target,UNIT_STATE_LIFE,GetUnitState(Target,UNIT_STATE_LIFE)+Level*50.0/4.0)
+endif
+endif
+set t=null
+set Source=null
+set Target=null
+set Caster=null
+return false
+endfunction
+function Soulsteal_MoveDummy takes nothing returns boolean
+local trigger t=GetTriggeringTrigger()
+local integer Cache=GetHandleId(t)
+local unit Source=(LoadUnitHandle(hash_main,(Cache),(2)))
+local unit Target=(LoadUnitHandle(hash_main,(Cache),(17)))
+local unit Caster=(LoadUnitHandle(hash_main,(Cache),(19)))
+if GetTriggerEventId()==EVENT_UNIT_DEATH then
+call UnitRemoveAbility(Source,abilityid_soulsteal_secondary)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_soulsteal,true)
+call FlushChildHashtable(hash_main,(Cache))
+call CleanTrigger(t)
+else
+if GetTriggerEvalCount(t)==1 then
+call IssueImmediateOrderById(Source,851993)
+endif
+if IsUnitAlly(Source,GetOwningPlayer(Target))==false then
+call SetUnitX(Caster,GetUnitX(Source))
+call SetUnitY(Caster,GetUnitY(Source))
+else
+call SetUnitX(Caster,GetUnitX(Target))
+call SetUnitY(Caster,GetUnitY(Target))
+endif
+endif
+set t=null
+set Source=null
+set Target=null
+set Caster=null
+return false
+endfunction
+function Soulsteal takes nothing returns nothing
+local unit Source=GetTriggerUnit()
+local unit Target=GetSpellTargetUnit()
+local integer Level=GetUnitAbilityLevel(Source,abilityid_soulsteal)
+local trigger t=CreateTrigger()
+local integer Cache=GetHandleId(t)
+local unit Caster
+if IsUnitAlly(Source,GetOwningPlayer(Target))==false then
+set Caster=CreateUnit(GetOwningPlayer(Source),unitid_soulsteal,0,0,0)
+call UnitAddAbility2(Caster,abilityid_soulsteal_dummy)
+call SetUnitAbilityLevel(Caster,abilityid_soulsteal_dummy,Level)
+call SetUnitX(Caster,GetUnitX(Source))
+call SetUnitY(Caster,GetUnitY(Source))
+call IssueTargetOrderById(Caster,852487,Target)
+else
+call UnitAddAbility2(Source,abilityid_soulsteal_secondary)
+call UnitMakeAbilityPermanent(Source,true,abilityid_soulsteal_secondary)
+call SetPlayerAbilityAvailable(GetOwningPlayer(Source),abilityid_soulsteal,false)
+set Caster=CreateUnit(udg_NeutralHostile,unitid_soulsteal,0,0,0)
+call UnitAddAbility2(Caster,abilityid_soulsteal_dummy)
+call SetUnitAbilityLevel(Caster,abilityid_soulsteal_dummy,Level)
+call SetUnitX(Caster,GetUnitX(Target))
+call SetUnitY(Caster,GetUnitY(Target))
+call IssueTargetOrderById(Caster,852487,Source)
+endif
+call TriggerRegisterTimerEvent(t,0.25,true)
+call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_DEATH)
+call TriggerRegisterUnitEvent(t,Target,EVENT_UNIT_DEATH)
+call TriggerRegisterUnitEvent(t,Source,EVENT_UNIT_SPELL_EFFECT)
+call TriggerAddCondition(t,Condition(function Soulsteal_Drain))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+call SaveUnitHandle(hash_main,(Cache),(17),(Target))
+call SaveUnitHandle(hash_main,(Cache),(19),(Caster))
+call SaveInteger(hash_main,(Cache),(5),(Level))
+call SaveInteger(hash_main,(Cache),(34),(0))
+set t=CreateTrigger()
+set Cache=GetHandleId(t)
+call TriggerRegisterTimerEvent(t,0.01,true)
+call TriggerRegisterUnitEvent(t,Caster,EVENT_UNIT_DEATH)
+call TriggerAddCondition(t,Condition(function Soulsteal_MoveDummy))
+call SaveUnitHandle(hash_main,(Cache),(2),(Source))
+call SaveUnitHandle(hash_main,(Cache),(17),(Target))
+call SaveUnitHandle(hash_main,(Cache),(19),(Caster))
+set Source=null
+set Target=null
+set t=null
+endfunction
+function Soulsteal_Main takes nothing returns boolean
+if GetSpellAbilityId()==abilityid_soulsteal and GetUnitTypeId(GetSpellTargetUnit())!=1848651852 and(IsUnitAlly(GetSpellTargetUnit(),GetOwningPlayer(GetTriggerUnit()))or IsBlocked(GetSpellTargetUnit())==false)then
+call Soulsteal()
+endif
+return false
+endfunction
+function Register_Soulsteal takes nothing returns nothing
+local trigger t=CreateTrigger()
+call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
+call TriggerAddCondition(t,Condition(function Soulsteal_Main))
+endfunction
+function ConjureImage_Conditions takes nothing returns boolean
+return GetSpellAbilityId()==1093683252
+endfunction
+function ConjureImage_Actions takes nothing returns nothing
+local unit UnitVar=GetTriggerUnit()
+local integer Level=GetUnitAbilityLevel(UnitVar,1093683252)
+local unit Caster=CreateUnit(GetOwningPlayer(UnitVar),1697656901,GetUnitX(UnitVar),GetUnitY(UnitVar),0)
+call UnitAddAbility(Caster,1093814862)
+call SetUnitAbilityLevel(Caster,1093814862,Level)
+call IssueTargetOrderById(Caster,852274,UnitVar)
+endfunction
+function RegisterConjureImage takes nothing returns nothing
+local trigger t=CreateTrigger()
+call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
+call TriggerAddCondition(t,Condition(function ConjureImage_Conditions))
+call TriggerAddAction(t,function ConjureImage_Actions)
+endfunction
 function Trig_Gush_Conditions takes nothing returns boolean
 return GetSpellAbilityId()==1093678134 and IsBlocked(GetSpellTargetUnit())==false
 endfunction
 function Trig_Gush_Actions takes nothing returns nothing
 local unit t=GetSpellTargetUnit()
 local real gush=(60.00+(50.00*I2R(GetUnitAbilityLevelSwapped(1093678134,GetTriggerUnit()))))
 call UnitDamageTargetBJ(GetTriggerUnit(),t,gush,ATTACK_TYPE_NORMAL,DAMAGE_TYPE_COLD)
 call DestroyEffect(AddSpecialEffectTarget("Objects\\Spawnmodels\\Naga\\NagaDeath\\NagaDeath.mdl",t,"chest"))
 endfunction
 function Gush takes nothing returns nothing
 local trigger t=CreateTrigger()
 call TriggerRegisterAnyUnitEvent(t,EVENT_PLAYER_UNIT_SPELL_EFFECT)
 call TriggerAddCondition(t,Condition(function Trig_Gush_Conditions))
 call TriggerAddAction(t,function Trig_Gush_Actions)
 endfunction
@@ -78839,33 +84851,35 @@
 call InitTrig_Misc()
 call InitTrig_Map_Info()
 call InitTrig_Leave()
 call InitTrig_Remove_On_Respawn()
 call InitTrig_HeroRevive()
 call InitTrig_HeroEnters()
 call InitTrig_OneHero()
 call InitTrig_Money()
 call InitTrig_Time()
 call InitTrig_Cooldown_Tracker()
 call InitTrig_Reliable_Gold()
 call InitTrig_Ban_Dev_Hero()
 call InitTrig_Track_Dying_Creeps()
 call InitTrig_CustomHeroRevive()
 call InitTrig_Deathtrigger()
call InitTrig_Image_Enters()
 call InitTrig_First_Blood()
 call InitTrig_RoshanDies()
 call InitTrig_AntiDeny()
+call InitTrig_Chicken_Dies()
 call InitTrig_Item_Definitions()
 call InitTrig_Powerup_Definitions()
 call Initialize_Recipes()
 call AghanimsScepter_Init()
 call InitTrig_Goblin_Definitions()
 call InitTrig_Unit_Item_Conversion()
 call InitTrig_Manipulate_Item()
 call InitTrig_Hero_Morphing_Restrictions()
 call InitTrig_Item_Traffic()
 call InitTrig_Item_Cooldown()
 call InitTrig_Disassemble()
 call InitTrig_NoChickenSale()
 call InitTrig_Bloodstone()
 call InitTrig_Bloodstone_Heal()
 call InitTrig_NoRoshanWard()
